
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://pywavelets.readthedocs.io/ref/">
      
      
        <link rel="prev" href="../install/">
      
      
        <link rel="next" href="../dev/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.42">
    
    
      
        <title>API Reference - PyWavelets Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0253249f.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="PyWavelets Documentation" class="md-header__button md-logo" aria-label="PyWavelets Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PyWavelets Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Reference
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../install/" class="md-tabs__link">
        
  
    
  
  Installing

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
    
  
  API Reference

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../dev/" class="md-tabs__link">
        
  
    
  
  Development guide

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="PyWavelets Documentation" class="md-nav__button md-logo" aria-label="PyWavelets Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    PyWavelets Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installing
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pywt" class="md-nav__link">
    <span class="md-ellipsis">
      pywt
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.BaseNode" class="md-nav__link">
    <span class="md-ellipsis">
      BaseNode
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseNode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.path_tuple" class="md-nav__link">
    <span class="md-ellipsis">
      path_tuple
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.__delitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __delitem__
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__delitem__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.__delitem__--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__getitem__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.__getitem__--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.__getitem__--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.__setitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __setitem__
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__setitem__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.__setitem__--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.decompose" class="md-nav__link">
    <span class="md-ellipsis">
      decompose
    </span>
  </a>
  
    <nav class="md-nav" aria-label="decompose">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.decompose--note" class="md-nav__link">
    <span class="md-ellipsis">
      Note
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.get_leaf_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      get_leaf_nodes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_leaf_nodes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.get_leaf_nodes--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.get_subnode" class="md-nav__link">
    <span class="md-ellipsis">
      get_subnode
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_subnode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.get_subnode--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.reconstruct" class="md-nav__link">
    <span class="md-ellipsis">
      reconstruct
    </span>
  </a>
  
    <nav class="md-nav" aria-label="reconstruct">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.reconstruct--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.walk" class="md-nav__link">
    <span class="md-ellipsis">
      walk
    </span>
  </a>
  
    <nav class="md-nav" aria-label="walk">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.walk--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.walk_depth" class="md-nav__link">
    <span class="md-ellipsis">
      walk_depth
    </span>
  </a>
  
    <nav class="md-nav" aria-label="walk_depth">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.walk_depth--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult" class="md-nav__link">
    <span class="md-ellipsis">
      FswavedecnResult
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FswavedecnResult">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.approx" class="md-nav__link">
    <span class="md-ellipsis">
      approx
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.axes" class="md-nav__link">
    <span class="md-ellipsis">
      axes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.coeff_slices" class="md-nav__link">
    <span class="md-ellipsis">
      coeff_slices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.coeffs" class="md-nav__link">
    <span class="md-ellipsis">
      coeffs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.levels" class="md-nav__link">
    <span class="md-ellipsis">
      levels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.modes" class="md-nav__link">
    <span class="md-ellipsis">
      modes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.ndim" class="md-nav__link">
    <span class="md-ellipsis">
      ndim
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.ndim_transform" class="md-nav__link">
    <span class="md-ellipsis">
      ndim_transform
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.wavelet_names" class="md-nav__link">
    <span class="md-ellipsis">
      wavelet_names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.wavelets" class="md-nav__link">
    <span class="md-ellipsis">
      wavelets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__getitem__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.__getitem__--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.__setitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __setitem__
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__setitem__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.__setitem__--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.detail_keys" class="md-nav__link">
    <span class="md-ellipsis">
      detail_keys
    </span>
  </a>
  
    <nav class="md-nav" aria-label="detail_keys">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.detail_keys--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.Node" class="md-nav__link">
    <span class="md-ellipsis">
      Node
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.Node2D" class="md-nav__link">
    <span class="md-ellipsis">
      Node2D
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.NodeND" class="md-nav__link">
    <span class="md-ellipsis">
      NodeND
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NodeND">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.NodeND--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.WaveletPacket" class="md-nav__link">
    <span class="md-ellipsis">
      WaveletPacket
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WaveletPacket">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacket--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacket.get_level" class="md-nav__link">
    <span class="md-ellipsis">
      get_level
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_level">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacket.get_level--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacket.get_level--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacket.get_level--references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacket.reconstruct" class="md-nav__link">
    <span class="md-ellipsis">
      reconstruct
    </span>
  </a>
  
    <nav class="md-nav" aria-label="reconstruct">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacket.reconstruct--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.WaveletPacket2D" class="md-nav__link">
    <span class="md-ellipsis">
      WaveletPacket2D
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WaveletPacket2D">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacket2D--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacket2D.get_level" class="md-nav__link">
    <span class="md-ellipsis">
      get_level
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_level">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacket2D.get_level--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacket2D.get_level--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacket2D.get_level--references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacket2D.reconstruct" class="md-nav__link">
    <span class="md-ellipsis">
      reconstruct
    </span>
  </a>
  
    <nav class="md-nav" aria-label="reconstruct">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacket2D.reconstruct--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.WaveletPacketND" class="md-nav__link">
    <span class="md-ellipsis">
      WaveletPacketND
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WaveletPacketND">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacketND--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacketND.get_level" class="md-nav__link">
    <span class="md-ellipsis">
      get_level
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_level">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacketND.get_level--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacketND.reconstruct" class="md-nav__link">
    <span class="md-ellipsis">
      reconstruct
    </span>
  </a>
  
    <nav class="md-nav" aria-label="reconstruct">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacketND.reconstruct--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.array_to_coeffs" class="md-nav__link">
    <span class="md-ellipsis">
      array_to_coeffs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="array_to_coeffs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.array_to_coeffs--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.array_to_coeffs--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.array_to_coeffs--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.array_to_coeffs--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.array_to_coeffs--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.central_frequency" class="md-nav__link">
    <span class="md-ellipsis">
      central_frequency
    </span>
  </a>
  
    <nav class="md-nav" aria-label="central_frequency">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.central_frequency--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.central_frequency--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.coeffs_to_array" class="md-nav__link">
    <span class="md-ellipsis">
      coeffs_to_array
    </span>
  </a>
  
    <nav class="md-nav" aria-label="coeffs_to_array">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.coeffs_to_array--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.coeffs_to_array--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.coeffs_to_array--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.coeffs_to_array--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.coeffs_to_array--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.cwt" class="md-nav__link">
    <span class="md-ellipsis">
      cwt
    </span>
  </a>
  
    <nav class="md-nav" aria-label="cwt">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.cwt--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.cwt--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.cwt--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.cwt--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.downcoef" class="md-nav__link">
    <span class="md-ellipsis">
      downcoef
    </span>
  </a>
  
    <nav class="md-nav" aria-label="downcoef">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.downcoef--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.downcoef--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.downcoef--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.dwt" class="md-nav__link">
    <span class="md-ellipsis">
      dwt
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dwt">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.dwt--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.dwt--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.dwt--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.dwt--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.dwt2" class="md-nav__link">
    <span class="md-ellipsis">
      dwt2
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dwt2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.dwt2--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.dwt2--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.dwt2--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.dwt_coeff_len" class="md-nav__link">
    <span class="md-ellipsis">
      dwt_coeff_len
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dwt_coeff_len">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.dwt_coeff_len--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.dwt_coeff_len--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.dwt_coeff_len--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.dwt_max_level" class="md-nav__link">
    <span class="md-ellipsis">
      dwt_max_level
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dwt_max_level">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.dwt_max_level--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.dwt_max_level--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.dwt_max_level--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.dwt_max_level--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.dwtn" class="md-nav__link">
    <span class="md-ellipsis">
      dwtn
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dwtn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.dwtn--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.dwtn--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.dwtn_max_level" class="md-nav__link">
    <span class="md-ellipsis">
      dwtn_max_level
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dwtn_max_level">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.dwtn_max_level--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.dwtn_max_level--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.dwtn_max_level--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.dwtn_max_level--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.frequency2scale" class="md-nav__link">
    <span class="md-ellipsis">
      frequency2scale
    </span>
  </a>
  
    <nav class="md-nav" aria-label="frequency2scale">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.frequency2scale--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.frequency2scale--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.fswavedecn" class="md-nav__link">
    <span class="md-ellipsis">
      fswavedecn
    </span>
  </a>
  
    <nav class="md-nav" aria-label="fswavedecn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.fswavedecn--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.fswavedecn--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.fswavedecn--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.fswavedecn--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.fswavedecn--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.fswavedecn--references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.fswaverecn" class="md-nav__link">
    <span class="md-ellipsis">
      fswaverecn
    </span>
  </a>
  
    <nav class="md-nav" aria-label="fswaverecn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.fswaverecn--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.fswaverecn--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.fswaverecn--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.fswaverecn--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.fswaverecn--references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.idwt" class="md-nav__link">
    <span class="md-ellipsis">
      idwt
    </span>
  </a>
  
    <nav class="md-nav" aria-label="idwt">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.idwt--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.idwt--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.idwt--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.idwt2" class="md-nav__link">
    <span class="md-ellipsis">
      idwt2
    </span>
  </a>
  
    <nav class="md-nav" aria-label="idwt2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.idwt2--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.idwt2--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.idwtn" class="md-nav__link">
    <span class="md-ellipsis">
      idwtn
    </span>
  </a>
  
    <nav class="md-nav" aria-label="idwtn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.idwtn--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.idwtn--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.imra" class="md-nav__link">
    <span class="md-ellipsis">
      imra
    </span>
  </a>
  
    <nav class="md-nav" aria-label="imra">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.imra--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.imra--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.imra--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.imra--references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.imra2" class="md-nav__link">
    <span class="md-ellipsis">
      imra2
    </span>
  </a>
  
    <nav class="md-nav" aria-label="imra2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.imra2--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.imra2--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.imra2--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.imra2--references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.imran" class="md-nav__link">
    <span class="md-ellipsis">
      imran
    </span>
  </a>
  
    <nav class="md-nav" aria-label="imran">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.imran--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.imran--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.imran--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.imran--references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.integrate_wavelet" class="md-nav__link">
    <span class="md-ellipsis">
      integrate_wavelet
    </span>
  </a>
  
    <nav class="md-nav" aria-label="integrate_wavelet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.integrate_wavelet--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.integrate_wavelet--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.integrate_wavelet--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.iswt" class="md-nav__link">
    <span class="md-ellipsis">
      iswt
    </span>
  </a>
  
    <nav class="md-nav" aria-label="iswt">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.iswt--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.iswt--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.iswt--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.iswt2" class="md-nav__link">
    <span class="md-ellipsis">
      iswt2
    </span>
  </a>
  
    <nav class="md-nav" aria-label="iswt2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.iswt2--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.iswt2--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.iswt2--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.iswtn" class="md-nav__link">
    <span class="md-ellipsis">
      iswtn
    </span>
  </a>
  
    <nav class="md-nav" aria-label="iswtn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.iswtn--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.iswtn--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.iswtn--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.mra" class="md-nav__link">
    <span class="md-ellipsis">
      mra
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mra">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.mra--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.mra--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.mra--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.mra--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.mra--references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.mra2" class="md-nav__link">
    <span class="md-ellipsis">
      mra2
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mra2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.mra2--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.mra2--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.mra2--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.mra2--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.mra2--references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.mran" class="md-nav__link">
    <span class="md-ellipsis">
      mran
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mran">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.mran--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.mran--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.mran--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.mran--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.mran--references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.orthogonal_filter_bank" class="md-nav__link">
    <span class="md-ellipsis">
      orthogonal_filter_bank
    </span>
  </a>
  
    <nav class="md-nav" aria-label="orthogonal_filter_bank">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.orthogonal_filter_bank--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.orthogonal_filter_bank--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.pad" class="md-nav__link">
    <span class="md-ellipsis">
      pad
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pad">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.pad--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.pad--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.pad--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.qmf" class="md-nav__link">
    <span class="md-ellipsis">
      qmf
    </span>
  </a>
  
    <nav class="md-nav" aria-label="qmf">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.qmf--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.qmf--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.ravel_coeffs" class="md-nav__link">
    <span class="md-ellipsis">
      ravel_coeffs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ravel_coeffs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.ravel_coeffs--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.ravel_coeffs--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.ravel_coeffs--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.ravel_coeffs--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.scale2frequency" class="md-nav__link">
    <span class="md-ellipsis">
      scale2frequency
    </span>
  </a>
  
    <nav class="md-nav" aria-label="scale2frequency">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.scale2frequency--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.scale2frequency--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.swt" class="md-nav__link">
    <span class="md-ellipsis">
      swt
    </span>
  </a>
  
    <nav class="md-nav" aria-label="swt">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.swt--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.swt--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.swt--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.swt--references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.swt2" class="md-nav__link">
    <span class="md-ellipsis">
      swt2
    </span>
  </a>
  
    <nav class="md-nav" aria-label="swt2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.swt2--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.swt2--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.swt2--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.swtn" class="md-nav__link">
    <span class="md-ellipsis">
      swtn
    </span>
  </a>
  
    <nav class="md-nav" aria-label="swtn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.swtn--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.swtn--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.swtn--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.threshold" class="md-nav__link">
    <span class="md-ellipsis">
      threshold
    </span>
  </a>
  
    <nav class="md-nav" aria-label="threshold">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.threshold--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.threshold--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.threshold--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.threshold--references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.threshold--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.threshold_firm" class="md-nav__link">
    <span class="md-ellipsis">
      threshold_firm
    </span>
  </a>
  
    <nav class="md-nav" aria-label="threshold_firm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.threshold_firm--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.threshold_firm--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.threshold_firm--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.threshold_firm--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.threshold_firm--references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.unravel_coeffs" class="md-nav__link">
    <span class="md-ellipsis">
      unravel_coeffs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="unravel_coeffs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.unravel_coeffs--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.unravel_coeffs--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.unravel_coeffs--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.unravel_coeffs--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.upcoef" class="md-nav__link">
    <span class="md-ellipsis">
      upcoef
    </span>
  </a>
  
    <nav class="md-nav" aria-label="upcoef">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.upcoef--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.upcoef--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.upcoef--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.upcoef--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.wavedec" class="md-nav__link">
    <span class="md-ellipsis">
      wavedec
    </span>
  </a>
  
    <nav class="md-nav" aria-label="wavedec">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.wavedec--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.wavedec--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.wavedec--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.wavedec2" class="md-nav__link">
    <span class="md-ellipsis">
      wavedec2
    </span>
  </a>
  
    <nav class="md-nav" aria-label="wavedec2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.wavedec2--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.wavedec2--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.wavedec2--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.wavedec2--levels" class="md-nav__link">
    <span class="md-ellipsis">
      Levels:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.wavedecn" class="md-nav__link">
    <span class="md-ellipsis">
      wavedecn
    </span>
  </a>
  
    <nav class="md-nav" aria-label="wavedecn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.wavedecn--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.wavedecn--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.wavedecn--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.wavedecn--levels" class="md-nav__link">
    <span class="md-ellipsis">
      Levels:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.wavedecn_shapes" class="md-nav__link">
    <span class="md-ellipsis">
      wavedecn_shapes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="wavedecn_shapes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.wavedecn_shapes--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.wavedecn_shapes--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.wavedecn_shapes--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.wavedecn_size" class="md-nav__link">
    <span class="md-ellipsis">
      wavedecn_size
    </span>
  </a>
  
    <nav class="md-nav" aria-label="wavedecn_size">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.wavedecn_size--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.wavedecn_size--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.wavedecn_size--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.waverec" class="md-nav__link">
    <span class="md-ellipsis">
      waverec
    </span>
  </a>
  
    <nav class="md-nav" aria-label="waverec">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.waverec--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.waverec--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.waverec--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.waverec2" class="md-nav__link">
    <span class="md-ellipsis">
      waverec2
    </span>
  </a>
  
    <nav class="md-nav" aria-label="waverec2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.waverec2--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.waverec2--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.waverec2--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.waverec2--levels" class="md-nav__link">
    <span class="md-ellipsis">
      Levels:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.waverecn" class="md-nav__link">
    <span class="md-ellipsis">
      waverecn
    </span>
  </a>
  
    <nav class="md-nav" aria-label="waverecn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.waverecn--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.waverecn--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.waverecn--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.waverecn--levels" class="md-nav__link">
    <span class="md-ellipsis">
      Levels:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Development guide
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pywt" class="md-nav__link">
    <span class="md-ellipsis">
      pywt
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.BaseNode" class="md-nav__link">
    <span class="md-ellipsis">
      BaseNode
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseNode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.path_tuple" class="md-nav__link">
    <span class="md-ellipsis">
      path_tuple
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.__delitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __delitem__
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__delitem__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.__delitem__--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__getitem__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.__getitem__--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.__getitem__--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.__setitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __setitem__
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__setitem__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.__setitem__--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.decompose" class="md-nav__link">
    <span class="md-ellipsis">
      decompose
    </span>
  </a>
  
    <nav class="md-nav" aria-label="decompose">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.decompose--note" class="md-nav__link">
    <span class="md-ellipsis">
      Note
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.get_leaf_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      get_leaf_nodes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_leaf_nodes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.get_leaf_nodes--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.get_subnode" class="md-nav__link">
    <span class="md-ellipsis">
      get_subnode
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_subnode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.get_subnode--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.reconstruct" class="md-nav__link">
    <span class="md-ellipsis">
      reconstruct
    </span>
  </a>
  
    <nav class="md-nav" aria-label="reconstruct">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.reconstruct--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.walk" class="md-nav__link">
    <span class="md-ellipsis">
      walk
    </span>
  </a>
  
    <nav class="md-nav" aria-label="walk">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.walk--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.walk_depth" class="md-nav__link">
    <span class="md-ellipsis">
      walk_depth
    </span>
  </a>
  
    <nav class="md-nav" aria-label="walk_depth">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.BaseNode.walk_depth--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult" class="md-nav__link">
    <span class="md-ellipsis">
      FswavedecnResult
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FswavedecnResult">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.approx" class="md-nav__link">
    <span class="md-ellipsis">
      approx
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.axes" class="md-nav__link">
    <span class="md-ellipsis">
      axes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.coeff_slices" class="md-nav__link">
    <span class="md-ellipsis">
      coeff_slices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.coeffs" class="md-nav__link">
    <span class="md-ellipsis">
      coeffs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.levels" class="md-nav__link">
    <span class="md-ellipsis">
      levels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.modes" class="md-nav__link">
    <span class="md-ellipsis">
      modes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.ndim" class="md-nav__link">
    <span class="md-ellipsis">
      ndim
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.ndim_transform" class="md-nav__link">
    <span class="md-ellipsis">
      ndim_transform
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.wavelet_names" class="md-nav__link">
    <span class="md-ellipsis">
      wavelet_names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.wavelets" class="md-nav__link">
    <span class="md-ellipsis">
      wavelets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__getitem__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.__getitem__--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.__setitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __setitem__
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__setitem__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.__setitem__--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.detail_keys" class="md-nav__link">
    <span class="md-ellipsis">
      detail_keys
    </span>
  </a>
  
    <nav class="md-nav" aria-label="detail_keys">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.FswavedecnResult.detail_keys--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.Node" class="md-nav__link">
    <span class="md-ellipsis">
      Node
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.Node2D" class="md-nav__link">
    <span class="md-ellipsis">
      Node2D
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.NodeND" class="md-nav__link">
    <span class="md-ellipsis">
      NodeND
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NodeND">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.NodeND--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.WaveletPacket" class="md-nav__link">
    <span class="md-ellipsis">
      WaveletPacket
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WaveletPacket">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacket--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacket.get_level" class="md-nav__link">
    <span class="md-ellipsis">
      get_level
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_level">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacket.get_level--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacket.get_level--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacket.get_level--references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacket.reconstruct" class="md-nav__link">
    <span class="md-ellipsis">
      reconstruct
    </span>
  </a>
  
    <nav class="md-nav" aria-label="reconstruct">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacket.reconstruct--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.WaveletPacket2D" class="md-nav__link">
    <span class="md-ellipsis">
      WaveletPacket2D
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WaveletPacket2D">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacket2D--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacket2D.get_level" class="md-nav__link">
    <span class="md-ellipsis">
      get_level
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_level">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacket2D.get_level--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacket2D.get_level--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacket2D.get_level--references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacket2D.reconstruct" class="md-nav__link">
    <span class="md-ellipsis">
      reconstruct
    </span>
  </a>
  
    <nav class="md-nav" aria-label="reconstruct">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacket2D.reconstruct--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.WaveletPacketND" class="md-nav__link">
    <span class="md-ellipsis">
      WaveletPacketND
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WaveletPacketND">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacketND--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacketND.get_level" class="md-nav__link">
    <span class="md-ellipsis">
      get_level
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_level">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacketND.get_level--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacketND.reconstruct" class="md-nav__link">
    <span class="md-ellipsis">
      reconstruct
    </span>
  </a>
  
    <nav class="md-nav" aria-label="reconstruct">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.WaveletPacketND.reconstruct--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.array_to_coeffs" class="md-nav__link">
    <span class="md-ellipsis">
      array_to_coeffs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="array_to_coeffs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.array_to_coeffs--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.array_to_coeffs--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.array_to_coeffs--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.array_to_coeffs--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.array_to_coeffs--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.central_frequency" class="md-nav__link">
    <span class="md-ellipsis">
      central_frequency
    </span>
  </a>
  
    <nav class="md-nav" aria-label="central_frequency">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.central_frequency--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.central_frequency--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.coeffs_to_array" class="md-nav__link">
    <span class="md-ellipsis">
      coeffs_to_array
    </span>
  </a>
  
    <nav class="md-nav" aria-label="coeffs_to_array">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.coeffs_to_array--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.coeffs_to_array--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.coeffs_to_array--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.coeffs_to_array--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.coeffs_to_array--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.cwt" class="md-nav__link">
    <span class="md-ellipsis">
      cwt
    </span>
  </a>
  
    <nav class="md-nav" aria-label="cwt">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.cwt--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.cwt--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.cwt--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.cwt--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.downcoef" class="md-nav__link">
    <span class="md-ellipsis">
      downcoef
    </span>
  </a>
  
    <nav class="md-nav" aria-label="downcoef">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.downcoef--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.downcoef--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.downcoef--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.dwt" class="md-nav__link">
    <span class="md-ellipsis">
      dwt
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dwt">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.dwt--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.dwt--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.dwt--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.dwt--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.dwt2" class="md-nav__link">
    <span class="md-ellipsis">
      dwt2
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dwt2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.dwt2--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.dwt2--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.dwt2--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.dwt_coeff_len" class="md-nav__link">
    <span class="md-ellipsis">
      dwt_coeff_len
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dwt_coeff_len">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.dwt_coeff_len--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.dwt_coeff_len--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.dwt_coeff_len--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.dwt_max_level" class="md-nav__link">
    <span class="md-ellipsis">
      dwt_max_level
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dwt_max_level">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.dwt_max_level--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.dwt_max_level--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.dwt_max_level--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.dwt_max_level--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.dwtn" class="md-nav__link">
    <span class="md-ellipsis">
      dwtn
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dwtn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.dwtn--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.dwtn--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.dwtn_max_level" class="md-nav__link">
    <span class="md-ellipsis">
      dwtn_max_level
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dwtn_max_level">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.dwtn_max_level--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.dwtn_max_level--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.dwtn_max_level--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.dwtn_max_level--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.frequency2scale" class="md-nav__link">
    <span class="md-ellipsis">
      frequency2scale
    </span>
  </a>
  
    <nav class="md-nav" aria-label="frequency2scale">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.frequency2scale--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.frequency2scale--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.fswavedecn" class="md-nav__link">
    <span class="md-ellipsis">
      fswavedecn
    </span>
  </a>
  
    <nav class="md-nav" aria-label="fswavedecn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.fswavedecn--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.fswavedecn--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.fswavedecn--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.fswavedecn--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.fswavedecn--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.fswavedecn--references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.fswaverecn" class="md-nav__link">
    <span class="md-ellipsis">
      fswaverecn
    </span>
  </a>
  
    <nav class="md-nav" aria-label="fswaverecn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.fswaverecn--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.fswaverecn--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.fswaverecn--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.fswaverecn--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.fswaverecn--references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.idwt" class="md-nav__link">
    <span class="md-ellipsis">
      idwt
    </span>
  </a>
  
    <nav class="md-nav" aria-label="idwt">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.idwt--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.idwt--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.idwt--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.idwt2" class="md-nav__link">
    <span class="md-ellipsis">
      idwt2
    </span>
  </a>
  
    <nav class="md-nav" aria-label="idwt2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.idwt2--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.idwt2--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.idwtn" class="md-nav__link">
    <span class="md-ellipsis">
      idwtn
    </span>
  </a>
  
    <nav class="md-nav" aria-label="idwtn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.idwtn--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.idwtn--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.imra" class="md-nav__link">
    <span class="md-ellipsis">
      imra
    </span>
  </a>
  
    <nav class="md-nav" aria-label="imra">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.imra--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.imra--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.imra--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.imra--references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.imra2" class="md-nav__link">
    <span class="md-ellipsis">
      imra2
    </span>
  </a>
  
    <nav class="md-nav" aria-label="imra2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.imra2--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.imra2--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.imra2--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.imra2--references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.imran" class="md-nav__link">
    <span class="md-ellipsis">
      imran
    </span>
  </a>
  
    <nav class="md-nav" aria-label="imran">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.imran--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.imran--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.imran--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.imran--references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.integrate_wavelet" class="md-nav__link">
    <span class="md-ellipsis">
      integrate_wavelet
    </span>
  </a>
  
    <nav class="md-nav" aria-label="integrate_wavelet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.integrate_wavelet--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.integrate_wavelet--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.integrate_wavelet--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.iswt" class="md-nav__link">
    <span class="md-ellipsis">
      iswt
    </span>
  </a>
  
    <nav class="md-nav" aria-label="iswt">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.iswt--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.iswt--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.iswt--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.iswt2" class="md-nav__link">
    <span class="md-ellipsis">
      iswt2
    </span>
  </a>
  
    <nav class="md-nav" aria-label="iswt2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.iswt2--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.iswt2--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.iswt2--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.iswtn" class="md-nav__link">
    <span class="md-ellipsis">
      iswtn
    </span>
  </a>
  
    <nav class="md-nav" aria-label="iswtn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.iswtn--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.iswtn--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.iswtn--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.mra" class="md-nav__link">
    <span class="md-ellipsis">
      mra
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mra">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.mra--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.mra--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.mra--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.mra--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.mra--references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.mra2" class="md-nav__link">
    <span class="md-ellipsis">
      mra2
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mra2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.mra2--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.mra2--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.mra2--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.mra2--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.mra2--references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.mran" class="md-nav__link">
    <span class="md-ellipsis">
      mran
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mran">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.mran--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.mran--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.mran--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.mran--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.mran--references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.orthogonal_filter_bank" class="md-nav__link">
    <span class="md-ellipsis">
      orthogonal_filter_bank
    </span>
  </a>
  
    <nav class="md-nav" aria-label="orthogonal_filter_bank">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.orthogonal_filter_bank--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.orthogonal_filter_bank--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.pad" class="md-nav__link">
    <span class="md-ellipsis">
      pad
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pad">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.pad--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.pad--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.pad--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.qmf" class="md-nav__link">
    <span class="md-ellipsis">
      qmf
    </span>
  </a>
  
    <nav class="md-nav" aria-label="qmf">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.qmf--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.qmf--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.ravel_coeffs" class="md-nav__link">
    <span class="md-ellipsis">
      ravel_coeffs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ravel_coeffs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.ravel_coeffs--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.ravel_coeffs--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.ravel_coeffs--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.ravel_coeffs--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.scale2frequency" class="md-nav__link">
    <span class="md-ellipsis">
      scale2frequency
    </span>
  </a>
  
    <nav class="md-nav" aria-label="scale2frequency">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.scale2frequency--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.scale2frequency--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.swt" class="md-nav__link">
    <span class="md-ellipsis">
      swt
    </span>
  </a>
  
    <nav class="md-nav" aria-label="swt">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.swt--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.swt--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.swt--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.swt--references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.swt2" class="md-nav__link">
    <span class="md-ellipsis">
      swt2
    </span>
  </a>
  
    <nav class="md-nav" aria-label="swt2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.swt2--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.swt2--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.swt2--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.swtn" class="md-nav__link">
    <span class="md-ellipsis">
      swtn
    </span>
  </a>
  
    <nav class="md-nav" aria-label="swtn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.swtn--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.swtn--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.swtn--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.threshold" class="md-nav__link">
    <span class="md-ellipsis">
      threshold
    </span>
  </a>
  
    <nav class="md-nav" aria-label="threshold">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.threshold--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.threshold--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.threshold--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.threshold--references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.threshold--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.threshold_firm" class="md-nav__link">
    <span class="md-ellipsis">
      threshold_firm
    </span>
  </a>
  
    <nav class="md-nav" aria-label="threshold_firm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.threshold_firm--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.threshold_firm--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.threshold_firm--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.threshold_firm--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.threshold_firm--references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.unravel_coeffs" class="md-nav__link">
    <span class="md-ellipsis">
      unravel_coeffs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="unravel_coeffs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.unravel_coeffs--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.unravel_coeffs--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.unravel_coeffs--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.unravel_coeffs--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.upcoef" class="md-nav__link">
    <span class="md-ellipsis">
      upcoef
    </span>
  </a>
  
    <nav class="md-nav" aria-label="upcoef">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.upcoef--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.upcoef--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.upcoef--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.upcoef--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.wavedec" class="md-nav__link">
    <span class="md-ellipsis">
      wavedec
    </span>
  </a>
  
    <nav class="md-nav" aria-label="wavedec">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.wavedec--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.wavedec--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.wavedec--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.wavedec2" class="md-nav__link">
    <span class="md-ellipsis">
      wavedec2
    </span>
  </a>
  
    <nav class="md-nav" aria-label="wavedec2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.wavedec2--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.wavedec2--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.wavedec2--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.wavedec2--levels" class="md-nav__link">
    <span class="md-ellipsis">
      Levels:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.wavedecn" class="md-nav__link">
    <span class="md-ellipsis">
      wavedecn
    </span>
  </a>
  
    <nav class="md-nav" aria-label="wavedecn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.wavedecn--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.wavedecn--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.wavedecn--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.wavedecn--levels" class="md-nav__link">
    <span class="md-ellipsis">
      Levels:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.wavedecn_shapes" class="md-nav__link">
    <span class="md-ellipsis">
      wavedecn_shapes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="wavedecn_shapes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.wavedecn_shapes--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.wavedecn_shapes--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.wavedecn_shapes--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.wavedecn_size" class="md-nav__link">
    <span class="md-ellipsis">
      wavedecn_size
    </span>
  </a>
  
    <nav class="md-nav" aria-label="wavedecn_size">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.wavedecn_size--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.wavedecn_size--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.wavedecn_size--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.waverec" class="md-nav__link">
    <span class="md-ellipsis">
      waverec
    </span>
  </a>
  
    <nav class="md-nav" aria-label="waverec">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.waverec--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.waverec--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.waverec--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.waverec2" class="md-nav__link">
    <span class="md-ellipsis">
      waverec2
    </span>
  </a>
  
    <nav class="md-nav" aria-label="waverec2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.waverec2--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.waverec2--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.waverec2--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.waverec2--levels" class="md-nav__link">
    <span class="md-ellipsis">
      Levels:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pywt.waverecn" class="md-nav__link">
    <span class="md-ellipsis">
      waverecn
    </span>
  </a>
  
    <nav class="md-nav" aria-label="waverecn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pywt.waverecn--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.waverecn--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.waverecn--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywt.waverecn--levels" class="md-nav__link">
    <span class="md-ellipsis">
      Levels:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="api-reference">API Reference</h1>
<div class="doc doc-object doc-module">
<a id="pywt"></a>
<div class="doc doc-contents first">
<p>Discrete forward and inverse wavelet transform, stationary wavelet transform,
wavelet packets signal decomposition and reconstruction module.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="pywt.BaseNode">
<code>BaseNode</code>
</h2>
<div class="doc doc-contents">
<p>BaseNode for wavelet packet 1D and 2D tree nodes.</p>
<p>The BaseNode is a base class for <code>Node</code> and <code>Node2D</code>.
It should not be used directly unless creating a new transformation
type. It is included here to document the common interface of 1D
and 2D node and wavelet packet transform classes.</p>
<h4 id="pywt.BaseNode--parameters">Parameters</h4>
<p>parent :
    Parent node. If parent is None then the node is considered detached
    (ie root).
data : 1D or 2D array
    Data associated with the node. 1D or 2D numeric array, depending on the
    transform type.
node_name :
    A name identifying the coefficients type.
    See <code>Node.node_name</code> and <code>Node2D.node_name</code>
    for information on the accepted subnodes names.</p>
<details class="quote">
<summary>Source code in <code>pywt/_wavelet_packets.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BaseNode</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    BaseNode for wavelet packet 1D and 2D tree nodes.</span>

<span class="sd">    The BaseNode is a base class for `Node` and `Node2D`.</span>
<span class="sd">    It should not be used directly unless creating a new transformation</span>
<span class="sd">    type. It is included here to document the common interface of 1D</span>
<span class="sd">    and 2D node and wavelet packet transform classes.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    parent :</span>
<span class="sd">        Parent node. If parent is None then the node is considered detached</span>
<span class="sd">        (ie root).</span>
<span class="sd">    data : 1D or 2D array</span>
<span class="sd">        Data associated with the node. 1D or 2D numeric array, depending on the</span>
<span class="sd">        transform type.</span>
<span class="sd">    node_name :</span>
<span class="sd">        A name identifying the coefficients type.</span>
<span class="sd">        See `Node.node_name` and `Node2D.node_name`</span>
<span class="sd">        for information on the accepted subnodes names.</span>
<span class="sd">    """</span>

    <span class="c1"># PART_LEN and PARTS attributes that define path tokens for node[] lookup</span>
    <span class="c1"># must be defined in subclasses.</span>
    <span class="n">PART_LEN</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">PARTS</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">node_name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wavelet</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">wavelet</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">mode</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">level</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_maxlevel</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">maxlevel</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">path</span> <span class="o">+</span> <span class="n">node_name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">axes</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wavelet</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="s2">""</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># data - signal on level 0, coeffs on higher levels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="c1"># Need to retain original data size/shape so we can trim any excess</span>
        <span class="c1"># boundary coefficients from the inverse transform.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_shape</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_init_subnodes</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_init_subnodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">PARTS</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_node</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_create_subnode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">part</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_create_subnode_base</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_cls</span><span class="p">,</span> <span class="n">part</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                             <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_node_name</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">overwrite</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node</span><span class="p">(</span><span class="n">part</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">node_cls</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">part</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_node</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">node</span>

    <span class="k">def</span> <span class="nf">_get_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">part</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">part</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">part</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">part</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_delete_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">part</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_node</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_validate_node_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">part</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">part</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">PARTS</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Subnode name must be in [</span><span class="si">{}</span><span class="s2">], not '</span><span class="si">{}</span><span class="s2">'."</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">', '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">"'</span><span class="si">%s</span><span class="s2">'"</span> <span class="o">%</span> <span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">PARTS</span><span class="p">),</span> <span class="n">part</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">path_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""The path to the current node in tuple form.</span>

<span class="sd">        The length of the tuple is equal to the number of decomposition levels.</span>
<span class="sd">        """</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span>
        <span class="n">nlev</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">//</span><span class="bp">self</span><span class="o">.</span><span class="n">PART_LEN</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">path</span><span class="p">[(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">PART_LEN</span><span class="p">:</span><span class="n">n</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">PART_LEN</span><span class="p">]</span>
                      <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nlev</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>

    <span class="k">def</span> <span class="nf">_evaluate_maxlevel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evaluate_from</span><span class="o">=</span><span class="s1">'parent'</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Try to find the value of maximum decomposition level if it is not</span>
<span class="sd">        specified explicitly.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        evaluate_from : {'parent', 'subnodes'}</span>
<span class="sd">        """</span>
        <span class="k">assert</span> <span class="n">evaluate_from</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">'parent'</span><span class="p">,</span> <span class="s1">'subnodes'</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_maxlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_maxlevel</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">+</span> <span class="n">dwt_max_level</span><span class="p">(</span>
                <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelet</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">evaluate_from</span> <span class="o">==</span> <span class="s1">'parent'</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">_evaluate_maxlevel</span><span class="p">(</span><span class="n">evaluate_from</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">evaluate_from</span> <span class="o">==</span> <span class="s1">'subnodes'</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">node_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">PARTS</span><span class="p">:</span>
                <span class="n">node</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">level</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">_evaluate_maxlevel</span><span class="p">(</span><span class="n">evaluate_from</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">level</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">level</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">maxlevel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_maxlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_maxlevel</span>

        <span class="c1"># Try getting the maxlevel from parents first</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_maxlevel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evaluate_maxlevel</span><span class="p">(</span><span class="n">evaluate_from</span><span class="o">=</span><span class="s1">'parent'</span><span class="p">)</span>

        <span class="c1"># If not found, check whether it can be evaluated from subnodes</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_maxlevel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_maxlevel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evaluate_maxlevel</span><span class="p">(</span><span class="n">evaluate_from</span><span class="o">=</span><span class="s1">'subnodes'</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_maxlevel</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">node_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">PART_LEN</span><span class="p">:]</span>

    <span class="k">def</span> <span class="nf">decompose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Decompose node data creating DWT coefficients subnodes.</span>

<span class="sd">        Performs Discrete Wavelet Transform on the `~BaseNode.data` and</span>
<span class="sd">        returns transform coefficients.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        Descends to subnodes and recursively</span>
<span class="sd">        calls `~BaseNode.reconstruct` on them.</span>

<span class="sd">        """</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlevel</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decompose</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Maximum decomposition level reached."</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_decompose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">reconstruct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Reconstruct node from subnodes.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        update : bool, optional</span>
<span class="sd">            If True, then reconstructed data replaces the current</span>
<span class="sd">            node data (default: False).</span>

<span class="sd">        Returns:</span>
<span class="sd">            - original node data if subnodes do not exist</span>
<span class="sd">            - IDWT of subnodes otherwise.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_any_subnode</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reconstruct</span><span class="p">(</span><span class="n">update</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_reconstruct</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>  <span class="c1"># override this in subclasses</span>

    <span class="k">def</span> <span class="nf">get_subnode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">part</span><span class="p">,</span> <span class="n">decompose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns subnode or None (see `decomposition` flag description).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        part :</span>
<span class="sd">            Subnode name</span>
<span class="sd">        decompose : bool, optional</span>
<span class="sd">            If the param is True and corresponding subnode does not</span>
<span class="sd">            exist, the subnode will be created using coefficients</span>
<span class="sd">            from the DWT decomposition of the current node.</span>
<span class="sd">            (default: True)</span>
<span class="sd">        """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_node_name</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>
        <span class="n">subnode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">subnode</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">decompose</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span>
            <span class="n">subnode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">subnode</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Find node represented by the given path.</span>

<span class="sd">        Similar to `~BaseNode.get_subnode` method with `decompose=True`, but</span>
<span class="sd">        can access nodes on any level in the decomposition tree.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path : str</span>
<span class="sd">            String composed of node names. See `Node.node_name` and</span>
<span class="sd">            `Node2D.node_name` for node naming convention.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        If node does not exist yet, it will be created by decomposition of its</span>
<span class="sd">        parent node.</span>
<span class="sd">        """</span>
        <span class="n">errmsg</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"Invalid path parameter type - expected string or "</span>
                  <span class="s2">"tuple of strings but got </span><span class="si">%s</span><span class="s2">."</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="c1"># concatenate tuple of strings into a single string</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">path</span> <span class="o">=</span> <span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlevel</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">PART_LEN</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">"Path length is out of range."</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">path</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subnode</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">PART_LEN</span><span class="p">],</span> <span class="kc">True</span><span class="p">)[</span>
                    <span class="n">path</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">PART_LEN</span><span class="p">:]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Set node or node's data in the decomposition tree. Nodes are</span>
<span class="sd">        identified by string `path`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path : str</span>
<span class="sd">            String composed of node names.</span>
<span class="sd">        data : array or BaseNode subclass.</span>
<span class="sd">        """</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">maxlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span>
                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlevel</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">PART_LEN</span>
            <span class="p">):</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">"Path length out of range."</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">path</span><span class="p">:</span>
                <span class="n">subnode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subnode</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">PART_LEN</span><span class="p">],</span> <span class="kc">False</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">subnode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_create_subnode</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">PART_LEN</span><span class="p">],</span> <span class="kc">None</span><span class="p">)</span>
                    <span class="n">subnode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subnode</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">PART_LEN</span><span class="p">],</span> <span class="kc">False</span><span class="p">)</span>
                <span class="n">subnode</span><span class="p">[</span><span class="n">path</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">PART_LEN</span><span class="p">:]]</span> <span class="o">=</span> <span class="n">data</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">BaseNode</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                <span class="c1"># convert data to nearest supported dtype</span>
                <span class="n">dtype</span> <span class="o">=</span> <span class="n">_check_dtype</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">dtype</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">"Invalid path parameter type - expected string but"</span>
                            <span class="s2">" got </span><span class="si">%s</span><span class="s2">."</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Remove node from the tree.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path : str</span>
<span class="sd">            String composed of node names.</span>
<span class="sd">        """</span>
        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">path</span><span class="p">]</span>
        <span class="c1"># don't clear node value and subnodes (node may still exist outside</span>
        <span class="c1"># the tree)</span>
        <span class="c1"># # node._init_subnodes()</span>
        <span class="c1"># # node.data = None</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span>
        <span class="n">node</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># TODO</span>
        <span class="k">if</span> <span class="n">parent</span> <span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">node_name</span><span class="p">:</span>
            <span class="n">parent</span><span class="o">.</span><span class="n">_delete_node</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">node_name</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_any_subnode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_node</span><span class="p">(</span><span class="n">part</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">PARTS</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_leaf_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">decompose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns leaf nodes.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        decompose : bool, optional</span>
<span class="sd">            (default: True)</span>
<span class="sd">        """</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">def</span> <span class="nf">collect</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">level</span> <span class="o">==</span> <span class="n">node</span><span class="o">.</span><span class="n">maxlevel</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">node</span><span class="o">.</span><span class="n">is_empty</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">decompose</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">node</span><span class="o">.</span><span class="n">has_any_subnode</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">collect</span><span class="p">,</span> <span class="n">decompose</span><span class="o">=</span><span class="n">decompose</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">decompose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Traverses the decomposition tree and calls</span>
<span class="sd">        ``func(node, *args, **kwargs)`` on every node. If `func` returns True,</span>
<span class="sd">        descending to subnodes will continue.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        func : callable</span>
<span class="sd">            Callable accepting `BaseNode` as the first param and</span>
<span class="sd">            optional positional and keyword arguments</span>
<span class="sd">        args :</span>
<span class="sd">            func params</span>
<span class="sd">        kwargs :</span>
<span class="sd">            func keyword params</span>
<span class="sd">        decompose : bool, optional</span>
<span class="sd">            If True (default), the method will also try to decompose the tree</span>
<span class="sd">            up to the `maximum level &lt;BaseNode.maxlevel&gt;`.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="n">kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlevel</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">PARTS</span><span class="p">:</span>
                <span class="n">subnode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subnode</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">decompose</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">subnode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">subnode</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">decompose</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">walk_depth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">decompose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Walk tree and call func on every node starting from the bottom-most</span>
<span class="sd">        nodes.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        func : callable</span>
<span class="sd">            Callable accepting :class:`BaseNode` as the first param and</span>
<span class="sd">            optional positional and keyword arguments</span>
<span class="sd">        args :</span>
<span class="sd">            func params</span>
<span class="sd">        kwargs :</span>
<span class="sd">            func keyword params</span>
<span class="sd">        decompose : bool, optional</span>
<span class="sd">            (default: False)</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="n">kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlevel</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">PARTS</span><span class="p">:</span>
                <span class="n">subnode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subnode</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">decompose</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">subnode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">subnode</span><span class="o">.</span><span class="n">walk_depth</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">decompose</span><span class="p">)</span>
        <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">+</span> <span class="s2">": "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-attribute">
<h3 class="doc doc-heading" id="pywt.BaseNode.path_tuple">
<code class="highlight language-python"><span class="n">path_tuple</span></code>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-property"><code>property</code></small>
</span>
</h3>
<div class="doc doc-contents">
<p>The path to the current node in tuple form.</p>
<p>The length of the tuple is equal to the number of decomposition levels.</p>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="pywt.BaseNode.__delitem__">
<code class="highlight language-python"><span class="fm">__delitem__</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>
</h3>
<div class="doc doc-contents">
<p>Remove node from the tree.</p>
<h5 id="pywt.BaseNode.__delitem__--parameters">Parameters</h5>
<p>path : str
    String composed of node names.</p>
<details class="quote">
<summary>Source code in <code>pywt/_wavelet_packets.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Remove node from the tree.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path : str</span>
<span class="sd">        String composed of node names.</span>
<span class="sd">    """</span>
    <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">path</span><span class="p">]</span>
    <span class="c1"># don't clear node value and subnodes (node may still exist outside</span>
    <span class="c1"># the tree)</span>
    <span class="c1"># # node._init_subnodes()</span>
    <span class="c1"># # node.data = None</span>
    <span class="n">parent</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span>
    <span class="n">node</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># TODO</span>
    <span class="k">if</span> <span class="n">parent</span> <span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">node_name</span><span class="p">:</span>
        <span class="n">parent</span><span class="o">.</span><span class="n">_delete_node</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">node_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="pywt.BaseNode.__getitem__">
<code class="highlight language-python"><span class="fm">__getitem__</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>
</h3>
<div class="doc doc-contents">
<p>Find node represented by the given path.</p>
<p>Similar to <code>~BaseNode.get_subnode</code> method with <code>decompose=True</code>, but
can access nodes on any level in the decomposition tree.</p>
<h5 id="pywt.BaseNode.__getitem__--parameters">Parameters</h5>
<p>path : str
    String composed of node names. See <code>Node.node_name</code> and
    <code>Node2D.node_name</code> for node naming convention.</p>
<h5 id="pywt.BaseNode.__getitem__--notes">Notes</h5>
<p>If node does not exist yet, it will be created by decomposition of its
parent node.</p>
<details class="quote">
<summary>Source code in <code>pywt/_wavelet_packets.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Find node represented by the given path.</span>

<span class="sd">    Similar to `~BaseNode.get_subnode` method with `decompose=True`, but</span>
<span class="sd">    can access nodes on any level in the decomposition tree.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path : str</span>
<span class="sd">        String composed of node names. See `Node.node_name` and</span>
<span class="sd">        `Node2D.node_name` for node naming convention.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    If node does not exist yet, it will be created by decomposition of its</span>
<span class="sd">    parent node.</span>
<span class="sd">    """</span>
    <span class="n">errmsg</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"Invalid path parameter type - expected string or "</span>
              <span class="s2">"tuple of strings but got </span><span class="si">%s</span><span class="s2">."</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="c1"># concatenate tuple of strings into a single string</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlevel</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">PART_LEN</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">"Path length is out of range."</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">path</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subnode</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">PART_LEN</span><span class="p">],</span> <span class="kc">True</span><span class="p">)[</span>
                <span class="n">path</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">PART_LEN</span><span class="p">:]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="pywt.BaseNode.__setitem__">
<code class="highlight language-python"><span class="fm">__setitem__</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span></code>
</h3>
<div class="doc doc-contents">
<p>Set node or node's data in the decomposition tree. Nodes are
identified by string <code>path</code>.</p>
<h5 id="pywt.BaseNode.__setitem__--parameters">Parameters</h5>
<p>path : str
    String composed of node names.
data : array or BaseNode subclass.</p>
<details class="quote">
<summary>Source code in <code>pywt/_wavelet_packets.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Set node or node's data in the decomposition tree. Nodes are</span>
<span class="sd">    identified by string `path`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path : str</span>
<span class="sd">        String composed of node names.</span>
<span class="sd">    data : array or BaseNode subclass.</span>
<span class="sd">    """</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">maxlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span>
            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlevel</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">PART_LEN</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">"Path length out of range."</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">path</span><span class="p">:</span>
            <span class="n">subnode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subnode</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">PART_LEN</span><span class="p">],</span> <span class="kc">False</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">subnode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_create_subnode</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">PART_LEN</span><span class="p">],</span> <span class="kc">None</span><span class="p">)</span>
                <span class="n">subnode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subnode</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">PART_LEN</span><span class="p">],</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">subnode</span><span class="p">[</span><span class="n">path</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">PART_LEN</span><span class="p">:]]</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">BaseNode</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="c1"># convert data to nearest supported dtype</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">_check_dtype</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">dtype</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">"Invalid path parameter type - expected string but"</span>
                        <span class="s2">" got </span><span class="si">%s</span><span class="s2">."</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="pywt.BaseNode.decompose">
<code class="highlight language-python"><span class="n">decompose</span><span class="p">()</span></code>
</h3>
<div class="doc doc-contents">
<p>Decompose node data creating DWT coefficients subnodes.</p>
<p>Performs Discrete Wavelet Transform on the <code>~BaseNode.data</code> and
returns transform coefficients.</p>
<h5 id="pywt.BaseNode.decompose--note">Note</h5>
<p>Descends to subnodes and recursively
calls <code>~BaseNode.reconstruct</code> on them.</p>
<details class="quote">
<summary>Source code in <code>pywt/_wavelet_packets.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">decompose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Decompose node data creating DWT coefficients subnodes.</span>

<span class="sd">    Performs Discrete Wavelet Transform on the `~BaseNode.data` and</span>
<span class="sd">    returns transform coefficients.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    Descends to subnodes and recursively</span>
<span class="sd">    calls `~BaseNode.reconstruct` on them.</span>

<span class="sd">    """</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlevel</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decompose</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Maximum decomposition level reached."</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="pywt.BaseNode.get_leaf_nodes">
<code class="highlight language-python"><span class="n">get_leaf_nodes</span><span class="p">(</span><span class="n">decompose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>
</h3>
<div class="doc doc-contents">
<p>Returns leaf nodes.</p>
<h5 id="pywt.BaseNode.get_leaf_nodes--parameters">Parameters</h5>
<p>decompose : bool, optional
    (default: True)</p>
<details class="quote">
<summary>Source code in <code>pywt/_wavelet_packets.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_leaf_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">decompose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Returns leaf nodes.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    decompose : bool, optional</span>
<span class="sd">        (default: True)</span>
<span class="sd">    """</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">collect</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">level</span> <span class="o">==</span> <span class="n">node</span><span class="o">.</span><span class="n">maxlevel</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">node</span><span class="o">.</span><span class="n">is_empty</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">decompose</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">node</span><span class="o">.</span><span class="n">has_any_subnode</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">collect</span><span class="p">,</span> <span class="n">decompose</span><span class="o">=</span><span class="n">decompose</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="pywt.BaseNode.get_subnode">
<code class="highlight language-python"><span class="n">get_subnode</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">decompose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>
</h3>
<div class="doc doc-contents">
<p>Returns subnode or None (see <code>decomposition</code> flag description).</p>
<h5 id="pywt.BaseNode.get_subnode--parameters">Parameters</h5>
<p>part :
    Subnode name
decompose : bool, optional
    If the param is True and corresponding subnode does not
    exist, the subnode will be created using coefficients
    from the DWT decomposition of the current node.
    (default: True)</p>
<details class="quote">
<summary>Source code in <code>pywt/_wavelet_packets.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_subnode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">part</span><span class="p">,</span> <span class="n">decompose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Returns subnode or None (see `decomposition` flag description).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    part :</span>
<span class="sd">        Subnode name</span>
<span class="sd">    decompose : bool, optional</span>
<span class="sd">        If the param is True and corresponding subnode does not</span>
<span class="sd">        exist, the subnode will be created using coefficients</span>
<span class="sd">        from the DWT decomposition of the current node.</span>
<span class="sd">        (default: True)</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_validate_node_name</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>
    <span class="n">subnode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">subnode</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">decompose</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span>
        <span class="n">subnode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">subnode</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="pywt.BaseNode.reconstruct">
<code class="highlight language-python"><span class="n">reconstruct</span><span class="p">(</span><span class="n">update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>
</h3>
<div class="doc doc-contents">
<p>Reconstruct node from subnodes.</p>
<h5 id="pywt.BaseNode.reconstruct--parameters">Parameters</h5>
<p>update : bool, optional
    If True, then reconstructed data replaces the current
    node data (default: False).</p>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
</td>
<td>
<div class="doc-md-description">
<ul>
<li>original node data if subnodes do not exist</li>
</ul>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td>
</td>
<td>
<div class="doc-md-description">
<ul>
<li>IDWT of subnodes otherwise.</li>
</ul>
</div>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>pywt/_wavelet_packets.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reconstruct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Reconstruct node from subnodes.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    update : bool, optional</span>
<span class="sd">        If True, then reconstructed data replaces the current</span>
<span class="sd">        node data (default: False).</span>

<span class="sd">    Returns:</span>
<span class="sd">        - original node data if subnodes do not exist</span>
<span class="sd">        - IDWT of subnodes otherwise.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_any_subnode</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reconstruct</span><span class="p">(</span><span class="n">update</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="pywt.BaseNode.walk">
<code class="highlight language-python"><span class="n">walk</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">decompose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>
</h3>
<div class="doc doc-contents">
<p>Traverses the decomposition tree and calls
<code>func(node, *args, **kwargs)</code> on every node. If <code>func</code> returns True,
descending to subnodes will continue.</p>
<h5 id="pywt.BaseNode.walk--parameters">Parameters</h5>
<p>func : callable
    Callable accepting <code>BaseNode</code> as the first param and
    optional positional and keyword arguments
args :
    func params
kwargs :
    func keyword params
decompose : bool, optional
    If True (default), the method will also try to decompose the tree
    up to the <code>maximum level &lt;BaseNode.maxlevel&gt;</code>.</p>
<details class="quote">
<summary>Source code in <code>pywt/_wavelet_packets.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">decompose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Traverses the decomposition tree and calls</span>
<span class="sd">    ``func(node, *args, **kwargs)`` on every node. If `func` returns True,</span>
<span class="sd">    descending to subnodes will continue.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    func : callable</span>
<span class="sd">        Callable accepting `BaseNode` as the first param and</span>
<span class="sd">        optional positional and keyword arguments</span>
<span class="sd">    args :</span>
<span class="sd">        func params</span>
<span class="sd">    kwargs :</span>
<span class="sd">        func keyword params</span>
<span class="sd">    decompose : bool, optional</span>
<span class="sd">        If True (default), the method will also try to decompose the tree</span>
<span class="sd">        up to the `maximum level &lt;BaseNode.maxlevel&gt;`.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlevel</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">PARTS</span><span class="p">:</span>
            <span class="n">subnode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subnode</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">decompose</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">subnode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">subnode</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">decompose</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="pywt.BaseNode.walk_depth">
<code class="highlight language-python"><span class="n">walk_depth</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">decompose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>
</h3>
<div class="doc doc-contents">
<p>Walk tree and call func on every node starting from the bottom-most
nodes.</p>
<h5 id="pywt.BaseNode.walk_depth--parameters">Parameters</h5>
<p>func : callable
    Callable accepting :class:<code>BaseNode</code> as the first param and
    optional positional and keyword arguments
args :
    func params
kwargs :
    func keyword params
decompose : bool, optional
    (default: False)</p>
<details class="quote">
<summary>Source code in <code>pywt/_wavelet_packets.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">walk_depth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">decompose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Walk tree and call func on every node starting from the bottom-most</span>
<span class="sd">    nodes.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    func : callable</span>
<span class="sd">        Callable accepting :class:`BaseNode` as the first param and</span>
<span class="sd">        optional positional and keyword arguments</span>
<span class="sd">    args :</span>
<span class="sd">        func params</span>
<span class="sd">    kwargs :</span>
<span class="sd">        func keyword params</span>
<span class="sd">    decompose : bool, optional</span>
<span class="sd">        (default: False)</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlevel</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">PARTS</span><span class="p">:</span>
            <span class="n">subnode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subnode</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">decompose</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">subnode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">subnode</span><span class="o">.</span><span class="n">walk_depth</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">decompose</span><span class="p">)</span>
    <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="pywt.FswavedecnResult">
<code>FswavedecnResult</code>
</h2>
<div class="doc doc-contents">
<p>Object representing fully separable wavelet transform coefficients.</p>
<h4 id="pywt.FswavedecnResult--parameters">Parameters</h4>
<p>coeffs : ndarray
    The coefficient array.
coeff_slices : list
    List of slices corresponding to each detail or approximation
    coefficient array.
wavelets : list of pywt.DiscreteWavelet objects
    The wavelets used.  Will be a list with length equal to
    <code>len(axes)</code>.
mode_enums : list of int
    The border modes used.  Will be a list with length equal to
    <code>len(axes)</code>.
axes : tuple of int
    The set of axes over which the transform was performed.</p>
<details class="quote">
<summary>Source code in <code>pywt/_multilevel.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">FswavedecnResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Object representing fully separable wavelet transform coefficients.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    coeffs : ndarray</span>
<span class="sd">        The coefficient array.</span>
<span class="sd">    coeff_slices : list</span>
<span class="sd">        List of slices corresponding to each detail or approximation</span>
<span class="sd">        coefficient array.</span>
<span class="sd">    wavelets : list of pywt.DiscreteWavelet objects</span>
<span class="sd">        The wavelets used.  Will be a list with length equal to</span>
<span class="sd">        ``len(axes)``.</span>
<span class="sd">    mode_enums : list of int</span>
<span class="sd">        The border modes used.  Will be a list with length equal to</span>
<span class="sd">        ``len(axes)``.</span>
<span class="sd">    axes : tuple of int</span>
<span class="sd">        The set of axes over which the transform was performed.</span>

<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span> <span class="n">coeff_slices</span><span class="p">,</span> <span class="n">wavelets</span><span class="p">,</span> <span class="n">mode_enums</span><span class="p">,</span>
                 <span class="n">axes</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_coeffs</span> <span class="o">=</span> <span class="n">coeffs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_coeff_slices</span> <span class="o">=</span> <span class="n">coeff_slices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_axes</span> <span class="o">=</span> <span class="n">axes</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">Wavelet</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">wavelets</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">"wavelets must contain pywt.Wavelet objects"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wavelets</span> <span class="o">=</span> <span class="n">wavelets</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">mode_enums</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">"mode_enums must be integers"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mode_enums</span> <span class="o">=</span> <span class="n">mode_enums</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">coeffs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""ndarray: All coefficients stacked into a single array."""</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coeffs</span>

    <span class="nd">@coeffs</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">coeffs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coeffs</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"new coefficient array must match the existing "</span>
                             <span class="s2">"coefficient shape"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_coeffs</span> <span class="o">=</span> <span class="n">c</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">coeff_slices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""List: List of coefficient slices."""</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coeff_slices</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ndim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""int: Number of data dimensions."""</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span><span class="o">.</span><span class="n">ndim</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ndim_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""int: Number of axes transformed."""</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">axes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""List of str: The axes the transform was performed along."""</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_axes</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">levels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""List of int: Levels of decomposition along each transformed axis."""</span>
        <span class="k">return</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coeff_slices</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">wavelets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""List of pywt.DiscreteWavelet: wavelet for each transformed axis."""</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wavelets</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">wavelet_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""List of pywt.DiscreteWavelet: wavelet for each transformed axis."""</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wavelets</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">modes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""List of str: The border mode used along each transformed axis."""</span>
        <span class="n">names_dict</span> <span class="o">=</span> <span class="p">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">Modes</span><span class="p">,</span> <span class="n">mode</span><span class="p">):</span> <span class="n">mode</span>
                      <span class="k">for</span> <span class="n">mode</span> <span class="ow">in</span> <span class="n">Modes</span><span class="o">.</span><span class="n">modes</span><span class="p">}</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">names_dict</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode_enums</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_get_coef_sl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">levels</span><span class="p">):</span>
        <span class="n">sl</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> <span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">lev</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="n">levels</span><span class="p">)):</span>
            <span class="n">sl</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coeff_slices</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">lev</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">sl</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">approx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""ndarray: The approximation coefficients."""</span>
        <span class="n">sl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_coef_sl</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coeffs</span><span class="p">[</span><span class="n">sl</span><span class="p">]</span>

    <span class="nd">@approx</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">approx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="n">sl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_coef_sl</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coeffs</span><span class="p">[</span><span class="n">sl</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">"x does not match the shape of the requested coefficient"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_coeffs</span><span class="p">[</span><span class="n">sl</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span>

    <span class="k">def</span> <span class="nf">_validate_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">levels</span><span class="p">):</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">"levels must match the number of transformed axes"</span><span class="p">)</span>

        <span class="c1"># check that all elements are non-negative integers</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">lev</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">)</span> <span class="k">for</span> <span class="n">lev</span> <span class="ow">in</span> <span class="n">levels</span><span class="p">])</span> <span class="ow">or</span>
                <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span> <span class="o">%</span> <span class="mi">1</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span>
                <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([</span><span class="n">lev</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">lev</span> <span class="ow">in</span> <span class="n">levels</span><span class="p">])):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Index must be a tuple of non-negative integers"</span><span class="p">)</span>
        <span class="c1"># convert integer-valued floats to int</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">lev</span><span class="p">)</span> <span class="k">for</span> <span class="n">lev</span> <span class="ow">in</span> <span class="n">levels</span><span class="p">])</span>

        <span class="c1"># check for out of range levels</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([</span><span class="n">lev</span> <span class="o">&gt;</span> <span class="n">maxlev</span> <span class="k">for</span> <span class="n">lev</span><span class="p">,</span> <span class="n">maxlev</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">levels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">)]):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">"Specified indices exceed the number of transform levels."</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">levels</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Retrieve a coefficient subband.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        levels : tuple of int</span>
<span class="sd">            The number of degrees of decomposition along each transformed</span>
<span class="sd">            axis.</span>
<span class="sd">        """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_index</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span>
        <span class="n">sl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_coef_sl</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coeffs</span><span class="p">[</span><span class="n">sl</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Assign values to a coefficient subband.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        levels : tuple of int</span>
<span class="sd">            The number of degrees of decomposition along each transformed</span>
<span class="sd">            axis.</span>
<span class="sd">        x : ndarray</span>
<span class="sd">            The data corresponding to assign. It must match the expected</span>
<span class="sd">            shape and dtype of the specified subband.</span>
<span class="sd">        """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_index</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span>
        <span class="n">sl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_coef_sl</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span>
        <span class="n">current_dtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coeffs</span><span class="p">[</span><span class="n">sl</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coeffs</span><span class="p">[</span><span class="n">sl</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">"x does not match the shape of the requested coefficient"</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">current_dtype</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">"dtype mismatch:  converting the provided array to"</span>
                          <span class="sa">f</span><span class="s2">"dtype </span><span class="si">{</span><span class="n">current_dtype</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_coeffs</span><span class="p">[</span><span class="n">sl</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>

    <span class="k">def</span> <span class="nf">detail_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Return a list of all detail coefficient keys.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        keys : list of str</span>
<span class="sd">            List of all detail coefficient keys.</span>
<span class="sd">        """</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">)))</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">remove</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-attribute">
<h3 class="doc doc-heading" id="pywt.FswavedecnResult.approx">
<code class="highlight language-python"><span class="n">approx</span></code>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-property"><code>property</code></small>
<small class="doc doc-label doc-label-writable"><code>writable</code></small>
</span>
</h3>
<div class="doc doc-contents">
<p>ndarray: The approximation coefficients.</p>
</div>
</div>
<div class="doc doc-object doc-attribute">
<h3 class="doc doc-heading" id="pywt.FswavedecnResult.axes">
<code class="highlight language-python"><span class="n">axes</span></code>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-property"><code>property</code></small>
</span>
</h3>
<div class="doc doc-contents">
<p>List of str: The axes the transform was performed along.</p>
</div>
</div>
<div class="doc doc-object doc-attribute">
<h3 class="doc doc-heading" id="pywt.FswavedecnResult.coeff_slices">
<code class="highlight language-python"><span class="n">coeff_slices</span></code>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-property"><code>property</code></small>
</span>
</h3>
<div class="doc doc-contents">
<p>List: List of coefficient slices.</p>
</div>
</div>
<div class="doc doc-object doc-attribute">
<h3 class="doc doc-heading" id="pywt.FswavedecnResult.coeffs">
<code class="highlight language-python"><span class="n">coeffs</span></code>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-property"><code>property</code></small>
<small class="doc doc-label doc-label-writable"><code>writable</code></small>
</span>
</h3>
<div class="doc doc-contents">
<p>ndarray: All coefficients stacked into a single array.</p>
</div>
</div>
<div class="doc doc-object doc-attribute">
<h3 class="doc doc-heading" id="pywt.FswavedecnResult.levels">
<code class="highlight language-python"><span class="n">levels</span></code>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-property"><code>property</code></small>
</span>
</h3>
<div class="doc doc-contents">
<p>List of int: Levels of decomposition along each transformed axis.</p>
</div>
</div>
<div class="doc doc-object doc-attribute">
<h3 class="doc doc-heading" id="pywt.FswavedecnResult.modes">
<code class="highlight language-python"><span class="n">modes</span></code>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-property"><code>property</code></small>
</span>
</h3>
<div class="doc doc-contents">
<p>List of str: The border mode used along each transformed axis.</p>
</div>
</div>
<div class="doc doc-object doc-attribute">
<h3 class="doc doc-heading" id="pywt.FswavedecnResult.ndim">
<code class="highlight language-python"><span class="n">ndim</span></code>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-property"><code>property</code></small>
</span>
</h3>
<div class="doc doc-contents">
<p>int: Number of data dimensions.</p>
</div>
</div>
<div class="doc doc-object doc-attribute">
<h3 class="doc doc-heading" id="pywt.FswavedecnResult.ndim_transform">
<code class="highlight language-python"><span class="n">ndim_transform</span></code>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-property"><code>property</code></small>
</span>
</h3>
<div class="doc doc-contents">
<p>int: Number of axes transformed.</p>
</div>
</div>
<div class="doc doc-object doc-attribute">
<h3 class="doc doc-heading" id="pywt.FswavedecnResult.wavelet_names">
<code class="highlight language-python"><span class="n">wavelet_names</span></code>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-property"><code>property</code></small>
</span>
</h3>
<div class="doc doc-contents">
<p>List of pywt.DiscreteWavelet: wavelet for each transformed axis.</p>
</div>
</div>
<div class="doc doc-object doc-attribute">
<h3 class="doc doc-heading" id="pywt.FswavedecnResult.wavelets">
<code class="highlight language-python"><span class="n">wavelets</span></code>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-property"><code>property</code></small>
</span>
</h3>
<div class="doc doc-contents">
<p>List of pywt.DiscreteWavelet: wavelet for each transformed axis.</p>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="pywt.FswavedecnResult.__getitem__">
<code class="highlight language-python"><span class="fm">__getitem__</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span></code>
</h3>
<div class="doc doc-contents">
<p>Retrieve a coefficient subband.</p>
<h5 id="pywt.FswavedecnResult.__getitem__--parameters">Parameters</h5>
<p>levels : tuple of int
    The number of degrees of decomposition along each transformed
    axis.</p>
<details class="quote">
<summary>Source code in <code>pywt/_multilevel.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">levels</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Retrieve a coefficient subband.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    levels : tuple of int</span>
<span class="sd">        The number of degrees of decomposition along each transformed</span>
<span class="sd">        axis.</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_validate_index</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span>
    <span class="n">sl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_coef_sl</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coeffs</span><span class="p">[</span><span class="n">sl</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="pywt.FswavedecnResult.__setitem__">
<code class="highlight language-python"><span class="fm">__setitem__</span><span class="p">(</span><span class="n">levels</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span></code>
</h3>
<div class="doc doc-contents">
<p>Assign values to a coefficient subband.</p>
<h5 id="pywt.FswavedecnResult.__setitem__--parameters">Parameters</h5>
<p>levels : tuple of int
    The number of degrees of decomposition along each transformed
    axis.
x : ndarray
    The data corresponding to assign. It must match the expected
    shape and dtype of the specified subband.</p>
<details class="quote">
<summary>Source code in <code>pywt/_multilevel.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Assign values to a coefficient subband.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    levels : tuple of int</span>
<span class="sd">        The number of degrees of decomposition along each transformed</span>
<span class="sd">        axis.</span>
<span class="sd">    x : ndarray</span>
<span class="sd">        The data corresponding to assign. It must match the expected</span>
<span class="sd">        shape and dtype of the specified subband.</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_validate_index</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span>
    <span class="n">sl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_coef_sl</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span>
    <span class="n">current_dtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coeffs</span><span class="p">[</span><span class="n">sl</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coeffs</span><span class="p">[</span><span class="n">sl</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">"x does not match the shape of the requested coefficient"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">current_dtype</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">"dtype mismatch:  converting the provided array to"</span>
                      <span class="sa">f</span><span class="s2">"dtype </span><span class="si">{</span><span class="n">current_dtype</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_coeffs</span><span class="p">[</span><span class="n">sl</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="pywt.FswavedecnResult.detail_keys">
<code class="highlight language-python"><span class="n">detail_keys</span><span class="p">()</span></code>
</h3>
<div class="doc doc-contents">
<p>Return a list of all detail coefficient keys.</p>
<h5 id="pywt.FswavedecnResult.detail_keys--returns">Returns</h5>
<p>keys : list of str
    List of all detail coefficient keys.</p>
<details class="quote">
<summary>Source code in <code>pywt/_multilevel.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">detail_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Return a list of all detail coefficient keys.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    keys : list of str</span>
<span class="sd">        List of all detail coefficient keys.</span>
<span class="sd">    """</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">)))</span>
    <span class="n">keys</span><span class="o">.</span><span class="n">remove</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">))</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="pywt.Node">
<code>Node</code>
</h2>
<div class="doc doc-contents">
<p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="pywt._wavelet_packets.BaseNode" href="#pywt.BaseNode">BaseNode</a></code></p>
<p>WaveletPacket tree node.</p>
<p>Subnodes are called <code>a</code> and <code>d</code>, just like approximation
and detail coefficients in the Discrete Wavelet Transform.</p>
<details class="quote">
<summary>Source code in <code>pywt/_wavelet_packets.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Node</span><span class="p">(</span><span class="n">BaseNode</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    WaveletPacket tree node.</span>

<span class="sd">    Subnodes are called `a` and `d`, just like approximation</span>
<span class="sd">    and detail coefficients in the Discrete Wavelet Transform.</span>
<span class="sd">    """</span>

    <span class="n">A</span> <span class="o">=</span> <span class="s1">'a'</span>
    <span class="n">D</span> <span class="o">=</span> <span class="s1">'d'</span>
    <span class="n">PARTS</span> <span class="o">=</span> <span class="n">A</span><span class="p">,</span> <span class="n">D</span>
    <span class="n">PART_LEN</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">_create_subnode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">part</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_subnode_base</span><span class="p">(</span><span class="n">node_cls</span><span class="o">=</span><span class="n">Node</span><span class="p">,</span> <span class="n">part</span><span class="o">=</span><span class="n">part</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                                         <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_decompose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        dwt : for 1D Discrete Wavelet Transform output coefficients.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span><span class="p">:</span>
            <span class="n">data_a</span><span class="p">,</span> <span class="n">data_d</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_create_subnode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="n">data_a</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">D</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_create_subnode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">D</span><span class="p">,</span> <span class="n">data_d</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_a</span><span class="p">,</span> <span class="n">data_d</span> <span class="o">=</span> <span class="n">dwt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelet</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span>
                                 <span class="n">axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_create_subnode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="n">data_a</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_create_subnode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">D</span><span class="p">,</span> <span class="n">data_d</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">D</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_reconstruct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update</span><span class="p">):</span>
        <span class="n">data_a</span><span class="p">,</span> <span class="n">data_d</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
        <span class="n">node_a</span><span class="p">,</span> <span class="n">node_d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">D</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">node_a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data_a</span> <span class="o">=</span> <span class="n">node_a</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">()</span>  <span class="c1"># TODO: (update) ???</span>
        <span class="k">if</span> <span class="n">node_d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data_d</span> <span class="o">=</span> <span class="n">node_d</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">()</span>  <span class="c1"># TODO: (update) ???</span>

        <span class="k">if</span> <span class="n">data_a</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">data_d</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Node is a leaf node and cannot be reconstructed"</span>
                             <span class="s2">" from subnodes."</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rec</span> <span class="o">=</span> <span class="n">idwt</span><span class="p">(</span><span class="n">data_a</span><span class="p">,</span> <span class="n">data_d</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelet</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_shape</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span>
                    <span class="n">rec</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_shape</span><span class="p">):</span>
                <span class="n">rec</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="nb">tuple</span><span class="p">([</span><span class="nb">slice</span><span class="p">(</span><span class="n">sz</span><span class="p">)</span> <span class="k">for</span> <span class="n">sz</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_shape</span><span class="p">])]</span>
            <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">rec</span>
            <span class="k">return</span> <span class="n">rec</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="pywt.Node2D">
<code>Node2D</code>
</h2>
<div class="doc doc-contents">
<p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="pywt._wavelet_packets.BaseNode" href="#pywt.BaseNode">BaseNode</a></code></p>
<p>WaveletPacket tree node.</p>
<p>Subnodes are called 'a' (LL), 'h' (HL), 'v' (LH) and  'd' (HH), like
approximation and detail coefficients in the 2D Discrete Wavelet Transform</p>
<details class="quote">
<summary>Source code in <code>pywt/_wavelet_packets.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Node2D</span><span class="p">(</span><span class="n">BaseNode</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    WaveletPacket tree node.</span>

<span class="sd">    Subnodes are called 'a' (LL), 'h' (HL), 'v' (LH) and  'd' (HH), like</span>
<span class="sd">    approximation and detail coefficients in the 2D Discrete Wavelet Transform</span>
<span class="sd">    """</span>

    <span class="n">LL</span> <span class="o">=</span> <span class="s1">'a'</span>
    <span class="n">HL</span> <span class="o">=</span> <span class="s1">'h'</span>
    <span class="n">LH</span> <span class="o">=</span> <span class="s1">'v'</span>
    <span class="n">HH</span> <span class="o">=</span> <span class="s1">'d'</span>

    <span class="n">PARTS</span> <span class="o">=</span> <span class="n">LL</span><span class="p">,</span> <span class="n">HL</span><span class="p">,</span> <span class="n">LH</span><span class="p">,</span> <span class="n">HH</span>
    <span class="n">PART_LEN</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">_create_subnode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">part</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_subnode_base</span><span class="p">(</span><span class="n">node_cls</span><span class="o">=</span><span class="n">Node2D</span><span class="p">,</span> <span class="n">part</span><span class="o">=</span><span class="n">part</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                                         <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_decompose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        dwt2 : for 2D Discrete Wavelet Transform output coefficients.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span><span class="p">:</span>
            <span class="n">data_ll</span><span class="p">,</span> <span class="n">data_lh</span><span class="p">,</span> <span class="n">data_hl</span><span class="p">,</span> <span class="n">data_hh</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_ll</span><span class="p">,</span> <span class="p">(</span><span class="n">data_hl</span><span class="p">,</span> <span class="n">data_lh</span><span class="p">,</span> <span class="n">data_hh</span><span class="p">)</span> <span class="o">=</span>\
                <span class="n">dwt2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelet</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_create_subnode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LL</span><span class="p">,</span> <span class="n">data_ll</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_create_subnode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LH</span><span class="p">,</span> <span class="n">data_lh</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_create_subnode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">HL</span><span class="p">,</span> <span class="n">data_hl</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_create_subnode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">HH</span><span class="p">,</span> <span class="n">data_hh</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LL</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">HL</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_get_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LH</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">HH</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_reconstruct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update</span><span class="p">):</span>
        <span class="n">data_ll</span><span class="p">,</span> <span class="n">data_lh</span><span class="p">,</span> <span class="n">data_hl</span><span class="p">,</span> <span class="n">data_hh</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

        <span class="n">node_ll</span><span class="p">,</span> <span class="n">node_lh</span><span class="p">,</span> <span class="n">node_hl</span><span class="p">,</span> <span class="n">node_hh</span> <span class="o">=</span>\
            <span class="bp">self</span><span class="o">.</span><span class="n">_get_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LL</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LH</span><span class="p">),</span>\
            <span class="bp">self</span><span class="o">.</span><span class="n">_get_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">HL</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">HH</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">node_ll</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data_ll</span> <span class="o">=</span> <span class="n">node_ll</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">node_lh</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data_lh</span> <span class="o">=</span> <span class="n">node_lh</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">node_hl</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data_hl</span> <span class="o">=</span> <span class="n">node_hl</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">node_hh</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data_hh</span> <span class="o">=</span> <span class="n">node_hh</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">()</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">data_ll</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">data_lh</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span>
                <span class="n">data_hl</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">data_hh</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">"Tree is missing data - all subnodes of `</span><span class="si">%s</span><span class="s2">` node "</span>
                <span class="s2">"are None. Cannot reconstruct node."</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">coeffs</span> <span class="o">=</span> <span class="n">data_ll</span><span class="p">,</span> <span class="p">(</span><span class="n">data_hl</span><span class="p">,</span> <span class="n">data_lh</span><span class="p">,</span> <span class="n">data_hh</span><span class="p">)</span>
            <span class="n">rec</span> <span class="o">=</span> <span class="n">idwt2</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelet</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_shape</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span>
                    <span class="n">rec</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_shape</span><span class="p">):</span>
                <span class="n">rec</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="nb">tuple</span><span class="p">([</span><span class="nb">slice</span><span class="p">(</span><span class="n">sz</span><span class="p">)</span> <span class="k">for</span> <span class="n">sz</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_shape</span><span class="p">])]</span>
            <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">rec</span>
            <span class="k">return</span> <span class="n">rec</span>

    <span class="k">def</span> <span class="nf">expand_2d_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="n">expanded_paths</span> <span class="o">=</span> <span class="p">{</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">HH</span><span class="p">:</span> <span class="s1">'hh'</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">HL</span><span class="p">:</span> <span class="s1">'hl'</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LH</span><span class="p">:</span> <span class="s1">'lh'</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LL</span><span class="p">:</span> <span class="s1">'ll'</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="p">(</span><span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">expanded_paths</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">path</span><span class="p">]),</span>
                <span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">expanded_paths</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">path</span><span class="p">]))</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="pywt.NodeND">
<code>NodeND</code>
</h2>
<div class="doc doc-contents">
<p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="pywt._wavelet_packets.BaseNode" href="#pywt.BaseNode">BaseNode</a></code></p>
<p>WaveletPacket tree node.</p>
<p>Unlike Node and Node2D self.PARTS is a dictionary.
For 1D:  self.PARTS has keys 'a' and 'd'
For 2D:  self.PARTS has keys 'aa', 'ad', 'da', 'dd'
For 3D:  self.PARTS has keys 'aaa', 'aad', 'ada', 'daa', ..., 'ddd'</p>
<h4 id="pywt.NodeND--parameters">Parameters</h4>
<p>parent :
    Parent node. If parent is None then the node is considered detached
    (ie root).
data : 1D or 2D array
    Data associated with the node. 1D or 2D numeric array, depending on the
    transform type.
node_name : string
    A name identifying the coefficients type.
    See <code>Node.node_name</code> and <code>Node2D.node_name</code>
    for information on the accepted subnodes names.
ndim : int
    The number of data dimensions.
ndim_transform : int
    The number of dimensions that are to be transformed.</p>
<details class="quote">
<summary>Source code in <code>pywt/_wavelet_packets.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">NodeND</span><span class="p">(</span><span class="n">BaseNode</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    WaveletPacket tree node.</span>

<span class="sd">    Unlike Node and Node2D self.PARTS is a dictionary.</span>
<span class="sd">    For 1D:  self.PARTS has keys 'a' and 'd'</span>
<span class="sd">    For 2D:  self.PARTS has keys 'aa', 'ad', 'da', 'dd'</span>
<span class="sd">    For 3D:  self.PARTS has keys 'aaa', 'aad', 'ada', 'daa', ..., 'ddd'</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    parent :</span>
<span class="sd">        Parent node. If parent is None then the node is considered detached</span>
<span class="sd">        (ie root).</span>
<span class="sd">    data : 1D or 2D array</span>
<span class="sd">        Data associated with the node. 1D or 2D numeric array, depending on the</span>
<span class="sd">        transform type.</span>
<span class="sd">    node_name : string</span>
<span class="sd">        A name identifying the coefficients type.</span>
<span class="sd">        See `Node.node_name` and `Node2D.node_name`</span>
<span class="sd">        for information on the accepted subnodes names.</span>
<span class="sd">    ndim : int</span>
<span class="sd">        The number of data dimensions.</span>
<span class="sd">    ndim_transform : int</span>
<span class="sd">        The number of dimensions that are to be transformed.</span>

<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">ndim</span><span class="p">,</span> <span class="n">ndim_transform</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                                     <span class="n">node_name</span><span class="o">=</span><span class="n">node_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PART_LEN</span> <span class="o">=</span> <span class="n">ndim_transform</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PARTS</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="p">((</span><span class="s1">'ad'</span><span class="p">,</span> <span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">PART_LEN</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">PARTS</span><span class="p">[</span><span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">=</span> <span class="n">ndim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ndim_transform</span> <span class="o">=</span> <span class="n">ndim_transform</span>

    <span class="k">def</span> <span class="nf">_init_subnodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># need this empty so BaseNode's _init_subnodes isn't called during</span>
        <span class="c1"># __init__.  We use a dictionary for PARTS instead for the nd case.</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">_get_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">part</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">PARTS</span><span class="p">[</span><span class="n">part</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_set_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">part</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">part</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">PARTS</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"invalid part"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PARTS</span><span class="p">[</span><span class="n">part</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span>

    <span class="k">def</span> <span class="nf">_delete_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">part</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_node</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_validate_node_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">part</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">part</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">PARTS</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">"Subnode name must be in [</span><span class="si">{}</span><span class="s2">], not '</span><span class="si">{}</span><span class="s2">'."</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">', '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">"'</span><span class="si">%s</span><span class="s2">'"</span> <span class="o">%</span> <span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PARTS</span><span class="o">.</span><span class="n">keys</span><span class="p">())),</span> <span class="n">part</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_create_subnode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">part</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_subnode_base</span><span class="p">(</span><span class="n">node_cls</span><span class="o">=</span><span class="n">NodeND</span><span class="p">,</span> <span class="n">part</span><span class="o">=</span><span class="n">part</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                                         <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">,</span>
                                         <span class="n">ndim_transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim_transform</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_evaluate_maxlevel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evaluate_from</span><span class="o">=</span><span class="s1">'parent'</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Try to find the value of maximum decomposition level if it is not</span>
<span class="sd">        specified explicitly.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        evaluate_from : {'parent', 'subnodes'}</span>
<span class="sd">        """</span>
        <span class="k">assert</span> <span class="n">evaluate_from</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">'parent'</span><span class="p">,</span> <span class="s1">'subnodes'</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_maxlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_maxlevel</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">+</span> <span class="n">dwt_max_level</span><span class="p">(</span>
                <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelet</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">evaluate_from</span> <span class="o">==</span> <span class="s1">'parent'</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">_evaluate_maxlevel</span><span class="p">(</span><span class="n">evaluate_from</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">evaluate_from</span> <span class="o">==</span> <span class="s1">'subnodes'</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">PARTS</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">level</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">_evaluate_maxlevel</span><span class="p">(</span><span class="n">evaluate_from</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">level</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">level</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_decompose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        dwt2 : for 2D Discrete Wavelet Transform output coefficients.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span><span class="p">:</span>
            <span class="n">coefs</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">PARTS</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">coefs</span> <span class="o">=</span> <span class="n">dwtn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelet</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">coefs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_create_subnode</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_node</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">PARTS</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_reconstruct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update</span><span class="p">):</span>
        <span class="n">coeffs</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">PARTS</span><span class="p">}</span>

        <span class="n">nnodes</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">PARTS</span><span class="p">:</span>
            <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">nnodes</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">coeffs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">nnodes</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">"Tree is missing data - all subnodes of `</span><span class="si">%s</span><span class="s2">` node "</span>
                <span class="s2">"are None. Cannot reconstruct node."</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rec</span> <span class="o">=</span> <span class="n">idwtn</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelet</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">rec</span>
            <span class="k">return</span> <span class="n">rec</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="pywt.WaveletPacket">
<code>WaveletPacket</code>
</h2>
<div class="doc doc-contents">
<p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="pywt._wavelet_packets.Node" href="#pywt.Node">Node</a></code></p>
<p>Data structure representing Wavelet Packet decomposition of signal.</p>
<h4 id="pywt.WaveletPacket--parameters">Parameters</h4>
<p>data : 1D ndarray
    Original data (signal)
wavelet : Wavelet object or name string
    Wavelet used in DWT decomposition and reconstruction
mode : str, optional
    Signal extension mode for the <code>dwt</code> and <code>idwt</code> decomposition and
    reconstruction functions.
maxlevel : int, optional
    Maximum level of decomposition.
    If None, it will be calculated based on the <code>wavelet</code> and <code>data</code>
    length using <code>pywt.dwt_max_level</code>.
axis : int, optional
    The axis to transform.</p>
<details class="quote">
<summary>Source code in <code>pywt/_wavelet_packets.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">WaveletPacket</span><span class="p">(</span><span class="n">Node</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Data structure representing Wavelet Packet decomposition of signal.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : 1D ndarray</span>
<span class="sd">        Original data (signal)</span>
<span class="sd">    wavelet : Wavelet object or name string</span>
<span class="sd">        Wavelet used in DWT decomposition and reconstruction</span>
<span class="sd">    mode : str, optional</span>
<span class="sd">        Signal extension mode for the `dwt` and `idwt` decomposition and</span>
<span class="sd">        reconstruction functions.</span>
<span class="sd">    maxlevel : int, optional</span>
<span class="sd">        Maximum level of decomposition.</span>
<span class="sd">        If None, it will be calculated based on the `wavelet` and `data`</span>
<span class="sd">        length using `pywt.dwt_max_level`.</span>
<span class="sd">    axis : int, optional</span>
<span class="sd">        The axis to transform.</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="n">maxlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="s2">""</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wavelet</span><span class="p">,</span> <span class="n">Wavelet</span><span class="p">):</span>
            <span class="n">wavelet</span> <span class="o">=</span> <span class="n">Wavelet</span><span class="p">(</span><span class="n">wavelet</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wavelet</span> <span class="o">=</span> <span class="n">wavelet</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="n">axis</span>  <span class="c1"># self.axes is just an integer for 1D transforms</span>

        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">+</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">&lt;</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Axis greater than data dimensions"</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_size</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
            <span class="k">if</span> <span class="n">maxlevel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">maxlevel</span> <span class="o">=</span> <span class="n">dwt_max_level</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelet</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_size</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_maxlevel</span> <span class="o">=</span> <span class="n">maxlevel</span>

    <span class="k">def</span> <span class="nf">__reduce__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">WaveletPacket</span><span class="p">,</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelet</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlevel</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">reconstruct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Reconstruct data value using coefficients from subnodes.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        update : bool, optional</span>
<span class="sd">            If True (default), then data values will be replaced by</span>
<span class="sd">            reconstruction values, also in subnodes.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_any_subnode</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">update</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_size</span><span class="p">):</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="nb">slice</span><span class="p">(</span><span class="n">sz</span><span class="p">)</span> <span class="k">for</span> <span class="n">sz</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_size</span><span class="p">]]</span>
            <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
            <span class="k">return</span> <span class="n">data</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>  <span class="c1"># return original data</span>

    <span class="k">def</span> <span class="nf">get_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s2">"natural"</span><span class="p">,</span> <span class="n">decompose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns all nodes on the specified level.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        level : int</span>
<span class="sd">            Specifies decomposition `level` from which the nodes will be</span>
<span class="sd">            collected.</span>
<span class="sd">        order : {'natural', 'freq'}, optional</span>
<span class="sd">            - "natural" - left to right in tree (default)</span>
<span class="sd">            - "freq" - band ordered</span>
<span class="sd">        decompose : bool, optional</span>
<span class="sd">            If set then the method will try to decompose the data up</span>
<span class="sd">            to the specified `level` (default: True).</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        If nodes at the given level are missing (i.e. the tree is partially</span>
<span class="sd">        decomposed) and `decompose` is set to False, only existing nodes</span>
<span class="sd">        will be returned.</span>

<span class="sd">        Frequency order (``order="freq"``) is also known as sequency order</span>
<span class="sd">        and "natural" order is sometimes referred to as Paley order. A detailed</span>
<span class="sd">        discussion of these orderings is also given in [1]_, [2]_.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        ..[1] M.V. Wickerhauser. Adapted Wavelet Analysis from Theory to</span>
<span class="sd">              Software. Wellesley. Massachusetts: A K Peters. 1994.</span>
<span class="sd">        ..[2] D.B. Percival and A.T. Walden.  Wavelet Methods for Time Series</span>
<span class="sd">              Analysis. Cambridge University Press. 2000.</span>
<span class="sd">              DOI:10.1017/CBO9780511841040</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="n">order</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">"natural"</span><span class="p">,</span> <span class="s2">"freq"</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Invalid order: </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">level</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlevel</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"The level cannot be greater than the maximum"</span>
                             <span class="s2">" decomposition level value (</span><span class="si">%d</span><span class="s2">)"</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlevel</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">def</span> <span class="nf">collect</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">level</span> <span class="o">==</span> <span class="n">level</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">collect</span><span class="p">,</span> <span class="n">decompose</span><span class="o">=</span><span class="n">decompose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">order</span> <span class="o">==</span> <span class="s2">"natural"</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">elif</span> <span class="n">order</span> <span class="o">==</span> <span class="s2">"freq"</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">{</span><span class="n">node</span><span class="o">.</span><span class="n">path</span><span class="p">:</span> <span class="n">node</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">result</span><span class="p">}</span>
            <span class="n">graycode_order</span> <span class="o">=</span> <span class="n">get_graycode_order</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="n">path</span><span class="p">]</span> <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">graycode_order</span> <span class="k">if</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">result</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Invalid order name - </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s2">."</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="pywt.WaveletPacket.get_level">
<code class="highlight language-python"><span class="n">get_level</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">'natural'</span><span class="p">,</span> <span class="n">decompose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>
</h3>
<div class="doc doc-contents">
<p>Returns all nodes on the specified level.</p>
<h5 id="pywt.WaveletPacket.get_level--parameters">Parameters</h5>
<p>level : int
    Specifies decomposition <code>level</code> from which the nodes will be
    collected.
order : {'natural', 'freq'}, optional
    - "natural" - left to right in tree (default)
    - "freq" - band ordered
decompose : bool, optional
    If set then the method will try to decompose the data up
    to the specified <code>level</code> (default: True).</p>
<h5 id="pywt.WaveletPacket.get_level--notes">Notes</h5>
<p>If nodes at the given level are missing (i.e. the tree is partially
decomposed) and <code>decompose</code> is set to False, only existing nodes
will be returned.</p>
<p>Frequency order (<code>order="freq"</code>) is also known as sequency order
and "natural" order is sometimes referred to as Paley order. A detailed
discussion of these orderings is also given in [1]<em>, [2]</em>.</p>
<h5 id="pywt.WaveletPacket.get_level--references">References</h5>
<p>..[1] M.V. Wickerhauser. Adapted Wavelet Analysis from Theory to
      Software. Wellesley. Massachusetts: A K Peters. 1994.
..[2] D.B. Percival and A.T. Walden.  Wavelet Methods for Time Series
      Analysis. Cambridge University Press. 2000.
      DOI:10.1017/CBO9780511841040</p>
<details class="quote">
<summary>Source code in <code>pywt/_wavelet_packets.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s2">"natural"</span><span class="p">,</span> <span class="n">decompose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Returns all nodes on the specified level.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    level : int</span>
<span class="sd">        Specifies decomposition `level` from which the nodes will be</span>
<span class="sd">        collected.</span>
<span class="sd">    order : {'natural', 'freq'}, optional</span>
<span class="sd">        - "natural" - left to right in tree (default)</span>
<span class="sd">        - "freq" - band ordered</span>
<span class="sd">    decompose : bool, optional</span>
<span class="sd">        If set then the method will try to decompose the data up</span>
<span class="sd">        to the specified `level` (default: True).</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    If nodes at the given level are missing (i.e. the tree is partially</span>
<span class="sd">    decomposed) and `decompose` is set to False, only existing nodes</span>
<span class="sd">    will be returned.</span>

<span class="sd">    Frequency order (``order="freq"``) is also known as sequency order</span>
<span class="sd">    and "natural" order is sometimes referred to as Paley order. A detailed</span>
<span class="sd">    discussion of these orderings is also given in [1]_, [2]_.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    ..[1] M.V. Wickerhauser. Adapted Wavelet Analysis from Theory to</span>
<span class="sd">          Software. Wellesley. Massachusetts: A K Peters. 1994.</span>
<span class="sd">    ..[2] D.B. Percival and A.T. Walden.  Wavelet Methods for Time Series</span>
<span class="sd">          Analysis. Cambridge University Press. 2000.</span>
<span class="sd">          DOI:10.1017/CBO9780511841040</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">order</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">"natural"</span><span class="p">,</span> <span class="s2">"freq"</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Invalid order: </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">level</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlevel</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"The level cannot be greater than the maximum"</span>
                         <span class="s2">" decomposition level value (</span><span class="si">%d</span><span class="s2">)"</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlevel</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">collect</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">level</span> <span class="o">==</span> <span class="n">level</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">collect</span><span class="p">,</span> <span class="n">decompose</span><span class="o">=</span><span class="n">decompose</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">order</span> <span class="o">==</span> <span class="s2">"natural"</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="k">elif</span> <span class="n">order</span> <span class="o">==</span> <span class="s2">"freq"</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{</span><span class="n">node</span><span class="o">.</span><span class="n">path</span><span class="p">:</span> <span class="n">node</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">result</span><span class="p">}</span>
        <span class="n">graycode_order</span> <span class="o">=</span> <span class="n">get_graycode_order</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="n">path</span><span class="p">]</span> <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">graycode_order</span> <span class="k">if</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">result</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Invalid order name - </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s2">."</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="pywt.WaveletPacket.reconstruct">
<code class="highlight language-python"><span class="n">reconstruct</span><span class="p">(</span><span class="n">update</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>
</h3>
<div class="doc doc-contents">
<p>Reconstruct data value using coefficients from subnodes.</p>
<h5 id="pywt.WaveletPacket.reconstruct--parameters">Parameters</h5>
<p>update : bool, optional
    If True (default), then data values will be replaced by
    reconstruction values, also in subnodes.</p>
<details class="quote">
<summary>Source code in <code>pywt/_wavelet_packets.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reconstruct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Reconstruct data value using coefficients from subnodes.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    update : bool, optional</span>
<span class="sd">        If True (default), then data values will be replaced by</span>
<span class="sd">        reconstruction values, also in subnodes.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_any_subnode</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">update</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_size</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="nb">slice</span><span class="p">(</span><span class="n">sz</span><span class="p">)</span> <span class="k">for</span> <span class="n">sz</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_size</span><span class="p">]]</span>
        <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">return</span> <span class="n">data</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>  <span class="c1"># return original data</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="pywt.WaveletPacket2D">
<code>WaveletPacket2D</code>
</h2>
<div class="doc doc-contents">
<p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="pywt._wavelet_packets.Node2D" href="#pywt.Node2D">Node2D</a></code></p>
<p>Data structure representing 2D Wavelet Packet decomposition of signal.</p>
<h4 id="pywt.WaveletPacket2D--parameters">Parameters</h4>
<p>data : 2D ndarray
    Data associated with the node.
wavelet : Wavelet object or name string
    Wavelet used in DWT decomposition and reconstruction
mode : str, optional
    Signal extension mode for the <code>dwt</code> and <code>idwt</code> decomposition and
    reconstruction functions.
maxlevel : int
    Maximum level of decomposition.
    If None, it will be calculated based on the <code>wavelet</code> and <code>data</code>
    length using <code>pywt.dwt_max_level</code>.
axes : 2-tuple of ints, optional
    The axes that will be transformed.</p>
<details class="quote">
<summary>Source code in <code>pywt/_wavelet_packets.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">WaveletPacket2D</span><span class="p">(</span><span class="n">Node2D</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Data structure representing 2D Wavelet Packet decomposition of signal.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : 2D ndarray</span>
<span class="sd">        Data associated with the node.</span>
<span class="sd">    wavelet : Wavelet object or name string</span>
<span class="sd">        Wavelet used in DWT decomposition and reconstruction</span>
<span class="sd">    mode : str, optional</span>
<span class="sd">        Signal extension mode for the `dwt` and `idwt` decomposition and</span>
<span class="sd">        reconstruction functions.</span>
<span class="sd">    maxlevel : int</span>
<span class="sd">        Maximum level of decomposition.</span>
<span class="sd">        If None, it will be calculated based on the `wavelet` and `data`</span>
<span class="sd">        length using `pywt.dwt_max_level`.</span>
<span class="sd">    axes : 2-tuple of ints, optional</span>
<span class="sd">        The axes that will be transformed.</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'smooth'</span><span class="p">,</span> <span class="n">maxlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="s2">""</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wavelet</span><span class="p">,</span> <span class="n">Wavelet</span><span class="p">):</span>
            <span class="n">wavelet</span> <span class="o">=</span> <span class="n">Wavelet</span><span class="p">(</span><span class="n">wavelet</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wavelet</span> <span class="o">=</span> <span class="n">wavelet</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Expected two unique axes."</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">"WaveletPacket2D requires data with 2 or more dimensions."</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_size</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
            <span class="n">transform_size</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">maxlevel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">maxlevel</span> <span class="o">=</span> <span class="n">dwt_max_level</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">transform_size</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelet</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_size</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_maxlevel</span> <span class="o">=</span> <span class="n">maxlevel</span>

    <span class="k">def</span> <span class="nf">__reduce__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">WaveletPacket2D</span><span class="p">,</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelet</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlevel</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">reconstruct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Reconstruct data using coefficients from subnodes.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        update : bool, optional</span>
<span class="sd">            If True (default) then the coefficients of the current node</span>
<span class="sd">            and its subnodes will be replaced with values from reconstruction.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_any_subnode</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">update</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_size</span><span class="p">):</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="nb">slice</span><span class="p">(</span><span class="n">sz</span><span class="p">)</span> <span class="k">for</span> <span class="n">sz</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_size</span><span class="p">]]</span>
            <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
            <span class="k">return</span> <span class="n">data</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>  <span class="c1"># return original data</span>

    <span class="k">def</span> <span class="nf">get_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s2">"natural"</span><span class="p">,</span> <span class="n">decompose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns all nodes from specified level.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        level : int</span>
<span class="sd">            Decomposition `level` from which the nodes will be</span>
<span class="sd">            collected.</span>
<span class="sd">        order : {'natural', 'freq'}, optional</span>
<span class="sd">            If `natural` (default) a flat list is returned.</span>
<span class="sd">            If `freq`, a 2d structure with rows and cols</span>
<span class="sd">            sorted by corresponding dimension frequency of 2d</span>
<span class="sd">            coefficient array (adapted from 1d case).</span>
<span class="sd">        decompose : bool, optional</span>
<span class="sd">            If set then the method will try to decompose the data up</span>
<span class="sd">            to the specified `level` (default: True).</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Frequency order (``order="freq"``) is also known as as sequency order</span>
<span class="sd">        and "natural" order is sometimes referred to as Paley order. A detailed</span>
<span class="sd">        discussion of these orderings is also given in [1]_, [2]_.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        ..[1] M.V. Wickerhauser. Adapted Wavelet Analysis from Theory to</span>
<span class="sd">              Software. Wellesley. Massachusetts: A K Peters. 1994.</span>
<span class="sd">        ..[2] D.B. Percival and A.T. Walden.  Wavelet Methods for Time Series</span>
<span class="sd">              Analysis. Cambridge University Press. 2000.</span>
<span class="sd">              DOI:10.1017/CBO9780511841040</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="n">order</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">"natural"</span><span class="p">,</span> <span class="s2">"freq"</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Invalid order: </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">level</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlevel</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"The level cannot be greater than the maximum"</span>
                             <span class="s2">" decomposition level value (</span><span class="si">%d</span><span class="s2">)"</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlevel</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">def</span> <span class="nf">collect</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">level</span> <span class="o">==</span> <span class="n">level</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">collect</span><span class="p">,</span> <span class="n">decompose</span><span class="o">=</span><span class="n">decompose</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">order</span> <span class="o">==</span> <span class="s2">"freq"</span><span class="p">:</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">row_path</span><span class="p">,</span> <span class="n">col_path</span><span class="p">),</span> <span class="n">node</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expand_2d_path</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">path</span><span class="p">),</span> <span class="n">node</span><span class="p">)</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">result</span>
            <span class="p">]:</span>
                <span class="n">nodes</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">row_path</span><span class="p">,</span> <span class="p">{})[</span><span class="n">col_path</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span>
            <span class="n">graycode_order</span> <span class="o">=</span> <span class="n">get_graycode_order</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">'l'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'h'</span><span class="p">)</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">nodes</span><span class="p">[</span><span class="n">path</span><span class="p">]</span> <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">graycode_order</span> <span class="k">if</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">]</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="n">path</span><span class="p">]</span> <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">graycode_order</span> <span class="k">if</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span>
                <span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="pywt.WaveletPacket2D.get_level">
<code class="highlight language-python"><span class="n">get_level</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">'natural'</span><span class="p">,</span> <span class="n">decompose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>
</h3>
<div class="doc doc-contents">
<p>Returns all nodes from specified level.</p>
<h5 id="pywt.WaveletPacket2D.get_level--parameters">Parameters</h5>
<p>level : int
    Decomposition <code>level</code> from which the nodes will be
    collected.
order : {'natural', 'freq'}, optional
    If <code>natural</code> (default) a flat list is returned.
    If <code>freq</code>, a 2d structure with rows and cols
    sorted by corresponding dimension frequency of 2d
    coefficient array (adapted from 1d case).
decompose : bool, optional
    If set then the method will try to decompose the data up
    to the specified <code>level</code> (default: True).</p>
<h5 id="pywt.WaveletPacket2D.get_level--notes">Notes</h5>
<p>Frequency order (<code>order="freq"</code>) is also known as as sequency order
and "natural" order is sometimes referred to as Paley order. A detailed
discussion of these orderings is also given in [1]<em>, [2]</em>.</p>
<h5 id="pywt.WaveletPacket2D.get_level--references">References</h5>
<p>..[1] M.V. Wickerhauser. Adapted Wavelet Analysis from Theory to
      Software. Wellesley. Massachusetts: A K Peters. 1994.
..[2] D.B. Percival and A.T. Walden.  Wavelet Methods for Time Series
      Analysis. Cambridge University Press. 2000.
      DOI:10.1017/CBO9780511841040</p>
<details class="quote">
<summary>Source code in <code>pywt/_wavelet_packets.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s2">"natural"</span><span class="p">,</span> <span class="n">decompose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Returns all nodes from specified level.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    level : int</span>
<span class="sd">        Decomposition `level` from which the nodes will be</span>
<span class="sd">        collected.</span>
<span class="sd">    order : {'natural', 'freq'}, optional</span>
<span class="sd">        If `natural` (default) a flat list is returned.</span>
<span class="sd">        If `freq`, a 2d structure with rows and cols</span>
<span class="sd">        sorted by corresponding dimension frequency of 2d</span>
<span class="sd">        coefficient array (adapted from 1d case).</span>
<span class="sd">    decompose : bool, optional</span>
<span class="sd">        If set then the method will try to decompose the data up</span>
<span class="sd">        to the specified `level` (default: True).</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Frequency order (``order="freq"``) is also known as as sequency order</span>
<span class="sd">    and "natural" order is sometimes referred to as Paley order. A detailed</span>
<span class="sd">    discussion of these orderings is also given in [1]_, [2]_.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    ..[1] M.V. Wickerhauser. Adapted Wavelet Analysis from Theory to</span>
<span class="sd">          Software. Wellesley. Massachusetts: A K Peters. 1994.</span>
<span class="sd">    ..[2] D.B. Percival and A.T. Walden.  Wavelet Methods for Time Series</span>
<span class="sd">          Analysis. Cambridge University Press. 2000.</span>
<span class="sd">          DOI:10.1017/CBO9780511841040</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">order</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">"natural"</span><span class="p">,</span> <span class="s2">"freq"</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Invalid order: </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">level</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlevel</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"The level cannot be greater than the maximum"</span>
                         <span class="s2">" decomposition level value (</span><span class="si">%d</span><span class="s2">)"</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlevel</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">collect</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">level</span> <span class="o">==</span> <span class="n">level</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">collect</span><span class="p">,</span> <span class="n">decompose</span><span class="o">=</span><span class="n">decompose</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">order</span> <span class="o">==</span> <span class="s2">"freq"</span><span class="p">:</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">row_path</span><span class="p">,</span> <span class="n">col_path</span><span class="p">),</span> <span class="n">node</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expand_2d_path</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">path</span><span class="p">),</span> <span class="n">node</span><span class="p">)</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">result</span>
        <span class="p">]:</span>
            <span class="n">nodes</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">row_path</span><span class="p">,</span> <span class="p">{})[</span><span class="n">col_path</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span>
        <span class="n">graycode_order</span> <span class="o">=</span> <span class="n">get_graycode_order</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">'l'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'h'</span><span class="p">)</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">nodes</span><span class="p">[</span><span class="n">path</span><span class="p">]</span> <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">graycode_order</span> <span class="k">if</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">]</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="n">path</span><span class="p">]</span> <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">graycode_order</span> <span class="k">if</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="pywt.WaveletPacket2D.reconstruct">
<code class="highlight language-python"><span class="n">reconstruct</span><span class="p">(</span><span class="n">update</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>
</h3>
<div class="doc doc-contents">
<p>Reconstruct data using coefficients from subnodes.</p>
<h5 id="pywt.WaveletPacket2D.reconstruct--parameters">Parameters</h5>
<p>update : bool, optional
    If True (default) then the coefficients of the current node
    and its subnodes will be replaced with values from reconstruction.</p>
<details class="quote">
<summary>Source code in <code>pywt/_wavelet_packets.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reconstruct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Reconstruct data using coefficients from subnodes.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    update : bool, optional</span>
<span class="sd">        If True (default) then the coefficients of the current node</span>
<span class="sd">        and its subnodes will be replaced with values from reconstruction.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_any_subnode</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">update</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_size</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="nb">slice</span><span class="p">(</span><span class="n">sz</span><span class="p">)</span> <span class="k">for</span> <span class="n">sz</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_size</span><span class="p">]]</span>
        <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">return</span> <span class="n">data</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>  <span class="c1"># return original data</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="pywt.WaveletPacketND">
<code>WaveletPacketND</code>
</h2>
<div class="doc doc-contents">
<p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="pywt._wavelet_packets.NodeND" href="#pywt.NodeND">NodeND</a></code></p>
<p>Data structure representing ND Wavelet Packet decomposition of signal.</p>
<h4 id="pywt.WaveletPacketND--parameters">Parameters</h4>
<p>data : ND ndarray
    Data associated with the node.
wavelet : Wavelet object or name string
    Wavelet used in DWT decomposition and reconstruction
mode : str, optional
    Signal extension mode for the <code>dwt</code> and <code>idwt</code> decomposition and
    reconstruction functions.
maxlevel : int, optional
    Maximum level of decomposition.
    If None, it will be calculated based on the <code>wavelet</code> and <code>data</code>
    length using <code>pywt.dwt_max_level</code>.
axes : tuple of int, optional
    The axes to transform.  The default value of <code>None</code> corresponds to all
    axes.</p>
<details class="quote">
<summary>Source code in <code>pywt/_wavelet_packets.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">WaveletPacketND</span><span class="p">(</span><span class="n">NodeND</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Data structure representing ND Wavelet Packet decomposition of signal.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ND ndarray</span>
<span class="sd">        Data associated with the node.</span>
<span class="sd">    wavelet : Wavelet object or name string</span>
<span class="sd">        Wavelet used in DWT decomposition and reconstruction</span>
<span class="sd">    mode : str, optional</span>
<span class="sd">        Signal extension mode for the `dwt` and `idwt` decomposition and</span>
<span class="sd">        reconstruction functions.</span>
<span class="sd">    maxlevel : int, optional</span>
<span class="sd">        Maximum level of decomposition.</span>
<span class="sd">        If None, it will be calculated based on the `wavelet` and `data`</span>
<span class="sd">        length using `pywt.dwt_max_level`.</span>
<span class="sd">    axes : tuple of int, optional</span>
<span class="sd">        The axes to transform.  The default value of `None` corresponds to all</span>
<span class="sd">        axes.</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'smooth'</span><span class="p">,</span> <span class="n">maxlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="c1"># ndim is required to create a NodeND object</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"If data is None, axes must be specified"</span><span class="p">)</span>

        <span class="c1"># axes determines the number of transform dimensions</span>
        <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">axes</span><span class="p">):</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="p">)</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">axes</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Expected a set of unique axes."</span><span class="p">)</span>
        <span class="n">ndim_transform</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"data must be at least 1D"</span><span class="p">)</span>
            <span class="n">ndim</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ndim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="n">ndim</span><span class="p">,</span>
                                              <span class="n">ndim_transform</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wavelet</span><span class="p">,</span> <span class="n">Wavelet</span><span class="p">):</span>
            <span class="n">wavelet</span> <span class="o">=</span> <span class="n">Wavelet</span><span class="p">(</span><span class="n">wavelet</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wavelet</span> <span class="o">=</span> <span class="n">wavelet</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ndim_transform</span> <span class="o">=</span> <span class="n">ndim_transform</span>
        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"The number of axes exceeds the number of "</span>
                                 <span class="s2">"data dimensions."</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_size</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
            <span class="n">transform_size</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">maxlevel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">maxlevel</span> <span class="o">=</span> <span class="n">dwt_max_level</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">transform_size</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelet</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_size</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_maxlevel</span> <span class="o">=</span> <span class="n">maxlevel</span>

    <span class="k">def</span> <span class="nf">reconstruct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Reconstruct data using coefficients from subnodes.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        update : bool, optional</span>
<span class="sd">            If True (default) then the coefficients of the current node</span>
<span class="sd">            and its subnodes will be replaced with values from reconstruction.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_any_subnode</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">update</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_size</span><span class="p">):</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="nb">slice</span><span class="p">(</span><span class="n">sz</span><span class="p">)</span> <span class="k">for</span> <span class="n">sz</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_size</span><span class="p">]]</span>
            <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
            <span class="k">return</span> <span class="n">data</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>  <span class="c1"># return original data</span>

    <span class="k">def</span> <span class="nf">get_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">decompose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns all nodes from specified level.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        level : int</span>
<span class="sd">            Decomposition `level` from which the nodes will be</span>
<span class="sd">            collected.</span>
<span class="sd">        decompose : bool, optional</span>
<span class="sd">            If set then the method will try to decompose the data up</span>
<span class="sd">            to the specified `level` (default: True).</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="n">level</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlevel</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"The level cannot be greater than the maximum"</span>
                             <span class="s2">" decomposition level value (</span><span class="si">%d</span><span class="s2">)"</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlevel</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">def</span> <span class="nf">collect</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">level</span> <span class="o">==</span> <span class="n">level</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">collect</span><span class="p">,</span> <span class="n">decompose</span><span class="o">=</span><span class="n">decompose</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="pywt.WaveletPacketND.get_level">
<code class="highlight language-python"><span class="n">get_level</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">decompose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>
</h3>
<div class="doc doc-contents">
<p>Returns all nodes from specified level.</p>
<h5 id="pywt.WaveletPacketND.get_level--parameters">Parameters</h5>
<p>level : int
    Decomposition <code>level</code> from which the nodes will be
    collected.
decompose : bool, optional
    If set then the method will try to decompose the data up
    to the specified <code>level</code> (default: True).</p>
<details class="quote">
<summary>Source code in <code>pywt/_wavelet_packets.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">decompose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Returns all nodes from specified level.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    level : int</span>
<span class="sd">        Decomposition `level` from which the nodes will be</span>
<span class="sd">        collected.</span>
<span class="sd">    decompose : bool, optional</span>
<span class="sd">        If set then the method will try to decompose the data up</span>
<span class="sd">        to the specified `level` (default: True).</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">level</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlevel</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"The level cannot be greater than the maximum"</span>
                         <span class="s2">" decomposition level value (</span><span class="si">%d</span><span class="s2">)"</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlevel</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">collect</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">level</span> <span class="o">==</span> <span class="n">level</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">collect</span><span class="p">,</span> <span class="n">decompose</span><span class="o">=</span><span class="n">decompose</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="pywt.WaveletPacketND.reconstruct">
<code class="highlight language-python"><span class="n">reconstruct</span><span class="p">(</span><span class="n">update</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>
</h3>
<div class="doc doc-contents">
<p>Reconstruct data using coefficients from subnodes.</p>
<h5 id="pywt.WaveletPacketND.reconstruct--parameters">Parameters</h5>
<p>update : bool, optional
    If True (default) then the coefficients of the current node
    and its subnodes will be replaced with values from reconstruction.</p>
<details class="quote">
<summary>Source code in <code>pywt/_wavelet_packets.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reconstruct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Reconstruct data using coefficients from subnodes.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    update : bool, optional</span>
<span class="sd">        If True (default) then the coefficients of the current node</span>
<span class="sd">        and its subnodes will be replaced with values from reconstruction.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_any_subnode</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">update</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_size</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="nb">slice</span><span class="p">(</span><span class="n">sz</span><span class="p">)</span> <span class="k">for</span> <span class="n">sz</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_size</span><span class="p">]]</span>
        <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">return</span> <span class="n">data</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>  <span class="c1"># return original data</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.array_to_coeffs">
<code class="highlight language-python"><span class="n">array_to_coeffs</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">coeff_slices</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="s1">'wavedecn'</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Convert a combined array of coefficients back to a list compatible with
<code>waverecn</code>.</p>
<h4 id="pywt.array_to_coeffs--parameters">Parameters</h4>
<details class="arr-" open="">
<summary>array-like</summary>
<p>An array containing all wavelet coefficients.  This should have been
generated via <code>coeffs_to_array</code>.</p>
</details> <p>coeff_slices : list of tuples
    List of slices corresponding to each coefficient as obtained from
    <code>array_to_coeffs</code>.
output_format : {'wavedec', 'wavedec2', 'wavedecn'}
    Make the form of the coefficients compatible with this type of
    multilevel transform.</p>
<h4 id="pywt.array_to_coeffs--returns">Returns</h4>
<p>coeffs: array-like
    Wavelet transform coefficient array.</p>
<h4 id="pywt.array_to_coeffs--see-also">See Also</h4>
<p>coeffs_to_array : the inverse of array_to_coeffs</p>
<h4 id="pywt.array_to_coeffs--notes">Notes</h4>
<p>A single large array containing all coefficients will have subsets stored,
into a <code>waverecn</code> list, c, as indicated below::</p>
<div class="highlight"><pre><span></span><code>+---------------+---------------+-------------------------------+
|               |               |                               |
|     c[0]      |  c[1]['da']   |                               |
|               |               |                               |
+---------------+---------------+           c[2]['da']          |
|               |               |                               |
| c[1]['ad']    |  c[1]['dd']   |                               |
|               |               |                               |
+---------------+---------------+ ------------------------------+
|                               |                               |
|                               |                               |
|                               |                               |
|          c[2]['ad']           |           c[2]['dd']          |
|                               |                               |
|                               |                               |
|                               |                               |
+-------------------------------+-------------------------------+
</code></pre></div>
<h4 id="pywt.array_to_coeffs--examples">Examples</h4>
<blockquote>
<blockquote>
<blockquote>
<p>import pywt
from numpy.testing import assert_array_almost_equal
cam = pywt.data.camera()
coeffs = pywt.wavedecn(cam, wavelet='db2', level=3)
arr, coeff_slices = pywt.coeffs_to_array(coeffs)
coeffs_from_arr = pywt.array_to_coeffs(arr, coeff_slices,
...                                        output_format='wavedecn')
cam_recon = pywt.waverecn(coeffs_from_arr, wavelet='db2')
assert_array_almost_equal(cam, cam_recon)</p>
</blockquote>
</blockquote>
</blockquote>
<details class="quote">
<summary>Source code in <code>pywt/_multilevel.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">array_to_coeffs</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">coeff_slices</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="s1">'wavedecn'</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Convert a combined array of coefficients back to a list compatible with</span>
<span class="sd">    ``waverecn``.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    arr : array-like</span>
<span class="sd">        An array containing all wavelet coefficients.  This should have been</span>
<span class="sd">        generated via ``coeffs_to_array``.</span>
<span class="sd">    coeff_slices : list of tuples</span>
<span class="sd">        List of slices corresponding to each coefficient as obtained from</span>
<span class="sd">        ``array_to_coeffs``.</span>
<span class="sd">    output_format : {'wavedec', 'wavedec2', 'wavedecn'}</span>
<span class="sd">        Make the form of the coefficients compatible with this type of</span>
<span class="sd">        multilevel transform.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    coeffs: array-like</span>
<span class="sd">        Wavelet transform coefficient array.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    coeffs_to_array : the inverse of array_to_coeffs</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    A single large array containing all coefficients will have subsets stored,</span>
<span class="sd">    into a ``waverecn`` list, c, as indicated below::</span>

<span class="sd">        +---------------+---------------+-------------------------------+</span>
<span class="sd">        |               |               |                               |</span>
<span class="sd">        |     c[0]      |  c[1]['da']   |                               |</span>
<span class="sd">        |               |               |                               |</span>
<span class="sd">        +---------------+---------------+           c[2]['da']          |</span>
<span class="sd">        |               |               |                               |</span>
<span class="sd">        | c[1]['ad']    |  c[1]['dd']   |                               |</span>
<span class="sd">        |               |               |                               |</span>
<span class="sd">        +---------------+---------------+ ------------------------------+</span>
<span class="sd">        |                               |                               |</span>
<span class="sd">        |                               |                               |</span>
<span class="sd">        |                               |                               |</span>
<span class="sd">        |          c[2]['ad']           |           c[2]['dd']          |</span>
<span class="sd">        |                               |                               |</span>
<span class="sd">        |                               |                               |</span>
<span class="sd">        |                               |                               |</span>
<span class="sd">        +-------------------------------+-------------------------------+</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import pywt</span>
<span class="sd">    &gt;&gt;&gt; from numpy.testing import assert_array_almost_equal</span>
<span class="sd">    &gt;&gt;&gt; cam = pywt.data.camera()</span>
<span class="sd">    &gt;&gt;&gt; coeffs = pywt.wavedecn(cam, wavelet='db2', level=3)</span>
<span class="sd">    &gt;&gt;&gt; arr, coeff_slices = pywt.coeffs_to_array(coeffs)</span>
<span class="sd">    &gt;&gt;&gt; coeffs_from_arr = pywt.array_to_coeffs(arr, coeff_slices,</span>
<span class="sd">    ...                                        output_format='wavedecn')</span>
<span class="sd">    &gt;&gt;&gt; cam_recon = pywt.waverecn(coeffs_from_arr, wavelet='db2')</span>
<span class="sd">    &gt;&gt;&gt; assert_array_almost_equal(cam, cam_recon)</span>

<span class="sd">    """</span>
    <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
    <span class="n">coeffs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">coeff_slices</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"empty list of coefficient slices"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">coeffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">coeff_slices</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>

    <span class="c1"># difference coefficients at each level</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">coeff_slices</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">output_format</span> <span class="o">==</span> <span class="s1">'wavedec'</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">coeff_slices</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">'d'</span><span class="p">]]</span>
        <span class="k">elif</span> <span class="n">output_format</span> <span class="o">==</span> <span class="s1">'wavedec2'</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">coeff_slices</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">'da'</span><span class="p">]],</span>
                 <span class="n">arr</span><span class="p">[</span><span class="n">coeff_slices</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">'ad'</span><span class="p">]],</span>
                 <span class="n">arr</span><span class="p">[</span><span class="n">coeff_slices</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">'dd'</span><span class="p">]])</span>
        <span class="k">elif</span> <span class="n">output_format</span> <span class="o">==</span> <span class="s1">'wavedecn'</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">coeff_slices</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">"Unrecognized output format: </span><span class="si">{</span><span class="n">output_format</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">coeffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">coeffs</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.central_frequency">
<code class="highlight language-python"><span class="n">central_frequency</span><span class="p">(</span><span class="n">wavelet</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Computes the central frequency of the <code>psi</code> wavelet function.</p>
<h4 id="pywt.central_frequency--parameters">Parameters</h4>
<p>wavelet : Wavelet instance, str or tuple
    Wavelet to integrate.  If a string, should be the name of a wavelet.
precision : int, optional
    Precision that will be used for wavelet function
    approximation computed with the wavefun(level=precision)
    Wavelet's method (default: 8).</p>
<h4 id="pywt.central_frequency--returns">Returns</h4>
<p>scalar</p>
<details class="quote">
<summary>Source code in <code>pywt/_functions.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">central_frequency</span><span class="p">(</span><span class="n">wavelet</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Computes the central frequency of the `psi` wavelet function.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavelet : Wavelet instance, str or tuple</span>
<span class="sd">        Wavelet to integrate.  If a string, should be the name of a wavelet.</span>
<span class="sd">    precision : int, optional</span>
<span class="sd">        Precision that will be used for wavelet function</span>
<span class="sd">        approximation computed with the wavefun(level=precision)</span>
<span class="sd">        Wavelet's method (default: 8).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    scalar</span>

<span class="sd">    """</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wavelet</span><span class="p">,</span> <span class="p">(</span><span class="n">Wavelet</span><span class="p">,</span> <span class="n">ContinuousWavelet</span><span class="p">)):</span>
        <span class="n">wavelet</span> <span class="o">=</span> <span class="n">DiscreteContinuousWavelet</span><span class="p">(</span><span class="n">wavelet</span><span class="p">)</span>

    <span class="n">functions_approximations</span> <span class="o">=</span> <span class="n">wavelet</span><span class="o">.</span><span class="n">wavefun</span><span class="p">(</span><span class="n">precision</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">functions_approximations</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">psi</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">functions_approximations</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># (psi, x)   for (phi, psi, x)</span>
        <span class="c1"># (psi_d, x) for (phi_d, psi_d, phi_r, psi_r, x)</span>
        <span class="n">psi</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">functions_approximations</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">functions_approximations</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">domain</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">assert</span> <span class="n">domain</span> <span class="o">&gt;</span> <span class="mi">0</span>

    <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">fft</span><span class="p">(</span><span class="n">psi</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]))</span> <span class="o">+</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span> <span class="o">-</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">2</span>

    <span class="k">return</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">domain</span> <span class="o">/</span> <span class="p">(</span><span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.coeffs_to_array">
<code class="highlight language-python"><span class="n">coeffs_to_array</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Arrange a wavelet coefficient list from <code>wavedecn</code> into a single array.</p>
<h4 id="pywt.coeffs_to_array--parameters">Parameters</h4>
<details class="coeffs-" open="">
<summary>array-like</summary>
<p>Dictionary of wavelet coefficients as returned by pywt.wavedecn</p>
</details> <p>padding : float or None, optional
    The value to use for the background if the coefficients cannot be
    tightly packed. If None, raise an error if the coefficients cannot be
    tightly packed.
axes : sequence of ints, optional
    Axes over which the DWT that created <code>coeffs</code> was performed.  The
    default value of None corresponds to all axes.</p>
<h4 id="pywt.coeffs_to_array--returns">Returns</h4>
<p>coeff_arr : array-like
    Wavelet transform coefficient array.
coeff_slices : list
    List of slices corresponding to each coefficient.  As a 2D example,
    <code>coeff_arr[coeff_slices[1]['dd']]</code> would extract the first level
    detail coefficients from <code>coeff_arr</code>.</p>
<h4 id="pywt.coeffs_to_array--see-also">See Also</h4>
<p>array_to_coeffs : the inverse of coeffs_to_array</p>
<h4 id="pywt.coeffs_to_array--notes">Notes</h4>
<p>Assume a 2D coefficient dictionary, c, from a two-level transform.</p>
<p>Then all 2D coefficients will be stacked into a single larger 2D array
as follows::</p>
<div class="highlight"><pre><span></span><code>+---------------+---------------+-------------------------------+
|               |               |                               |
|     c[0]      |  c[1]['da']   |                               |
|               |               |                               |
+---------------+---------------+           c[2]['da']          |
|               |               |                               |
| c[1]['ad']    |  c[1]['dd']   |                               |
|               |               |                               |
+---------------+---------------+ ------------------------------+
|                               |                               |
|                               |                               |
|                               |                               |
|          c[2]['ad']           |           c[2]['dd']          |
|                               |                               |
|                               |                               |
|                               |                               |
+-------------------------------+-------------------------------+
</code></pre></div>
<p>If the transform was not performed with mode "periodization" or the signal
length was not a multiple of <code>2**level</code>, coefficients at each subsequent
scale will not be exactly 1/2 the size of those at the previous level due
to additional coefficients retained to handle the boundary condition. In
these cases, the default setting of <code>padding=0</code> indicates to pad the
individual coefficient arrays with 0 as needed so that they can be stacked
into a single, contiguous array.</p>
<h4 id="pywt.coeffs_to_array--examples">Examples</h4>
<blockquote>
<blockquote>
<blockquote>
<p>import pywt
cam = pywt.data.camera()
coeffs = pywt.wavedecn(cam, wavelet='db2', level=3)
arr, coeff_slices = pywt.coeffs_to_array(coeffs)</p>
</blockquote>
</blockquote>
</blockquote>
<details class="quote">
<summary>Source code in <code>pywt/_multilevel.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">coeffs_to_array</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Arrange a wavelet coefficient list from ``wavedecn`` into a single array.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    coeffs : array-like</span>
<span class="sd">        Dictionary of wavelet coefficients as returned by pywt.wavedecn</span>
<span class="sd">    padding : float or None, optional</span>
<span class="sd">        The value to use for the background if the coefficients cannot be</span>
<span class="sd">        tightly packed. If None, raise an error if the coefficients cannot be</span>
<span class="sd">        tightly packed.</span>
<span class="sd">    axes : sequence of ints, optional</span>
<span class="sd">        Axes over which the DWT that created ``coeffs`` was performed.  The</span>
<span class="sd">        default value of None corresponds to all axes.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    coeff_arr : array-like</span>
<span class="sd">        Wavelet transform coefficient array.</span>
<span class="sd">    coeff_slices : list</span>
<span class="sd">        List of slices corresponding to each coefficient.  As a 2D example,</span>
<span class="sd">        ``coeff_arr[coeff_slices[1]['dd']]`` would extract the first level</span>
<span class="sd">        detail coefficients from ``coeff_arr``.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    array_to_coeffs : the inverse of coeffs_to_array</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Assume a 2D coefficient dictionary, c, from a two-level transform.</span>

<span class="sd">    Then all 2D coefficients will be stacked into a single larger 2D array</span>
<span class="sd">    as follows::</span>

<span class="sd">        +---------------+---------------+-------------------------------+</span>
<span class="sd">        |               |               |                               |</span>
<span class="sd">        |     c[0]      |  c[1]['da']   |                               |</span>
<span class="sd">        |               |               |                               |</span>
<span class="sd">        +---------------+---------------+           c[2]['da']          |</span>
<span class="sd">        |               |               |                               |</span>
<span class="sd">        | c[1]['ad']    |  c[1]['dd']   |                               |</span>
<span class="sd">        |               |               |                               |</span>
<span class="sd">        +---------------+---------------+ ------------------------------+</span>
<span class="sd">        |                               |                               |</span>
<span class="sd">        |                               |                               |</span>
<span class="sd">        |                               |                               |</span>
<span class="sd">        |          c[2]['ad']           |           c[2]['dd']          |</span>
<span class="sd">        |                               |                               |</span>
<span class="sd">        |                               |                               |</span>
<span class="sd">        |                               |                               |</span>
<span class="sd">        +-------------------------------+-------------------------------+</span>

<span class="sd">    If the transform was not performed with mode "periodization" or the signal</span>
<span class="sd">    length was not a multiple of ``2**level``, coefficients at each subsequent</span>
<span class="sd">    scale will not be exactly 1/2 the size of those at the previous level due</span>
<span class="sd">    to additional coefficients retained to handle the boundary condition. In</span>
<span class="sd">    these cases, the default setting of `padding=0` indicates to pad the</span>
<span class="sd">    individual coefficient arrays with 0 as needed so that they can be stacked</span>
<span class="sd">    into a single, contiguous array.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import pywt</span>
<span class="sd">    &gt;&gt;&gt; cam = pywt.data.camera()</span>
<span class="sd">    &gt;&gt;&gt; coeffs = pywt.wavedecn(cam, wavelet='db2', level=3)</span>
<span class="sd">    &gt;&gt;&gt; arr, coeff_slices = pywt.coeffs_to_array(coeffs)</span>

<span class="sd">    """</span>

    <span class="n">coeffs</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">ndim</span><span class="p">,</span> <span class="n">ndim_transform</span> <span class="o">=</span> <span class="n">_prepare_coeffs_axes</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>

    <span class="c1"># initialize with the approximation coefficients.</span>
    <span class="n">a_coeffs</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">a_shape</span> <span class="o">=</span> <span class="n">a_coeffs</span><span class="o">.</span><span class="n">shape</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># only a single approximation coefficient array was found</span>
        <span class="k">return</span> <span class="n">a_coeffs</span><span class="p">,</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">([</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)]</span> <span class="o">*</span> <span class="n">ndim</span><span class="p">)]</span>

    <span class="c1"># determine size of output and if tight packing is possible</span>
    <span class="n">arr_shape</span><span class="p">,</span> <span class="n">is_tight_packing</span> <span class="o">=</span> <span class="n">_determine_coeff_array_shape</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>

    <span class="c1"># preallocate output array</span>
    <span class="k">if</span> <span class="n">padding</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_tight_packing</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"array coefficients cannot be tightly packed"</span><span class="p">)</span>
        <span class="n">coeff_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">arr_shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">a_coeffs</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">coeff_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">arr_shape</span><span class="p">,</span> <span class="n">padding</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">a_coeffs</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

    <span class="n">a_slices</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="nb">slice</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">a_shape</span><span class="p">])</span>
    <span class="n">coeff_arr</span><span class="p">[</span><span class="n">a_slices</span><span class="p">]</span> <span class="o">=</span> <span class="n">a_coeffs</span>

    <span class="c1"># initialize list of coefficient slices</span>
    <span class="n">coeff_slices</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">coeff_slices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a_slices</span><span class="p">)</span>

    <span class="c1"># loop over the detail coefficients, adding them to coeff_arr</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">for</span> <span class="n">coeff_dict</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">:</span>
        <span class="n">coeff_slices</span><span class="o">.</span><span class="n">append</span><span class="p">({})</span>  <span class="c1"># new dictionary for detail coefficients</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([</span><span class="n">d</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">coeff_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()]):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"coeffs_to_array does not support missing "</span>
                             <span class="s2">"coefficients."</span><span class="p">)</span>
        <span class="n">d_shape</span> <span class="o">=</span> <span class="n">coeff_dict</span><span class="p">[</span><span class="s1">'d'</span> <span class="o">*</span> <span class="n">ndim_transform</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">coeff_dict</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">coeff_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="n">slice_array</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> <span class="p">]</span> <span class="o">*</span> <span class="n">ndim</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">let</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
                <span class="n">ax_i</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="c1"># axis corresponding to this transform index</span>
                <span class="k">if</span> <span class="n">let</span> <span class="o">==</span> <span class="s1">'a'</span><span class="p">:</span>
                    <span class="n">slice_array</span><span class="p">[</span><span class="n">ax_i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">ax_i</span><span class="p">])</span>
                <span class="k">elif</span> <span class="n">let</span> <span class="o">==</span> <span class="s1">'d'</span><span class="p">:</span>
                    <span class="n">slice_array</span><span class="p">[</span><span class="n">ax_i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">a_shape</span><span class="p">[</span><span class="n">ax_i</span><span class="p">],</span>
                                              <span class="n">a_shape</span><span class="p">[</span><span class="n">ax_i</span><span class="p">]</span> <span class="o">+</span> <span class="n">d</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">ax_i</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"unexpected letter: </span><span class="si">{</span><span class="n">let</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
            <span class="n">slice_array</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">slice_array</span><span class="p">)</span>
            <span class="n">coeff_arr</span><span class="p">[</span><span class="n">slice_array</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span>
            <span class="n">coeff_slices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">slice_array</span>
        <span class="n">a_shape</span> <span class="o">=</span> <span class="p">[</span><span class="n">a_shape</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">d_shape</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndim</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">coeff_arr</span><span class="p">,</span> <span class="n">coeff_slices</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.cwt">
<code class="highlight language-python"><span class="n">cwt</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">scales</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">sampling_period</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">'conv'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>cwt(data, scales, wavelet)</p>
<p>One dimensional Continuous Wavelet Transform.</p>
<h4 id="pywt.cwt--parameters">Parameters</h4>
<p>data : array_like
    Input signal
scales : array_like
    The wavelet scales to use. One can use
    <code>f = scale2frequency(wavelet, scale)/sampling_period</code> to determine
    what physical frequency, <code>f</code>. Here, <code>f</code> is in hertz when the
    <code>sampling_period</code> is given in seconds.
wavelet : Wavelet object or name
    Wavelet to use
sampling_period : float
    Sampling period for the frequencies output (optional).
    The values computed for <code>coefs</code> are independent of the choice of
    <code>sampling_period</code> (i.e. <code>scales</code> is not scaled by the sampling
    period).
method : {'conv', 'fft'}, optional
    The method used to compute the CWT. Can be any of:
        - <code>conv</code> uses <code>numpy.convolve</code>.
        - <code>fft</code> uses frequency domain convolution.
        - <code>auto</code> uses automatic selection based on an estimate of the
          computational complexity at each scale.</p>
<div class="highlight"><pre><span></span><code>The ``conv`` method complexity is ``O(len(scale) * len(data))``.
The ``fft`` method is ``O(N * log2(N))`` with
``N = len(scale) + len(data) - 1``. It is well suited for large size
signals but slightly slower than ``conv`` on small ones.
</code></pre></div>
<p>axis: int, optional
    Axis over which to compute the CWT. If not given, the last axis is
    used.</p>
<h4 id="pywt.cwt--returns">Returns</h4>
<p>coefs : array_like
    Continuous wavelet transform of the input signal for the given scales
    and wavelet. The first axis of <code>coefs</code> corresponds to the scales.
    The remaining axes match the shape of <code>data</code>.
frequencies : array_like
    If the unit of sampling period are seconds and given, then frequencies
    are in hertz. Otherwise, a sampling period of 1 is assumed.</p>
<h4 id="pywt.cwt--notes">Notes</h4>
<p>Size of coefficients arrays depends on the length of the input array and
the length of given scales.</p>
<h4 id="pywt.cwt--examples">Examples</h4>
<blockquote>
<blockquote>
<blockquote>
<p>import pywt
import numpy as np
import matplotlib.pyplot as plt
x = np.arange(512)
y = np.sin(2<em>np.pi</em>x/32)
coef, freqs=pywt.cwt(y,np.arange(1,129),'gaus1')
plt.matshow(coef)
plt.show()</p>
<p>import pywt
import numpy as np
import matplotlib.pyplot as plt
t = np.linspace(-1, 1, 200, endpoint=False)
sig  = np.cos(2 * np.pi * 7 * t) + np.real(np.exp(-7<em>(t-0.4)</em><em>2)</em>np.exp(1j<em>2</em>np.pi<em>2</em>(t-0.4)))
widths = np.arange(1, 31)
cwtmatr, freqs = pywt.cwt(sig, widths, 'mexh')
plt.imshow(cwtmatr, extent=[-1, 1, 1, 31], cmap='PRGn', aspect='auto',
...            vmax=abs(cwtmatr).max(), vmin=-abs(cwtmatr).max())
plt.show()</p>
</blockquote>
</blockquote>
</blockquote>
<details class="quote">
<summary>Source code in <code>pywt/_cwt.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">cwt</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">scales</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">sampling_period</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">'conv'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    cwt(data, scales, wavelet)</span>

<span class="sd">    One dimensional Continuous Wavelet Transform.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : array_like</span>
<span class="sd">        Input signal</span>
<span class="sd">    scales : array_like</span>
<span class="sd">        The wavelet scales to use. One can use</span>
<span class="sd">        ``f = scale2frequency(wavelet, scale)/sampling_period`` to determine</span>
<span class="sd">        what physical frequency, ``f``. Here, ``f`` is in hertz when the</span>
<span class="sd">        ``sampling_period`` is given in seconds.</span>
<span class="sd">    wavelet : Wavelet object or name</span>
<span class="sd">        Wavelet to use</span>
<span class="sd">    sampling_period : float</span>
<span class="sd">        Sampling period for the frequencies output (optional).</span>
<span class="sd">        The values computed for ``coefs`` are independent of the choice of</span>
<span class="sd">        ``sampling_period`` (i.e. ``scales`` is not scaled by the sampling</span>
<span class="sd">        period).</span>
<span class="sd">    method : {'conv', 'fft'}, optional</span>
<span class="sd">        The method used to compute the CWT. Can be any of:</span>
<span class="sd">            - ``conv`` uses ``numpy.convolve``.</span>
<span class="sd">            - ``fft`` uses frequency domain convolution.</span>
<span class="sd">            - ``auto`` uses automatic selection based on an estimate of the</span>
<span class="sd">              computational complexity at each scale.</span>

<span class="sd">        The ``conv`` method complexity is ``O(len(scale) * len(data))``.</span>
<span class="sd">        The ``fft`` method is ``O(N * log2(N))`` with</span>
<span class="sd">        ``N = len(scale) + len(data) - 1``. It is well suited for large size</span>
<span class="sd">        signals but slightly slower than ``conv`` on small ones.</span>
<span class="sd">    axis: int, optional</span>
<span class="sd">        Axis over which to compute the CWT. If not given, the last axis is</span>
<span class="sd">        used.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    coefs : array_like</span>
<span class="sd">        Continuous wavelet transform of the input signal for the given scales</span>
<span class="sd">        and wavelet. The first axis of ``coefs`` corresponds to the scales.</span>
<span class="sd">        The remaining axes match the shape of ``data``.</span>
<span class="sd">    frequencies : array_like</span>
<span class="sd">        If the unit of sampling period are seconds and given, then frequencies</span>
<span class="sd">        are in hertz. Otherwise, a sampling period of 1 is assumed.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Size of coefficients arrays depends on the length of the input array and</span>
<span class="sd">    the length of given scales.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import pywt</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">    &gt;&gt;&gt; x = np.arange(512)</span>
<span class="sd">    &gt;&gt;&gt; y = np.sin(2*np.pi*x/32)</span>
<span class="sd">    &gt;&gt;&gt; coef, freqs=pywt.cwt(y,np.arange(1,129),'gaus1')</span>
<span class="sd">    &gt;&gt;&gt; plt.matshow(coef)</span>
<span class="sd">    &gt;&gt;&gt; plt.show()</span>

<span class="sd">    &gt;&gt;&gt; import pywt</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">    &gt;&gt;&gt; t = np.linspace(-1, 1, 200, endpoint=False)</span>
<span class="sd">    &gt;&gt;&gt; sig  = np.cos(2 * np.pi * 7 * t) + np.real(np.exp(-7*(t-0.4)**2)*np.exp(1j*2*np.pi*2*(t-0.4)))</span>
<span class="sd">    &gt;&gt;&gt; widths = np.arange(1, 31)</span>
<span class="sd">    &gt;&gt;&gt; cwtmatr, freqs = pywt.cwt(sig, widths, 'mexh')</span>
<span class="sd">    &gt;&gt;&gt; plt.imshow(cwtmatr, extent=[-1, 1, 1, 31], cmap='PRGn', aspect='auto',</span>
<span class="sd">    ...            vmax=abs(cwtmatr).max(), vmin=-abs(cwtmatr).max())</span>
<span class="sd">    &gt;&gt;&gt; plt.show()</span>
<span class="sd">    """</span>

    <span class="c1"># accept array_like input; make a copy to ensure a contiguous array</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">_check_dtype</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>
    <span class="n">dt_cplx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">result_type</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wavelet</span><span class="p">,</span> <span class="p">(</span><span class="n">ContinuousWavelet</span><span class="p">,</span> <span class="n">Wavelet</span><span class="p">)):</span>
        <span class="n">wavelet</span> <span class="o">=</span> <span class="n">DiscreteContinuousWavelet</span><span class="p">(</span><span class="n">wavelet</span><span class="p">)</span>

    <span class="n">scales</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">scales</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">scales</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"`scales` must only include positive values"</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">axis</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">AxisError</span><span class="p">(</span><span class="s2">"axis must be a scalar."</span><span class="p">)</span>

    <span class="n">dt_out</span> <span class="o">=</span> <span class="n">dt_cplx</span> <span class="k">if</span> <span class="n">wavelet</span><span class="o">.</span><span class="n">complex_cwt</span> <span class="k">else</span> <span class="n">dt</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">scales</span><span class="p">),)</span> <span class="o">+</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dt_out</span><span class="p">)</span>
    <span class="n">precision</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">int_psi</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">integrate_wavelet</span><span class="p">(</span><span class="n">wavelet</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">int_psi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">int_psi</span><span class="p">)</span> <span class="k">if</span> <span class="n">wavelet</span><span class="o">.</span><span class="n">complex_cwt</span> <span class="k">else</span> <span class="n">int_psi</span>

    <span class="c1"># convert int_psi, x to the same precision as the data</span>
    <span class="n">dt_psi</span> <span class="o">=</span> <span class="n">dt_cplx</span> <span class="k">if</span> <span class="n">int_psi</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">'c'</span> <span class="k">else</span> <span class="n">dt</span>
    <span class="n">int_psi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">int_psi</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dt_psi</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">real</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">'fft'</span><span class="p">:</span>
        <span class="n">size_scale0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">fft_data</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">elif</span> <span class="n">method</span> <span class="o">!=</span> <span class="s2">"conv"</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"method must be 'conv' or 'fft'"</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># move axis to be transformed last (so it is contiguous)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

        <span class="c1"># reshape to (n_batch, data.shape[-1])</span>
        <span class="n">data_shape_pre</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">scale</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">scales</span><span class="p">):</span>
        <span class="n">step</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">scale</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">scale</span> <span class="o">*</span> <span class="n">step</span><span class="p">)</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">j</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>  <span class="c1"># floor</span>
        <span class="k">if</span> <span class="n">j</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">int_psi</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">j</span> <span class="o">&lt;</span> <span class="n">int_psi</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
        <span class="n">int_psi_scale</span> <span class="o">=</span> <span class="n">int_psi</span><span class="p">[</span><span class="n">j</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">'conv'</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">conv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">int_psi_scale</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># batch convolution via loop</span>
                <span class="n">conv_shape</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
                <span class="n">conv_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">int_psi_scale</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="n">conv_shape</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">conv_shape</span><span class="p">)</span>
                <span class="n">conv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">conv_shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dt_out</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="n">conv</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">int_psi_scale</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># The padding is selected for:</span>
            <span class="c1"># - optimal FFT complexity</span>
            <span class="c1"># - to be larger than the two signals length to avoid circular</span>
            <span class="c1">#   convolution</span>
            <span class="n">size_scale</span> <span class="o">=</span> <span class="n">next_fast_len</span><span class="p">(</span>
                <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">int_psi_scale</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">size_scale</span> <span class="o">!=</span> <span class="n">size_scale0</span><span class="p">:</span>
                <span class="c1"># Must recompute fft_data when the padding size changes.</span>
                <span class="n">fft_data</span> <span class="o">=</span> <span class="n">fftmodule</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size_scale</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">size_scale0</span> <span class="o">=</span> <span class="n">size_scale</span>
            <span class="n">fft_wav</span> <span class="o">=</span> <span class="n">fftmodule</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">int_psi_scale</span><span class="p">,</span> <span class="n">size_scale</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">conv</span> <span class="o">=</span> <span class="n">fftmodule</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">fft_wav</span> <span class="o">*</span> <span class="n">fft_data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">conv</span> <span class="o">=</span> <span class="n">conv</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">int_psi_scale</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>

        <span class="n">coef</span> <span class="o">=</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">conv</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">out</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">!=</span> <span class="s1">'c'</span><span class="p">:</span>
            <span class="n">coef</span> <span class="o">=</span> <span class="n">coef</span><span class="o">.</span><span class="n">real</span>
        <span class="c1"># transform axis is always -1 due to the data reshape above</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">coef</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mf">2.</span>
        <span class="k">if</span> <span class="n">d</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">coef</span> <span class="o">=</span> <span class="n">coef</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">floor</span><span class="p">(</span><span class="n">d</span><span class="p">):</span><span class="o">-</span><span class="n">ceil</span><span class="p">(</span><span class="n">d</span><span class="p">)]</span>
        <span class="k">elif</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">"Selected scale of </span><span class="si">{</span><span class="n">scale</span><span class="si">}</span><span class="s2"> too small."</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># restore original data shape and axis position</span>
            <span class="n">coef</span> <span class="o">=</span> <span class="n">coef</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">data_shape_pre</span><span class="p">)</span>
            <span class="n">coef</span> <span class="o">=</span> <span class="n">coef</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="n">coef</span>

    <span class="n">frequencies</span> <span class="o">=</span> <span class="n">scale2frequency</span><span class="p">(</span><span class="n">wavelet</span><span class="p">,</span> <span class="n">scales</span><span class="p">,</span> <span class="n">precision</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">frequencies</span><span class="p">):</span>
        <span class="n">frequencies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">frequencies</span><span class="p">])</span>
    <span class="n">frequencies</span> <span class="o">/=</span> <span class="n">sampling_period</span>
    <span class="k">return</span> <span class="n">out</span><span class="p">,</span> <span class="n">frequencies</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.downcoef">
<code class="highlight language-python"><span class="n">downcoef</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>downcoef(part, data, wavelet, mode='symmetric', level=1)</p>
<p>Partial Discrete Wavelet Transform data decomposition.</p>
<p>Similar to <code>pywt.dwt</code>, but computes only one set of coefficients.
Useful when you need only approximation or only details at the given level.</p>
<h4 id="pywt.downcoef--parameters">Parameters</h4>
<p>part : str
    Coefficients type:</p>
<div class="highlight"><pre><span></span><code>* 'a' - approximations reconstruction is performed
* 'd' - details reconstruction is performed
</code></pre></div>
<details class="data-" open="">
<summary>array_like</summary>
<p>Input signal.</p>
</details> <p>wavelet : Wavelet object or name
    Wavelet to use
mode : str, optional
    Signal extension mode, see :ref:<code>Modes &lt;ref-modes&gt;</code>.
level : int, optional
    Decomposition level.  Default is 1.</p>
<h4 id="pywt.downcoef--returns">Returns</h4>
<p>coeffs : ndarray
    1-D array of coefficients.</p>
<h4 id="pywt.downcoef--see-also">See Also</h4>
<p>upcoef</p>
<details class="quote">
<summary>Source code in <code>pywt/_dwt.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">downcoef</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    downcoef(part, data, wavelet, mode='symmetric', level=1)</span>

<span class="sd">    Partial Discrete Wavelet Transform data decomposition.</span>

<span class="sd">    Similar to ``pywt.dwt``, but computes only one set of coefficients.</span>
<span class="sd">    Useful when you need only approximation or only details at the given level.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    part : str</span>
<span class="sd">        Coefficients type:</span>

<span class="sd">        * 'a' - approximations reconstruction is performed</span>
<span class="sd">        * 'd' - details reconstruction is performed</span>

<span class="sd">    data : array_like</span>
<span class="sd">        Input signal.</span>
<span class="sd">    wavelet : Wavelet object or name</span>
<span class="sd">        Wavelet to use</span>
<span class="sd">    mode : str, optional</span>
<span class="sd">        Signal extension mode, see :ref:`Modes &lt;ref-modes&gt;`.</span>
<span class="sd">    level : int, optional</span>
<span class="sd">        Decomposition level.  Default is 1.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    coeffs : ndarray</span>
<span class="sd">        1-D array of coefficients.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    upcoef</span>

<span class="sd">    """</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_have_c99_complex</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">iscomplexobj</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">downcoef</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span> <span class="o">+</span>
                <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">downcoef</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">level</span><span class="p">))</span>
    <span class="c1"># accept array_like input; make a copy to ensure a contiguous array</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">_check_dtype</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">'C'</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"downcoef only supports 1d data."</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">part</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s1">'ad'</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Argument 1 must be 'a' or 'd', not '</span><span class="si">{</span><span class="n">part</span><span class="si">}</span><span class="s2">'."</span><span class="p">)</span>
    <span class="n">mode</span> <span class="o">=</span> <span class="n">Modes</span><span class="o">.</span><span class="n">from_object</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
    <span class="n">wavelet</span> <span class="o">=</span> <span class="n">_as_wavelet</span><span class="p">(</span><span class="n">wavelet</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">_downcoef</span><span class="p">(</span><span class="n">part</span> <span class="o">==</span> <span class="s1">'a'</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">level</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.dwt">
<code class="highlight language-python"><span class="n">dwt</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>dwt(data, wavelet, mode='symmetric', axis=-1)</p>
<p>Single level Discrete Wavelet Transform.</p>
<h4 id="pywt.dwt--parameters">Parameters</h4>
<p>data : array_like
    Input signal
wavelet : Wavelet object or name
    Wavelet to use
mode : str, optional
    Signal extension mode, see :ref:<code>Modes &lt;ref-modes&gt;</code>.
axis: int, optional
    Axis over which to compute the DWT. If not given, the
    last axis is used.</p>
<h4 id="pywt.dwt--returns">Returns</h4>
<p>(cA, cD) : tuple
    Approximation and detail coefficients.</p>
<h4 id="pywt.dwt--notes">Notes</h4>
<p>Length of coefficients arrays depends on the selected mode.
For all modes except periodization:</p>
<div class="highlight"><pre><span></span><code>``len(cA) == len(cD) == floor((len(data) + wavelet.dec_len - 1) / 2)``
</code></pre></div>
<p>For periodization mode ("per"):</p>
<div class="highlight"><pre><span></span><code>``len(cA) == len(cD) == ceil(len(data) / 2)``
</code></pre></div>
<h4 id="pywt.dwt--examples">Examples</h4>
<blockquote>
<blockquote>
<blockquote>
<p>import pywt
(cA, cD) = pywt.dwt([1, 2, 3, 4, 5, 6], 'db1')
cA
array([ 2.12132034,  4.94974747,  7.77817459])
cD
array([-0.70710678, -0.70710678, -0.70710678])</p>
</blockquote>
</blockquote>
</blockquote>
<details class="quote">
<summary>Source code in <code>pywt/_dwt.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">dwt</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    dwt(data, wavelet, mode='symmetric', axis=-1)</span>

<span class="sd">    Single level Discrete Wavelet Transform.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : array_like</span>
<span class="sd">        Input signal</span>
<span class="sd">    wavelet : Wavelet object or name</span>
<span class="sd">        Wavelet to use</span>
<span class="sd">    mode : str, optional</span>
<span class="sd">        Signal extension mode, see :ref:`Modes &lt;ref-modes&gt;`.</span>
<span class="sd">    axis: int, optional</span>
<span class="sd">        Axis over which to compute the DWT. If not given, the</span>
<span class="sd">        last axis is used.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    (cA, cD) : tuple</span>
<span class="sd">        Approximation and detail coefficients.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Length of coefficients arrays depends on the selected mode.</span>
<span class="sd">    For all modes except periodization:</span>

<span class="sd">        ``len(cA) == len(cD) == floor((len(data) + wavelet.dec_len - 1) / 2)``</span>

<span class="sd">    For periodization mode ("per"):</span>

<span class="sd">        ``len(cA) == len(cD) == ceil(len(data) / 2)``</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import pywt</span>
<span class="sd">    &gt;&gt;&gt; (cA, cD) = pywt.dwt([1, 2, 3, 4, 5, 6], 'db1')</span>
<span class="sd">    &gt;&gt;&gt; cA</span>
<span class="sd">    array([ 2.12132034,  4.94974747,  7.77817459])</span>
<span class="sd">    &gt;&gt;&gt; cD</span>
<span class="sd">    array([-0.70710678, -0.70710678, -0.70710678])</span>

<span class="sd">    """</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_have_c99_complex</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">iscomplexobj</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">cA_r</span><span class="p">,</span> <span class="n">cD_r</span> <span class="o">=</span> <span class="n">dwt</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
        <span class="n">cA_i</span><span class="p">,</span> <span class="n">cD_i</span> <span class="o">=</span> <span class="n">dwt</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">cA_r</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">cA_i</span><span class="p">,</span> <span class="n">cD_r</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">cD_i</span><span class="p">)</span>

    <span class="c1"># accept array_like input; make a copy to ensure a contiguous array</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">_check_dtype</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">'C'</span><span class="p">)</span>
    <span class="n">mode</span> <span class="o">=</span> <span class="n">Modes</span><span class="o">.</span><span class="n">from_object</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
    <span class="n">wavelet</span> <span class="o">=</span> <span class="n">_as_wavelet</span><span class="p">(</span><span class="n">wavelet</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">axis</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">axis</span> <span class="o">+</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">axis</span> <span class="o">&lt;</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">AxisError</span><span class="p">(</span><span class="s2">"Axis greater than data dimensions"</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">cA</span><span class="p">,</span> <span class="n">cD</span> <span class="o">=</span> <span class="n">dwt_single</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
        <span class="c1"># TODO: Check whether this makes a copy</span>
        <span class="n">cA</span><span class="p">,</span> <span class="n">cD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">cA</span><span class="p">,</span> <span class="n">dt</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">cD</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cA</span><span class="p">,</span> <span class="n">cD</span> <span class="o">=</span> <span class="n">dwt_axis</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">cA</span><span class="p">,</span> <span class="n">cD</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.dwt2">
<code class="highlight language-python"><span class="n">dwt2</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span></code>
</h2>
<div class="doc doc-contents">
<p>2D Discrete Wavelet Transform.</p>
<h4 id="pywt.dwt2--parameters">Parameters</h4>
<p>data : array_like
    2D array with input data
wavelet : Wavelet object or name string, or 2-tuple of wavelets
    Wavelet to use.  This can also be a tuple containing a wavelet to
    apply along each axis in <code>axes</code>.
mode : str or 2-tuple of strings, optional
    Signal extension mode, see :ref:<code>Modes &lt;ref-modes&gt;</code>. This can
    also be a tuple of modes specifying the mode to use on each axis in
    <code>axes</code>.
axes : 2-tuple of ints, optional
    Axes over which to compute the DWT. Repeated elements mean the DWT will
    be performed multiple times along these axes.</p>
<h4 id="pywt.dwt2--returns">Returns</h4>
<p>(cA, (cH, cV, cD)) : tuple
    Approximation, horizontal detail, vertical detail and diagonal
    detail coefficients respectively.  Horizontal refers to array axis 0
    (or <code>axes[0]</code> for user-specified <code>axes</code>).</p>
<h4 id="pywt.dwt2--examples">Examples</h4>
<blockquote>
<blockquote>
<blockquote>
<p>import numpy as np
import pywt
data = np.ones((4,4), dtype=np.float64)
coeffs = pywt.dwt2(data, 'haar')
cA, (cH, cV, cD) = coeffs
cA
array([[ 2.,  2.],
       [ 2.,  2.]])
cV
array([[ 0.,  0.],
       [ 0.,  0.]])</p>
</blockquote>
</blockquote>
</blockquote>
<details class="quote">
<summary>Source code in <code>pywt/_multidim.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">dwt2</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    2D Discrete Wavelet Transform.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : array_like</span>
<span class="sd">        2D array with input data</span>
<span class="sd">    wavelet : Wavelet object or name string, or 2-tuple of wavelets</span>
<span class="sd">        Wavelet to use.  This can also be a tuple containing a wavelet to</span>
<span class="sd">        apply along each axis in ``axes``.</span>
<span class="sd">    mode : str or 2-tuple of strings, optional</span>
<span class="sd">        Signal extension mode, see :ref:`Modes &lt;ref-modes&gt;`. This can</span>
<span class="sd">        also be a tuple of modes specifying the mode to use on each axis in</span>
<span class="sd">        ``axes``.</span>
<span class="sd">    axes : 2-tuple of ints, optional</span>
<span class="sd">        Axes over which to compute the DWT. Repeated elements mean the DWT will</span>
<span class="sd">        be performed multiple times along these axes.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    (cA, (cH, cV, cD)) : tuple</span>
<span class="sd">        Approximation, horizontal detail, vertical detail and diagonal</span>
<span class="sd">        detail coefficients respectively.  Horizontal refers to array axis 0</span>
<span class="sd">        (or ``axes[0]`` for user-specified ``axes``).</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; import pywt</span>
<span class="sd">    &gt;&gt;&gt; data = np.ones((4,4), dtype=np.float64)</span>
<span class="sd">    &gt;&gt;&gt; coeffs = pywt.dwt2(data, 'haar')</span>
<span class="sd">    &gt;&gt;&gt; cA, (cH, cV, cD) = coeffs</span>
<span class="sd">    &gt;&gt;&gt; cA</span>
<span class="sd">    array([[ 2.,  2.],</span>
<span class="sd">           [ 2.,  2.]])</span>
<span class="sd">    &gt;&gt;&gt; cV</span>
<span class="sd">    array([[ 0.,  0.],</span>
<span class="sd">           [ 0.,  0.]])</span>

<span class="sd">    """</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Expected 2 axes"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">axes</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Input array has fewer dimensions than the specified "</span>
                         <span class="s2">"axes"</span><span class="p">)</span>

    <span class="n">coefs</span> <span class="o">=</span> <span class="n">dwtn</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">coefs</span><span class="p">[</span><span class="s1">'aa'</span><span class="p">],</span> <span class="p">(</span><span class="n">coefs</span><span class="p">[</span><span class="s1">'da'</span><span class="p">],</span> <span class="n">coefs</span><span class="p">[</span><span class="s1">'ad'</span><span class="p">],</span> <span class="n">coefs</span><span class="p">[</span><span class="s1">'dd'</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.dwt_coeff_len">
<code class="highlight language-python"><span class="n">dwt_coeff_len</span><span class="p">(</span><span class="n">data_len</span><span class="p">,</span> <span class="n">filter_len</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>dwt_coeff_len(data_len, filter_len, mode='symmetric')</p>
<p>Returns length of dwt output for given data length, filter length and mode</p>
<h4 id="pywt.dwt_coeff_len--parameters">Parameters</h4>
<p>data_len : int
    Data length.
filter_len : int
    Filter length.
mode : str, optional
    Signal extension mode, see :ref:<code>Modes &lt;ref-modes&gt;</code>.</p>
<h4 id="pywt.dwt_coeff_len--returns">Returns</h4>
<p>len : int
    Length of dwt output.</p>
<h4 id="pywt.dwt_coeff_len--notes">Notes</h4>
<p>For all modes except periodization::</p>
<div class="highlight"><pre><span></span><code>len(cA) == len(cD) == floor((len(data) + wavelet.dec_len - 1) / 2)
</code></pre></div>
<p>for periodization mode ("per")::</p>
<div class="highlight"><pre><span></span><code>len(cA) == len(cD) == ceil(len(data) / 2)
</code></pre></div>
<details class="quote">
<summary>Source code in <code>pywt/_dwt.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">dwt_coeff_len</span><span class="p">(</span><span class="n">data_len</span><span class="p">,</span> <span class="n">filter_len</span><span class="p">,</span> <span class="n">mode</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    dwt_coeff_len(data_len, filter_len, mode='symmetric')</span>

<span class="sd">    Returns length of dwt output for given data length, filter length and mode</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data_len : int</span>
<span class="sd">        Data length.</span>
<span class="sd">    filter_len : int</span>
<span class="sd">        Filter length.</span>
<span class="sd">    mode : str, optional</span>
<span class="sd">        Signal extension mode, see :ref:`Modes &lt;ref-modes&gt;`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    len : int</span>
<span class="sd">        Length of dwt output.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    For all modes except periodization::</span>

<span class="sd">        len(cA) == len(cD) == floor((len(data) + wavelet.dec_len - 1) / 2)</span>

<span class="sd">    for periodization mode ("per")::</span>

<span class="sd">        len(cA) == len(cD) == ceil(len(data) / 2)</span>

<span class="sd">    """</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filter_len</span><span class="p">,</span> <span class="n">Wavelet</span><span class="p">):</span>
        <span class="n">filter_len</span> <span class="o">=</span> <span class="n">filter_len</span><span class="o">.</span><span class="n">dec_len</span>

    <span class="k">return</span> <span class="n">_dwt_coeff_len</span><span class="p">(</span><span class="n">data_len</span><span class="p">,</span> <span class="n">filter_len</span><span class="p">,</span> <span class="n">Modes</span><span class="o">.</span><span class="n">from_object</span><span class="p">(</span><span class="n">mode</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.dwt_max_level">
<code class="highlight language-python"><span class="n">dwt_max_level</span><span class="p">(</span><span class="n">data_len</span><span class="p">,</span> <span class="n">filter_len</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>dwt_max_level(data_len, filter_len)</p>
<p>Compute the maximum useful level of decomposition.</p>
<h4 id="pywt.dwt_max_level--parameters">Parameters</h4>
<p>data_len : int
    Input data length.
filter_len : int, str or Wavelet
    The wavelet filter length.  Alternatively, the name of a discrete
    wavelet or a Wavelet object can be specified.</p>
<h4 id="pywt.dwt_max_level--returns">Returns</h4>
<p>max_level : int
    Maximum level.</p>
<h4 id="pywt.dwt_max_level--notes">Notes</h4>
<p>The rational for the choice of levels is the maximum level where at least
one coefficient in the output is uncorrupted by edge effects caused by
signal extension.  Put another way, decomposition stops when the signal
becomes shorter than the FIR filter length for a given wavelet.  This
corresponds to:</p>
<p>.. max_level = floor(log2(data_len/(filter_len - 1)))</p>
<p>.. math::
    \mathtt{max_level} = \left\lfloor\log_2\left(\mathtt{
        \frac{data_len}{filter_len - 1}}\right)\right\rfloor</p>
<h4 id="pywt.dwt_max_level--examples">Examples</h4>
<blockquote>
<blockquote>
<blockquote>
<p>import pywt
w = pywt.Wavelet('sym5')
pywt.dwt_max_level(data_len=1000, filter_len=w.dec_len)
6
pywt.dwt_max_level(1000, w)
6
pywt.dwt_max_level(1000, 'sym5')
6</p>
</blockquote>
</blockquote>
</blockquote>
<details class="quote">
<summary>Source code in <code>pywt/_dwt.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">dwt_max_level</span><span class="p">(</span><span class="n">data_len</span><span class="p">,</span> <span class="n">filter_len</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">"""</span>
<span class="sd">    dwt_max_level(data_len, filter_len)</span>

<span class="sd">    Compute the maximum useful level of decomposition.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data_len : int</span>
<span class="sd">        Input data length.</span>
<span class="sd">    filter_len : int, str or Wavelet</span>
<span class="sd">        The wavelet filter length.  Alternatively, the name of a discrete</span>
<span class="sd">        wavelet or a Wavelet object can be specified.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    max_level : int</span>
<span class="sd">        Maximum level.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The rational for the choice of levels is the maximum level where at least</span>
<span class="sd">    one coefficient in the output is uncorrupted by edge effects caused by</span>
<span class="sd">    signal extension.  Put another way, decomposition stops when the signal</span>
<span class="sd">    becomes shorter than the FIR filter length for a given wavelet.  This</span>
<span class="sd">    corresponds to:</span>

<span class="sd">    .. max_level = floor(log2(data_len/(filter_len - 1)))</span>

<span class="sd">    .. math::</span>
<span class="sd">        \mathtt{max\_level} = \left\lfloor\log_2\left(\mathtt{</span>
<span class="sd">            \frac{data\_len}{filter\_len - 1}}\right)\right\rfloor</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import pywt</span>
<span class="sd">    &gt;&gt;&gt; w = pywt.Wavelet('sym5')</span>
<span class="sd">    &gt;&gt;&gt; pywt.dwt_max_level(data_len=1000, filter_len=w.dec_len)</span>
<span class="sd">    6</span>
<span class="sd">    &gt;&gt;&gt; pywt.dwt_max_level(1000, w)</span>
<span class="sd">    6</span>
<span class="sd">    &gt;&gt;&gt; pywt.dwt_max_level(1000, 'sym5')</span>
<span class="sd">    6</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filter_len</span><span class="p">,</span> <span class="n">Wavelet</span><span class="p">):</span>
        <span class="n">filter_len</span> <span class="o">=</span> <span class="n">filter_len</span><span class="o">.</span><span class="n">dec_len</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filter_len</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">filter_len</span> <span class="ow">in</span> <span class="n">wavelist</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">'discrete'</span><span class="p">):</span>
            <span class="n">filter_len</span> <span class="o">=</span> <span class="n">Wavelet</span><span class="p">(</span><span class="n">filter_len</span><span class="p">)</span><span class="o">.</span><span class="n">dec_len</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">"'</span><span class="si">{</span><span class="n">filter_len</span><span class="si">}</span><span class="s2">', is not a recognized discrete wavelet.  A list of "</span>
                 <span class="s2">"supported wavelet names can be obtained via "</span>
                 <span class="s2">"pywt.wavelist(kind='discrete')"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">filter_len</span><span class="p">,</span> <span class="n">Number</span><span class="p">)</span> <span class="ow">and</span> <span class="n">filter_len</span> <span class="o">%</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">"filter_len must be an integer, discrete Wavelet object, or the "</span>
            <span class="s2">"name of a discrete wavelet."</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">filter_len</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"invalid wavelet filter length"</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">_dwt_max_level</span><span class="p">(</span><span class="n">data_len</span><span class="p">,</span> <span class="n">filter_len</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.dwtn">
<code class="highlight language-python"><span class="n">dwtn</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Single-level n-dimensional Discrete Wavelet Transform.</p>
<h4 id="pywt.dwtn--parameters">Parameters</h4>
<p>data : array_like
    n-dimensional array with input data.
wavelet : Wavelet object or name string, or tuple of wavelets
    Wavelet to use.  This can also be a tuple containing a wavelet to
    apply along each axis in <code>axes</code>.
mode : str or tuple of string, optional
    Signal extension mode used in the decomposition,
    see :ref:<code>Modes &lt;ref-modes&gt;</code>. This can also be a tuple of modes
    specifying the mode to use on each axis in <code>axes</code>.
axes : sequence of ints, optional
    Axes over which to compute the DWT. Repeated elements mean the DWT will
    be performed multiple times along these axes. A value of <code>None</code> (the
    default) selects all axes.</p>
<div class="highlight"><pre><span></span><code>Axes may be repeated, but information about the original size may be
lost if it is not divisible by ``2 ** nrepeats``. The reconstruction
will be larger, with additional values derived according to the
``mode`` parameter. ``pywt.wavedecn`` should be used for multilevel
decomposition.
</code></pre></div>
<h4 id="pywt.dwtn--returns">Returns</h4>
<p>coeffs : dict
    Results are arranged in a dictionary, where key specifies
    the transform type on each dimension and value is a n-dimensional
    coefficients array.</p>
<div class="highlight"><pre><span></span><code>For example, for a 2D case the result will look something like this::

    {'aa': &lt;coeffs&gt;  # A(LL) - approx. on 1st dim, approx. on 2nd dim
     'ad': &lt;coeffs&gt;  # V(LH) - approx. on 1st dim, det. on 2nd dim
     'da': &lt;coeffs&gt;  # H(HL) - det. on 1st dim, approx. on 2nd dim
     'dd': &lt;coeffs&gt;  # D(HH) - det. on 1st dim, det. on 2nd dim
    }

For user-specified ``axes``, the order of the characters in the
dictionary keys map to the specified ``axes``.
</code></pre></div>
<details class="quote">
<summary>Source code in <code>pywt/_multidim.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">dwtn</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Single-level n-dimensional Discrete Wavelet Transform.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : array_like</span>
<span class="sd">        n-dimensional array with input data.</span>
<span class="sd">    wavelet : Wavelet object or name string, or tuple of wavelets</span>
<span class="sd">        Wavelet to use.  This can also be a tuple containing a wavelet to</span>
<span class="sd">        apply along each axis in ``axes``.</span>
<span class="sd">    mode : str or tuple of string, optional</span>
<span class="sd">        Signal extension mode used in the decomposition,</span>
<span class="sd">        see :ref:`Modes &lt;ref-modes&gt;`. This can also be a tuple of modes</span>
<span class="sd">        specifying the mode to use on each axis in ``axes``.</span>
<span class="sd">    axes : sequence of ints, optional</span>
<span class="sd">        Axes over which to compute the DWT. Repeated elements mean the DWT will</span>
<span class="sd">        be performed multiple times along these axes. A value of ``None`` (the</span>
<span class="sd">        default) selects all axes.</span>

<span class="sd">        Axes may be repeated, but information about the original size may be</span>
<span class="sd">        lost if it is not divisible by ``2 ** nrepeats``. The reconstruction</span>
<span class="sd">        will be larger, with additional values derived according to the</span>
<span class="sd">        ``mode`` parameter. ``pywt.wavedecn`` should be used for multilevel</span>
<span class="sd">        decomposition.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    coeffs : dict</span>
<span class="sd">        Results are arranged in a dictionary, where key specifies</span>
<span class="sd">        the transform type on each dimension and value is a n-dimensional</span>
<span class="sd">        coefficients array.</span>

<span class="sd">        For example, for a 2D case the result will look something like this::</span>

<span class="sd">            {'aa': &lt;coeffs&gt;  # A(LL) - approx. on 1st dim, approx. on 2nd dim</span>
<span class="sd">             'ad': &lt;coeffs&gt;  # V(LH) - approx. on 1st dim, det. on 2nd dim</span>
<span class="sd">             'da': &lt;coeffs&gt;  # H(HL) - det. on 1st dim, approx. on 2nd dim</span>
<span class="sd">             'dd': &lt;coeffs&gt;  # D(HH) - det. on 1st dim, det. on 2nd dim</span>
<span class="sd">            }</span>

<span class="sd">        For user-specified ``axes``, the order of the characters in the</span>
<span class="sd">        dictionary keys map to the specified ``axes``.</span>

<span class="sd">    """</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_have_c99_complex</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">iscomplexobj</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
        <span class="n">real</span> <span class="o">=</span> <span class="n">dwtn</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
        <span class="n">imag</span> <span class="o">=</span> <span class="n">dwtn</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">real</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">imag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">real</span><span class="p">}</span>

    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s1">'object'</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">"Input must be a numeric array-like"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Input data must be at least 1D"</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="o">+</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">]</span>

    <span class="n">modes</span> <span class="o">=</span> <span class="n">_modes_per_axis</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
    <span class="n">wavelets</span> <span class="o">=</span> <span class="n">_wavelets_per_axis</span><span class="p">(</span><span class="n">wavelet</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>

    <span class="n">coeffs</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">''</span><span class="p">,</span> <span class="n">data</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">axis</span><span class="p">,</span> <span class="n">wav</span><span class="p">,</span> <span class="n">mode</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">wavelets</span><span class="p">,</span> <span class="n">modes</span><span class="p">):</span>
        <span class="n">new_coeffs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">subband</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">:</span>
            <span class="n">cA</span><span class="p">,</span> <span class="n">cD</span> <span class="o">=</span> <span class="n">dwt_axis</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">wav</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
            <span class="n">new_coeffs</span><span class="o">.</span><span class="n">extend</span><span class="p">([(</span><span class="n">subband</span> <span class="o">+</span> <span class="s1">'a'</span><span class="p">,</span> <span class="n">cA</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">subband</span> <span class="o">+</span> <span class="s1">'d'</span><span class="p">,</span> <span class="n">cD</span><span class="p">)])</span>
        <span class="n">coeffs</span> <span class="o">=</span> <span class="n">new_coeffs</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.dwtn_max_level">
<code class="highlight language-python"><span class="n">dwtn_max_level</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Compute the maximum level of decomposition for n-dimensional data.</p>
<p>This returns the maximum number of levels of decomposition suitable for use
with <code>wavedec</code>, <code>wavedec2</code> or <code>wavedecn</code>.</p>
<h4 id="pywt.dwtn_max_level--parameters">Parameters</h4>
<p>shape : sequence of ints
    Input data shape.
wavelet : Wavelet object or name string, or tuple of wavelets
    Wavelet to use. This can also be a tuple containing a wavelet to
    apply along each axis in <code>axes</code>.
axes : sequence of ints, optional
    Axes over which to compute the DWT. Axes may not be repeated.</p>
<h4 id="pywt.dwtn_max_level--returns">Returns</h4>
<p>level : int
    Maximum level.</p>
<h4 id="pywt.dwtn_max_level--notes">Notes</h4>
<p>The level returned is the smallest <code>dwt_max_level</code> over all axes.</p>
<h4 id="pywt.dwtn_max_level--examples">Examples</h4>
<blockquote>
<blockquote>
<blockquote>
<p>import pywt
pywt.dwtn_max_level((64, 32), 'db2')
3</p>
</blockquote>
</blockquote>
</blockquote>
<details class="quote">
<summary>Source code in <code>pywt/_multilevel.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">dwtn_max_level</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Compute the maximum level of decomposition for n-dimensional data.</span>

<span class="sd">    This returns the maximum number of levels of decomposition suitable for use</span>
<span class="sd">    with ``wavedec``, ``wavedec2`` or ``wavedecn``.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    shape : sequence of ints</span>
<span class="sd">        Input data shape.</span>
<span class="sd">    wavelet : Wavelet object or name string, or tuple of wavelets</span>
<span class="sd">        Wavelet to use. This can also be a tuple containing a wavelet to</span>
<span class="sd">        apply along each axis in ``axes``.</span>
<span class="sd">    axes : sequence of ints, optional</span>
<span class="sd">        Axes over which to compute the DWT. Axes may not be repeated.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    level : int</span>
<span class="sd">        Maximum level.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The level returned is the smallest ``dwt_max_level`` over all axes.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import pywt</span>
<span class="sd">    &gt;&gt;&gt; pywt.dwtn_max_level((64, 32), 'db2')</span>
<span class="sd">    3</span>
<span class="sd">    """</span>
    <span class="c1"># Determine the axes and shape for the transform</span>
    <span class="n">axes</span><span class="p">,</span> <span class="n">axes_shapes</span><span class="p">,</span> <span class="n">ndim_transform</span> <span class="o">=</span> <span class="n">_prep_axes_wavedecn</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>

    <span class="c1"># initialize a Wavelet object per (transformed) axis</span>
    <span class="n">wavelets</span> <span class="o">=</span> <span class="n">_wavelets_per_axis</span><span class="p">(</span><span class="n">wavelet</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>

    <span class="c1"># maximum level of decomposition per axis</span>
    <span class="n">max_levels</span> <span class="o">=</span> <span class="p">[</span><span class="n">dwt_max_level</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">wav</span><span class="o">.</span><span class="n">dec_len</span><span class="p">)</span>
                  <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">wav</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes_shapes</span><span class="p">,</span> <span class="n">wavelets</span><span class="p">)]</span>
    <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_levels</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.frequency2scale">
<code class="highlight language-python"><span class="n">frequency2scale</span><span class="p">(</span><span class="n">wavelet</span><span class="p">,</span> <span class="n">freq</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Convert from to normalized frequency to CWT "scale".</p>
<h4 id="pywt.frequency2scale--parameters">Parameters</h4>
<p>wavelet : Wavelet instance or str
    Wavelet to integrate.  If a string, should be the name of a wavelet.
freq : scalar
    Frequency, normalized so that the sampling frequency corresponds to a
    value of 1.0.
precision : int, optional
    Precision that will be used for wavelet function approximation computed
    with <code>wavelet.wavefun(level=precision)</code>.  Default is 8.</p>
<h4 id="pywt.frequency2scale--returns">Returns</h4>
<p>scale : scalar</p>
<details class="quote">
<summary>Source code in <code>pywt/_functions.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">frequency2scale</span><span class="p">(</span><span class="n">wavelet</span><span class="p">,</span> <span class="n">freq</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Convert from to normalized frequency to CWT "scale".</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavelet : Wavelet instance or str</span>
<span class="sd">        Wavelet to integrate.  If a string, should be the name of a wavelet.</span>
<span class="sd">    freq : scalar</span>
<span class="sd">        Frequency, normalized so that the sampling frequency corresponds to a</span>
<span class="sd">        value of 1.0.</span>
<span class="sd">    precision : int, optional</span>
<span class="sd">        Precision that will be used for wavelet function approximation computed</span>
<span class="sd">        with ``wavelet.wavefun(level=precision)``.  Default is 8.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    scale : scalar</span>

<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">central_frequency</span><span class="p">(</span><span class="n">wavelet</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span> <span class="o">/</span> <span class="n">freq</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.fswavedecn">
<code class="highlight language-python"><span class="n">fswavedecn</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Fully Separable Wavelet Decomposition.</p>
<p>This is a variant of the multilevel discrete wavelet transform where all
levels of decomposition are performed along a single axis prior to moving
onto the next axis.  Unlike in <code>wavedecn</code>, the number of levels of
decomposition are not required to be the same along each axis which can be
a benefit for anisotropic data.</p>
<h4 id="pywt.fswavedecn--parameters">Parameters</h4>
<p>data: array_like
    Input data
wavelet : Wavelet object or name string, or tuple of wavelets
    Wavelet to use.  This can also be a tuple containing a wavelet to
    apply along each axis in <code>axes</code>.
mode : str or tuple of str, optional
    Signal extension mode, see :ref:<code>Modes &lt;ref-modes&gt;</code>. This can
    also be a tuple containing a mode to apply along each axis in <code>axes</code>.
levels : int or sequence of ints, optional
    Decomposition levels along each axis (must be &gt;= 0). If an integer is
    provided, the same number of levels are used for all axes. If
    <code>levels</code> is None (default), <code>dwt_max_level</code> will be used to compute
    the maximum number of levels possible for each axis.
axes : sequence of ints, optional
    Axes over which to compute the transform. Axes may not be repeated. The
    default is to transform along all axes.</p>
<h4 id="pywt.fswavedecn--returns">Returns</h4>
<p>fswavedecn_result : FswavedecnResult object
    Contains the wavelet coefficients, slice objects to allow obtaining
    the coefficients per detail or approximation level, and more.
    See <code>FswavedecnResult</code> for details.</p>
<h4 id="pywt.fswavedecn--examples">Examples</h4>
<blockquote>
<blockquote>
<blockquote>
<p>import numpy as np
from pywt import fswavedecn
fs_result = fswavedecn(np.ones((32, 32)), 'sym2', levels=(1, 3))
print(fs_result.detail_keys())
[(0, 1), (0, 2), (0, 3), (1, 0), (1, 1), (1, 2), (1, 3)]
approx_coeffs = fs_result.approx
detail_1_2 = fs_result[(1, 2)]</p>
</blockquote>
</blockquote>
</blockquote>
<h4 id="pywt.fswavedecn--notes">Notes</h4>
<p>This transformation has been variously referred to as the (fully) separable
wavelet transform (e.g. refs [1]<em>, [3]</em>), the tensor-product wavelet
([2]<em>) or the hyperbolic wavelet transform ([4]</em>).  It is well suited to
data with anisotropic smoothness.</p>
<p>In [2]_ it was demonstrated that fully separable transform performs at
least as well as the DWT for image compression.  Computation time is a
factor 2 larger than that for the DWT.</p>
<h4 id="pywt.fswavedecn--see-also">See Also</h4>
<p>fswaverecn : inverse of fswavedecn</p>
<h4 id="pywt.fswavedecn--references">References</h4>
<p>.. [1] PH Westerink. Subband Coding of Images. Ph.D. dissertation, Dept.
   Elect. Eng., Inf. Theory Group, Delft Univ. Technol., Delft, The
   Netherlands, 1989.  (see Section 2.3)
   http://resolver.tudelft.nl/uuid:a4d195c3-1f89-4d66-913d-db9af0969509</p>
<p>.. [2] CP Rosiene and TQ Nguyen. Tensor-product wavelet vs. Mallat
   decomposition: A comparative analysis, in Proc. IEEE Int. Symp.
   Circuits and Systems, Orlando, FL, Jun. 1999, pp. 431-434.</p>
<p>.. [3] V Velisavljevic, B Beferull-Lozano, M Vetterli and PL Dragotti.
   Directionlets: Anisotropic Multidirectional Representation With
   Separable Filtering. IEEE Transactions on Image Processing, Vol. 15,
   No. 7, July 2006.</p>
<p>.. [4] RA DeVore, SV Konyagin and VN Temlyakov. "Hyperbolic wavelet
   approximation," Constr. Approx. 14 (1998), 1-26.</p>
<details class="quote">
<summary>Source code in <code>pywt/_multilevel.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fswavedecn</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Fully Separable Wavelet Decomposition.</span>

<span class="sd">    This is a variant of the multilevel discrete wavelet transform where all</span>
<span class="sd">    levels of decomposition are performed along a single axis prior to moving</span>
<span class="sd">    onto the next axis.  Unlike in ``wavedecn``, the number of levels of</span>
<span class="sd">    decomposition are not required to be the same along each axis which can be</span>
<span class="sd">    a benefit for anisotropic data.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data: array_like</span>
<span class="sd">        Input data</span>
<span class="sd">    wavelet : Wavelet object or name string, or tuple of wavelets</span>
<span class="sd">        Wavelet to use.  This can also be a tuple containing a wavelet to</span>
<span class="sd">        apply along each axis in ``axes``.</span>
<span class="sd">    mode : str or tuple of str, optional</span>
<span class="sd">        Signal extension mode, see :ref:`Modes &lt;ref-modes&gt;`. This can</span>
<span class="sd">        also be a tuple containing a mode to apply along each axis in ``axes``.</span>
<span class="sd">    levels : int or sequence of ints, optional</span>
<span class="sd">        Decomposition levels along each axis (must be &gt;= 0). If an integer is</span>
<span class="sd">        provided, the same number of levels are used for all axes. If</span>
<span class="sd">        ``levels`` is None (default), ``dwt_max_level`` will be used to compute</span>
<span class="sd">        the maximum number of levels possible for each axis.</span>
<span class="sd">    axes : sequence of ints, optional</span>
<span class="sd">        Axes over which to compute the transform. Axes may not be repeated. The</span>
<span class="sd">        default is to transform along all axes.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fswavedecn_result : FswavedecnResult object</span>
<span class="sd">        Contains the wavelet coefficients, slice objects to allow obtaining</span>
<span class="sd">        the coefficients per detail or approximation level, and more.</span>
<span class="sd">        See ``FswavedecnResult`` for details.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; from pywt import fswavedecn</span>
<span class="sd">    &gt;&gt;&gt; fs_result = fswavedecn(np.ones((32, 32)), 'sym2', levels=(1, 3))</span>
<span class="sd">    &gt;&gt;&gt; print(fs_result.detail_keys())</span>
<span class="sd">    [(0, 1), (0, 2), (0, 3), (1, 0), (1, 1), (1, 2), (1, 3)]</span>
<span class="sd">    &gt;&gt;&gt; approx_coeffs = fs_result.approx</span>
<span class="sd">    &gt;&gt;&gt; detail_1_2 = fs_result[(1, 2)]</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This transformation has been variously referred to as the (fully) separable</span>
<span class="sd">    wavelet transform (e.g. refs [1]_, [3]_), the tensor-product wavelet</span>
<span class="sd">    ([2]_) or the hyperbolic wavelet transform ([4]_).  It is well suited to</span>
<span class="sd">    data with anisotropic smoothness.</span>

<span class="sd">    In [2]_ it was demonstrated that fully separable transform performs at</span>
<span class="sd">    least as well as the DWT for image compression.  Computation time is a</span>
<span class="sd">    factor 2 larger than that for the DWT.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    fswaverecn : inverse of fswavedecn</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] PH Westerink. Subband Coding of Images. Ph.D. dissertation, Dept.</span>
<span class="sd">       Elect. Eng., Inf. Theory Group, Delft Univ. Technol., Delft, The</span>
<span class="sd">       Netherlands, 1989.  (see Section 2.3)</span>
<span class="sd">       http://resolver.tudelft.nl/uuid:a4d195c3-1f89-4d66-913d-db9af0969509</span>

<span class="sd">    .. [2] CP Rosiene and TQ Nguyen. Tensor-product wavelet vs. Mallat</span>
<span class="sd">       decomposition: A comparative analysis, in Proc. IEEE Int. Symp.</span>
<span class="sd">       Circuits and Systems, Orlando, FL, Jun. 1999, pp. 431-434.</span>

<span class="sd">    .. [3] V Velisavljevic, B Beferull-Lozano, M Vetterli and PL Dragotti.</span>
<span class="sd">       Directionlets: Anisotropic Multidirectional Representation With</span>
<span class="sd">       Separable Filtering. IEEE Transactions on Image Processing, Vol. 15,</span>
<span class="sd">       No. 7, July 2006.</span>

<span class="sd">    .. [4] RA DeVore, SV Konyagin and VN Temlyakov. "Hyperbolic wavelet</span>
<span class="sd">       approximation," Constr. Approx. 14 (1998), 1-26.</span>
<span class="sd">    """</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">ndim</span><span class="p">))</span>
    <span class="n">_check_fswavedecn_axes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">levels</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">levels</span><span class="p">):</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="p">[</span><span class="n">levels</span><span class="p">,</span> <span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"levels must match the length of the axes list"</span><span class="p">)</span>

    <span class="n">modes</span> <span class="o">=</span> <span class="n">_modes_per_axis</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
    <span class="n">wavelets</span> <span class="o">=</span> <span class="n">_wavelets_per_axis</span><span class="p">(</span><span class="n">wavelet</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>

    <span class="n">coeff_slices</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> <span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>
    <span class="n">coeffs_arr</span> <span class="o">=</span> <span class="n">data</span>
    <span class="k">for</span> <span class="n">ax_count</span><span class="p">,</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">lev</span><span class="p">,</span> <span class="n">wav</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
            <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="n">wavelets</span><span class="p">,</span> <span class="n">modes</span><span class="p">)):</span>
        <span class="n">coeffs</span> <span class="o">=</span> <span class="n">wavedec</span><span class="p">(</span><span class="n">coeffs_arr</span><span class="p">,</span> <span class="n">wav</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">lev</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

        <span class="c1"># Slice objects for accessing coefficient subsets.</span>
        <span class="c1"># These can be used to access specific detail coefficient arrays</span>
        <span class="c1"># (e.g. as needed for inverse transformation via fswaverecn).</span>
        <span class="n">c_shapes</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">]</span>
        <span class="n">c_offsets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="p">]</span> <span class="o">+</span> <span class="n">c_shapes</span><span class="p">)</span>
        <span class="n">coeff_slices</span><span class="p">[</span><span class="n">ax_count</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="nb">slice</span><span class="p">(</span><span class="n">c_offsets</span><span class="p">[</span><span class="n">d</span><span class="p">],</span> <span class="n">c_offsets</span><span class="p">[</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c_shapes</span><span class="p">))]</span>

        <span class="c1"># stack the coefficients from all levels into a single array</span>
        <span class="n">coeffs_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">FswavedecnResult</span><span class="p">(</span><span class="n">coeffs_arr</span><span class="p">,</span> <span class="n">coeff_slices</span><span class="p">,</span> <span class="n">wavelets</span><span class="p">,</span> <span class="n">modes</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.fswaverecn">
<code class="highlight language-python"><span class="n">fswaverecn</span><span class="p">(</span><span class="n">fswavedecn_result</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Fully Separable Inverse Wavelet Reconstruction.</p>
<h4 id="pywt.fswaverecn--parameters">Parameters</h4>
<p>fswavedecn_result : FswavedecnResult object
    FswavedecnResult object from <code>fswavedecn</code>.</p>
<h4 id="pywt.fswaverecn--returns">Returns</h4>
<p>reconstructed : ndarray
    Array of reconstructed data.</p>
<h4 id="pywt.fswaverecn--notes">Notes</h4>
<p>This transformation has been variously referred to as the (fully) separable
wavelet transform (e.g. refs [1]<em>, [3]</em>), the tensor-product wavelet
([2]<em>) or the hyperbolic wavelet transform ([4]</em>).  It is well suited to
data with anisotropic smoothness.</p>
<p>In [2]_ it was demonstrated that the fully separable transform performs at
least as well as the DWT for image compression. Computation time is a
factor 2 larger than that for the DWT.</p>
<h4 id="pywt.fswaverecn--see-also">See Also</h4>
<p>fswavedecn : inverse of fswaverecn</p>
<h4 id="pywt.fswaverecn--references">References</h4>
<p>.. [1] PH Westerink. Subband Coding of Images. Ph.D. dissertation, Dept.
   Elect. Eng., Inf. Theory Group, Delft Univ. Technol., Delft, The
   Netherlands, 1989.  (see Section 2.3)
   http://resolver.tudelft.nl/uuid:a4d195c3-1f89-4d66-913d-db9af0969509</p>
<p>.. [2] CP Rosiene and TQ Nguyen. Tensor-product wavelet vs. Mallat
   decomposition: A comparative analysis, in Proc. IEEE Int. Symp.
   Circuits and Systems, Orlando, FL, Jun. 1999, pp. 431-434.</p>
<p>.. [3] V Velisavljevic, B Beferull-Lozano, M Vetterli and PL Dragotti.
   Directionlets: Anisotropic Multidirectional Representation With
   Separable Filtering. IEEE Transactions on Image Processing, Vol. 15,
   No. 7, July 2006.</p>
<p>.. [4] RA DeVore, SV Konyagin and VN Temlyakov. "Hyperbolic wavelet
   approximation," Constr. Approx. 14 (1998), 1-26.</p>
<details class="quote">
<summary>Source code in <code>pywt/_multilevel.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fswaverecn</span><span class="p">(</span><span class="n">fswavedecn_result</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Fully Separable Inverse Wavelet Reconstruction.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    fswavedecn_result : FswavedecnResult object</span>
<span class="sd">        FswavedecnResult object from ``fswavedecn``.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    reconstructed : ndarray</span>
<span class="sd">        Array of reconstructed data.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This transformation has been variously referred to as the (fully) separable</span>
<span class="sd">    wavelet transform (e.g. refs [1]_, [3]_), the tensor-product wavelet</span>
<span class="sd">    ([2]_) or the hyperbolic wavelet transform ([4]_).  It is well suited to</span>
<span class="sd">    data with anisotropic smoothness.</span>

<span class="sd">    In [2]_ it was demonstrated that the fully separable transform performs at</span>
<span class="sd">    least as well as the DWT for image compression. Computation time is a</span>
<span class="sd">    factor 2 larger than that for the DWT.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    fswavedecn : inverse of fswaverecn</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] PH Westerink. Subband Coding of Images. Ph.D. dissertation, Dept.</span>
<span class="sd">       Elect. Eng., Inf. Theory Group, Delft Univ. Technol., Delft, The</span>
<span class="sd">       Netherlands, 1989.  (see Section 2.3)</span>
<span class="sd">       http://resolver.tudelft.nl/uuid:a4d195c3-1f89-4d66-913d-db9af0969509</span>

<span class="sd">    .. [2] CP Rosiene and TQ Nguyen. Tensor-product wavelet vs. Mallat</span>
<span class="sd">       decomposition: A comparative analysis, in Proc. IEEE Int. Symp.</span>
<span class="sd">       Circuits and Systems, Orlando, FL, Jun. 1999, pp. 431-434.</span>

<span class="sd">    .. [3] V Velisavljevic, B Beferull-Lozano, M Vetterli and PL Dragotti.</span>
<span class="sd">       Directionlets: Anisotropic Multidirectional Representation With</span>
<span class="sd">       Separable Filtering. IEEE Transactions on Image Processing, Vol. 15,</span>
<span class="sd">       No. 7, July 2006.</span>

<span class="sd">    .. [4] RA DeVore, SV Konyagin and VN Temlyakov. "Hyperbolic wavelet</span>
<span class="sd">       approximation," Constr. Approx. 14 (1998), 1-26.</span>
<span class="sd">    """</span>
    <span class="n">coeffs_arr</span> <span class="o">=</span> <span class="n">fswavedecn_result</span><span class="o">.</span><span class="n">coeffs</span>
    <span class="n">coeff_slices</span> <span class="o">=</span> <span class="n">fswavedecn_result</span><span class="o">.</span><span class="n">coeff_slices</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="n">fswavedecn_result</span><span class="o">.</span><span class="n">axes</span>
    <span class="n">modes</span> <span class="o">=</span> <span class="n">fswavedecn_result</span><span class="o">.</span><span class="n">modes</span>
    <span class="n">wavelets</span> <span class="o">=</span> <span class="n">fswavedecn_result</span><span class="o">.</span><span class="n">wavelets</span>

    <span class="n">_check_fswavedecn_axes</span><span class="p">(</span><span class="n">coeffs_arr</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">coeff_slices</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"dimension mismatch"</span><span class="p">)</span>

    <span class="n">arr</span> <span class="o">=</span> <span class="n">coeffs_arr</span>
    <span class="n">csl</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> <span class="p">]</span> <span class="o">*</span> <span class="n">arr</span><span class="o">.</span><span class="n">ndim</span>
    <span class="c1"># for ax_count, (ax, wav, mode) in reversed(</span>
    <span class="c1">#         list(enumerate(zip(axes, wavelets, modes)))):</span>
    <span class="k">for</span> <span class="n">ax_count</span><span class="p">,</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">wav</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">wavelets</span><span class="p">,</span> <span class="n">modes</span><span class="p">)):</span>
        <span class="n">coeffs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">sl</span> <span class="ow">in</span> <span class="n">coeff_slices</span><span class="p">[</span><span class="n">ax_count</span><span class="p">]:</span>
            <span class="n">csl</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span> <span class="o">=</span> <span class="n">sl</span>
            <span class="n">coeffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">csl</span><span class="p">)])</span>
        <span class="n">csl</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="n">waverec</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">wav</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">arr</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.idwt">
<code class="highlight language-python"><span class="n">idwt</span><span class="p">(</span><span class="n">cA</span><span class="p">,</span> <span class="n">cD</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>idwt(cA, cD, wavelet, mode='symmetric', axis=-1)</p>
<p>Single level Inverse Discrete Wavelet Transform.</p>
<h4 id="pywt.idwt--parameters">Parameters</h4>
<p>cA : array_like or None
    Approximation coefficients.  If None, will be set to array of zeros
    with same shape as <code>cD</code>.
cD : array_like or None
    Detail coefficients.  If None, will be set to array of zeros
    with same shape as <code>cA</code>.
wavelet : Wavelet object or name
    Wavelet to use
mode : str, optional (default: 'symmetric')
    Signal extension mode, see :ref:<code>Modes &lt;ref-modes&gt;</code>.
axis: int, optional
    Axis over which to compute the inverse DWT. If not given, the
    last axis is used.</p>
<h4 id="pywt.idwt--returns">Returns</h4>
<p>rec: array_like
    Single level reconstruction of signal from given coefficients.</p>
<h4 id="pywt.idwt--examples">Examples</h4>
<blockquote>
<blockquote>
<blockquote>
<p>import pywt
(cA, cD) = pywt.dwt([1,2,3,4,5,6], 'db2', 'smooth')
pywt.idwt(cA, cD, 'db2', 'smooth')
array([ 1.,  2.,  3.,  4.,  5.,  6.])</p>
</blockquote>
</blockquote>
</blockquote>
<p>One of the neat features of <code>idwt</code> is that one of the <code>cA</code> and <code>cD</code>
arguments can be set to None.  In that situation the reconstruction will be
performed using only the other one.  Mathematically speaking, this is
equivalent to passing a zero-filled array as one of the arguments.</p>
<blockquote>
<blockquote>
<blockquote>
<p>(cA, cD) = pywt.dwt([1,2,3,4,5,6], 'db2', 'smooth')
A = pywt.idwt(cA, None, 'db2', 'smooth')
D = pywt.idwt(None, cD, 'db2', 'smooth')
A + D
array([ 1.,  2.,  3.,  4.,  5.,  6.])</p>
</blockquote>
</blockquote>
</blockquote>
<details class="quote">
<summary>Source code in <code>pywt/_dwt.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">idwt</span><span class="p">(</span><span class="n">cA</span><span class="p">,</span> <span class="n">cD</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    idwt(cA, cD, wavelet, mode='symmetric', axis=-1)</span>

<span class="sd">    Single level Inverse Discrete Wavelet Transform.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    cA : array_like or None</span>
<span class="sd">        Approximation coefficients.  If None, will be set to array of zeros</span>
<span class="sd">        with same shape as ``cD``.</span>
<span class="sd">    cD : array_like or None</span>
<span class="sd">        Detail coefficients.  If None, will be set to array of zeros</span>
<span class="sd">        with same shape as ``cA``.</span>
<span class="sd">    wavelet : Wavelet object or name</span>
<span class="sd">        Wavelet to use</span>
<span class="sd">    mode : str, optional (default: 'symmetric')</span>
<span class="sd">        Signal extension mode, see :ref:`Modes &lt;ref-modes&gt;`.</span>
<span class="sd">    axis: int, optional</span>
<span class="sd">        Axis over which to compute the inverse DWT. If not given, the</span>
<span class="sd">        last axis is used.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    rec: array_like</span>
<span class="sd">        Single level reconstruction of signal from given coefficients.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import pywt</span>
<span class="sd">    &gt;&gt;&gt; (cA, cD) = pywt.dwt([1,2,3,4,5,6], 'db2', 'smooth')</span>
<span class="sd">    &gt;&gt;&gt; pywt.idwt(cA, cD, 'db2', 'smooth')</span>
<span class="sd">    array([ 1.,  2.,  3.,  4.,  5.,  6.])</span>

<span class="sd">    One of the neat features of ``idwt`` is that one of the ``cA`` and ``cD``</span>
<span class="sd">    arguments can be set to None.  In that situation the reconstruction will be</span>
<span class="sd">    performed using only the other one.  Mathematically speaking, this is</span>
<span class="sd">    equivalent to passing a zero-filled array as one of the arguments.</span>

<span class="sd">    &gt;&gt;&gt; (cA, cD) = pywt.dwt([1,2,3,4,5,6], 'db2', 'smooth')</span>
<span class="sd">    &gt;&gt;&gt; A = pywt.idwt(cA, None, 'db2', 'smooth')</span>
<span class="sd">    &gt;&gt;&gt; D = pywt.idwt(None, cD, 'db2', 'smooth')</span>
<span class="sd">    &gt;&gt;&gt; A + D</span>
<span class="sd">    array([ 1.,  2.,  3.,  4.,  5.,  6.])</span>

<span class="sd">    """</span>
    <span class="c1"># TODO: Lots of possible allocations to eliminate (zeros_like, asarray(rec))</span>
    <span class="c1"># accept array_like input; make a copy to ensure a contiguous array</span>

    <span class="k">if</span> <span class="n">cA</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">cD</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"At least one coefficient parameter must be "</span>
                         <span class="s2">"specified."</span><span class="p">)</span>

    <span class="c1"># for complex inputs: compute real and imaginary separately then combine</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_have_c99_complex</span> <span class="ow">and</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">iscomplexobj</span><span class="p">(</span><span class="n">cA</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">iscomplexobj</span><span class="p">(</span><span class="n">cD</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">cA</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">cD</span><span class="p">)</span>
            <span class="n">cA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">cD</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">cD</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">cA</span><span class="p">)</span>
            <span class="n">cD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">cA</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">idwt</span><span class="p">(</span><span class="n">cA</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">cD</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span> <span class="o">+</span>
                <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">idwt</span><span class="p">(</span><span class="n">cA</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">cD</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">axis</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">cA</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">_check_dtype</span><span class="p">(</span><span class="n">cA</span><span class="p">)</span>
        <span class="n">cA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">cA</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">'C'</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cD</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">_check_dtype</span><span class="p">(</span><span class="n">cD</span><span class="p">)</span>
        <span class="n">cD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">cD</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">'C'</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">cA</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">cD</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">cA</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">cD</span><span class="o">.</span><span class="n">dtype</span><span class="p">:</span>
            <span class="c1"># need to upcast to common type</span>
            <span class="k">if</span> <span class="n">cA</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">'c'</span> <span class="ow">or</span> <span class="n">cD</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">'c'</span><span class="p">:</span>
                <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">complex128</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span>
            <span class="n">cA</span> <span class="o">=</span> <span class="n">cA</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">cD</span> <span class="o">=</span> <span class="n">cD</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">cA</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">cD</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">cD</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">cA</span><span class="p">)</span>

    <span class="c1"># cA and cD should be same dimension by here</span>
    <span class="n">ndim</span> <span class="o">=</span> <span class="n">cA</span><span class="o">.</span><span class="n">ndim</span>

    <span class="n">mode</span> <span class="o">=</span> <span class="n">Modes</span><span class="o">.</span><span class="n">from_object</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
    <span class="n">wavelet</span> <span class="o">=</span> <span class="n">_as_wavelet</span><span class="p">(</span><span class="n">wavelet</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">axis</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">axis</span> <span class="o">+</span> <span class="n">ndim</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">axis</span> <span class="o">&lt;</span> <span class="n">ndim</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">AxisError</span><span class="p">(</span><span class="s2">"Axis greater than coefficient dimensions"</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">rec</span> <span class="o">=</span> <span class="n">idwt_single</span><span class="p">(</span><span class="n">cA</span><span class="p">,</span> <span class="n">cD</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rec</span> <span class="o">=</span> <span class="n">idwt_axis</span><span class="p">(</span><span class="n">cA</span><span class="p">,</span> <span class="n">cD</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">rec</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.idwt2">
<code class="highlight language-python"><span class="n">idwt2</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span></code>
</h2>
<div class="doc doc-contents">
<p>2-D Inverse Discrete Wavelet Transform.</p>
<p>Reconstructs data from coefficient arrays.</p>
<h4 id="pywt.idwt2--parameters">Parameters</h4>
<p>coeffs : tuple
    (cA, (cH, cV, cD)) A tuple with approximation coefficients and three
    details coefficients 2D arrays like from <code>dwt2</code>.  If any of these
    components are set to <code>None</code>, it will be treated as zeros.
wavelet : Wavelet object or name string, or 2-tuple of wavelets
    Wavelet to use.  This can also be a tuple containing a wavelet to
    apply along each axis in <code>axes</code>.
mode : str or 2-tuple of strings, optional
    Signal extension mode, see :ref:<code>Modes &lt;ref-modes&gt;</code>. This can
    also be a tuple of modes specifying the mode to use on each axis in
    <code>axes</code>.
axes : 2-tuple of ints, optional
    Axes over which to compute the IDWT. Repeated elements mean the IDWT
    will be performed multiple times along these axes.</p>
<h4 id="pywt.idwt2--examples">Examples</h4>
<blockquote>
<blockquote>
<blockquote>
<p>import numpy as np
import pywt
data = np.array([[1,2], [3,4]], dtype=np.float64)
coeffs = pywt.dwt2(data, 'haar')
pywt.idwt2(coeffs, 'haar')
array([[ 1.,  2.],
       [ 3.,  4.]])</p>
</blockquote>
</blockquote>
</blockquote>
<details class="quote">
<summary>Source code in <code>pywt/_multidim.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">idwt2</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    2-D Inverse Discrete Wavelet Transform.</span>

<span class="sd">    Reconstructs data from coefficient arrays.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    coeffs : tuple</span>
<span class="sd">        (cA, (cH, cV, cD)) A tuple with approximation coefficients and three</span>
<span class="sd">        details coefficients 2D arrays like from ``dwt2``.  If any of these</span>
<span class="sd">        components are set to ``None``, it will be treated as zeros.</span>
<span class="sd">    wavelet : Wavelet object or name string, or 2-tuple of wavelets</span>
<span class="sd">        Wavelet to use.  This can also be a tuple containing a wavelet to</span>
<span class="sd">        apply along each axis in ``axes``.</span>
<span class="sd">    mode : str or 2-tuple of strings, optional</span>
<span class="sd">        Signal extension mode, see :ref:`Modes &lt;ref-modes&gt;`. This can</span>
<span class="sd">        also be a tuple of modes specifying the mode to use on each axis in</span>
<span class="sd">        ``axes``.</span>
<span class="sd">    axes : 2-tuple of ints, optional</span>
<span class="sd">        Axes over which to compute the IDWT. Repeated elements mean the IDWT</span>
<span class="sd">        will be performed multiple times along these axes.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; import pywt</span>
<span class="sd">    &gt;&gt;&gt; data = np.array([[1,2], [3,4]], dtype=np.float64)</span>
<span class="sd">    &gt;&gt;&gt; coeffs = pywt.dwt2(data, 'haar')</span>
<span class="sd">    &gt;&gt;&gt; pywt.idwt2(coeffs, 'haar')</span>
<span class="sd">    array([[ 1.,  2.],</span>
<span class="sd">           [ 3.,  4.]])</span>

<span class="sd">    """</span>
    <span class="c1"># L -low-pass data, H - high-pass data</span>
    <span class="n">LL</span><span class="p">,</span> <span class="p">(</span><span class="n">HL</span><span class="p">,</span> <span class="n">LH</span><span class="p">,</span> <span class="n">HH</span><span class="p">)</span> <span class="o">=</span> <span class="n">coeffs</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Expected 2 axes"</span><span class="p">)</span>

    <span class="n">coeffs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'aa'</span><span class="p">:</span> <span class="n">LL</span><span class="p">,</span> <span class="s1">'da'</span><span class="p">:</span> <span class="n">HL</span><span class="p">,</span> <span class="s1">'ad'</span><span class="p">:</span> <span class="n">LH</span><span class="p">,</span> <span class="s1">'dd'</span><span class="p">:</span> <span class="n">HH</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">idwtn</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.idwtn">
<code class="highlight language-python"><span class="n">idwtn</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Single-level n-dimensional Inverse Discrete Wavelet Transform.</p>
<h4 id="pywt.idwtn--parameters">Parameters</h4>
<p>coeffs: dict
    Dictionary as in output of <code>dwtn</code>. Missing or <code>None</code> items
    will be treated as zeros.
wavelet : Wavelet object or name string, or tuple of wavelets
    Wavelet to use.  This can also be a tuple containing a wavelet to
    apply along each axis in <code>axes</code>.
mode : str or list of string, optional
    Signal extension mode used in the decomposition,
    see :ref:<code>Modes &lt;ref-modes&gt;</code>. This can also be a tuple of modes
    specifying the mode to use on each axis in <code>axes</code>.
axes : sequence of ints, optional
    Axes over which to compute the IDWT. Repeated elements mean the IDWT
    will be performed multiple times along these axes. A value of <code>None</code>
    (the default) selects all axes.</p>
<div class="highlight"><pre><span></span><code>For the most accurate reconstruction, the axes should be provided in
the same order as they were provided to ``dwtn``.
</code></pre></div>
<h4 id="pywt.idwtn--returns">Returns</h4>
<p>data: ndarray
    Original signal reconstructed from input data.</p>
<details class="quote">
<summary>Source code in <code>pywt/_multidim.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">idwtn</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Single-level n-dimensional Inverse Discrete Wavelet Transform.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    coeffs: dict</span>
<span class="sd">        Dictionary as in output of ``dwtn``. Missing or ``None`` items</span>
<span class="sd">        will be treated as zeros.</span>
<span class="sd">    wavelet : Wavelet object or name string, or tuple of wavelets</span>
<span class="sd">        Wavelet to use.  This can also be a tuple containing a wavelet to</span>
<span class="sd">        apply along each axis in ``axes``.</span>
<span class="sd">    mode : str or list of string, optional</span>
<span class="sd">        Signal extension mode used in the decomposition,</span>
<span class="sd">        see :ref:`Modes &lt;ref-modes&gt;`. This can also be a tuple of modes</span>
<span class="sd">        specifying the mode to use on each axis in ``axes``.</span>
<span class="sd">    axes : sequence of ints, optional</span>
<span class="sd">        Axes over which to compute the IDWT. Repeated elements mean the IDWT</span>
<span class="sd">        will be performed multiple times along these axes. A value of ``None``</span>
<span class="sd">        (the default) selects all axes.</span>

<span class="sd">        For the most accurate reconstruction, the axes should be provided in</span>
<span class="sd">        the same order as they were provided to ``dwtn``.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    data: ndarray</span>
<span class="sd">        Original signal reconstructed from input data.</span>

<span class="sd">    """</span>

    <span class="c1"># drop the keys corresponding to value = None</span>
    <span class="n">coeffs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">}</span>

    <span class="c1"># drop the keys corresponding to value = None</span>
    <span class="n">coeffs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">}</span>

    <span class="c1"># Raise error for invalid key combinations</span>
    <span class="n">coeffs</span> <span class="o">=</span> <span class="n">_fix_coeffs</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">_have_c99_complex</span> <span class="ow">and</span>
            <span class="nb">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">iscomplexobj</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="o">.</span><span class="n">values</span><span class="p">())):</span>
        <span class="n">real_coeffs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">real</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="n">imag_coeffs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">imag</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">idwtn</span><span class="p">(</span><span class="n">real_coeffs</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span> <span class="o">+</span>
                <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">idwtn</span><span class="p">(</span><span class="n">imag_coeffs</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">axes</span><span class="p">))</span>

    <span class="c1"># key length matches the number of axes transformed</span>
    <span class="n">ndim_transform</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">coeff_shapes</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                        <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">==</span> <span class="n">ndim_transform</span><span class="p">)</span>
        <span class="n">coeff_shape</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">coeff_shapes</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"`coeffs` must contain at least one non-null wavelet "</span>
                         <span class="s2">"band"</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">s</span> <span class="o">!=</span> <span class="n">coeff_shape</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">coeff_shapes</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"`coeffs` must all be of equal size (or None)"</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndim_transform</span><span class="p">)</span>
        <span class="n">ndim</span> <span class="o">=</span> <span class="n">ndim_transform</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ndim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">coeff_shape</span><span class="p">)</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="o">+</span> <span class="n">ndim</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">]</span>

    <span class="n">modes</span> <span class="o">=</span> <span class="n">_modes_per_axis</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
    <span class="n">wavelets</span> <span class="o">=</span> <span class="n">_wavelets_per_axis</span><span class="p">(</span><span class="n">wavelet</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">key_length</span><span class="p">,</span> <span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">wav</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span>
            <span class="nb">list</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">wavelets</span><span class="p">,</span> <span class="n">modes</span><span class="p">)))):</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">axis</span> <span class="o">&gt;=</span> <span class="n">ndim</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AxisError</span><span class="p">(</span><span class="s2">"Axis greater than data dimensions"</span><span class="p">)</span>

        <span class="n">new_coeffs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">new_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">coef</span><span class="p">)</span> <span class="k">for</span> <span class="n">coef</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="s1">'ad'</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="n">key_length</span><span class="p">)]</span>

        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">new_keys</span><span class="p">:</span>
            <span class="n">L</span> <span class="o">=</span> <span class="n">coeffs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span> <span class="o">+</span> <span class="s1">'a'</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">H</span> <span class="o">=</span> <span class="n">coeffs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span> <span class="o">+</span> <span class="s1">'d'</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">L</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">H</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">L</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">H</span><span class="o">.</span><span class="n">dtype</span><span class="p">:</span>
                    <span class="c1"># upcast to a common dtype (float64 or complex128)</span>
                    <span class="k">if</span> <span class="n">L</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">'c'</span> <span class="ow">or</span> <span class="n">H</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">'c'</span><span class="p">:</span>
                        <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">complex128</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span>
                    <span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
                    <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">new_coeffs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">idwt_axis</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">wav</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
        <span class="n">coeffs</span> <span class="o">=</span> <span class="n">new_coeffs</span>

    <span class="k">return</span> <span class="n">coeffs</span><span class="p">[</span><span class="s1">''</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.imra">
<code class="highlight language-python"><span class="n">imra</span><span class="p">(</span><span class="n">mra_coeffs</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Inverse 1D multiresolution analysis via summation.</p>
<h4 id="pywt.imra--parameters">Parameters</h4>
<p>mra_coeffs : list of ndarray
    Multiresolution analysis coefficients as returned by <code>mra</code>.</p>
<h4 id="pywt.imra--returns">Returns</h4>
<p>rec : ndarray
    The reconstructed signal.</p>
<h4 id="pywt.imra--see-also">See Also</h4>
<p>mra</p>
<h4 id="pywt.imra--references">References</h4>
<p>.. [1] Donald B. Percival and Harold O. Mofjeld. Analysis of Subtidal
    Coastal Sea Level Fluctuations Using Wavelets. Journal of the American
    Statistical Association Vol. 92, No. 439 (Sep., 1997), pp. 868-880.
    https://doi.org/10.2307/2965551</p>
<details class="quote">
<summary>Source code in <code>pywt/_mra.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">imra</span><span class="p">(</span><span class="n">mra_coeffs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Inverse 1D multiresolution analysis via summation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mra_coeffs : list of ndarray</span>
<span class="sd">        Multiresolution analysis coefficients as returned by `mra`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    rec : ndarray</span>
<span class="sd">        The reconstructed signal.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    mra</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Donald B. Percival and Harold O. Mofjeld. Analysis of Subtidal</span>
<span class="sd">        Coastal Sea Level Fluctuations Using Wavelets. Journal of the American</span>
<span class="sd">        Statistical Association Vol. 92, No. 439 (Sep., 1997), pp. 868-880.</span>
<span class="sd">        https://doi.org/10.2307/2965551</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="n">mra_coeffs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.imra2">
<code class="highlight language-python"><span class="n">imra2</span><span class="p">(</span><span class="n">mra_coeffs</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Inverse 2D multiresolution analysis via summation.</p>
<h4 id="pywt.imra2--parameters">Parameters</h4>
<p>mra_coeffs : list
    Multiresolution analysis coefficients as returned by <code>mra2</code>.</p>
<h4 id="pywt.imra2--returns">Returns</h4>
<p>rec : ndarray
    The reconstructed signal.</p>
<h4 id="pywt.imra2--see-also">See Also</h4>
<p>mra2</p>
<h4 id="pywt.imra2--references">References</h4>
<p>.. [1] Donald B. Percival and Harold O. Mofjeld. Analysis of Subtidal
    Coastal Sea Level Fluctuations Using Wavelets. Journal of the American
    Statistical Association Vol. 92, No. 439 (Sep., 1997), pp. 868-880.
    https://doi.org/10.2307/2965551</p>
<details class="quote">
<summary>Source code in <code>pywt/_mra.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">imra2</span><span class="p">(</span><span class="n">mra_coeffs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Inverse 2D multiresolution analysis via summation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mra_coeffs : list</span>
<span class="sd">        Multiresolution analysis coefficients as returned by `mra2`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    rec : ndarray</span>
<span class="sd">        The reconstructed signal.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    mra2</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Donald B. Percival and Harold O. Mofjeld. Analysis of Subtidal</span>
<span class="sd">        Coastal Sea Level Fluctuations Using Wavelets. Journal of the American</span>
<span class="sd">        Statistical Association Vol. 92, No. 439 (Sep., 1997), pp. 868-880.</span>
<span class="sd">        https://doi.org/10.2307/2965551</span>
<span class="sd">    """</span>
    <span class="n">rec</span> <span class="o">=</span> <span class="n">mra_coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">mra_coeffs</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">rec</span> <span class="o">+=</span> <span class="n">mra_coeffs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">rec</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.imran">
<code class="highlight language-python"><span class="n">imran</span><span class="p">(</span><span class="n">mra_coeffs</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Inverse nD multiresolution analysis via summation.</p>
<h4 id="pywt.imran--parameters">Parameters</h4>
<p>mra_coeffs : list
    Multiresolution analysis coefficients as returned by <code>mra2</code>.</p>
<h4 id="pywt.imran--returns">Returns</h4>
<p>rec : ndarray
    The reconstructed signal.</p>
<h4 id="pywt.imran--see-also">See Also</h4>
<p>mran</p>
<h4 id="pywt.imran--references">References</h4>
<p>.. [1] Donald B. Percival and Harold O. Mofjeld. Analysis of Subtidal
    Coastal Sea Level Fluctuations Using Wavelets. Journal of the American
    Statistical Association Vol. 92, No. 439 (Sep., 1997), pp. 868-880.
    https://doi.org/10.2307/2965551</p>
<details class="quote">
<summary>Source code in <code>pywt/_mra.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">imran</span><span class="p">(</span><span class="n">mra_coeffs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Inverse nD multiresolution analysis via summation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mra_coeffs : list</span>
<span class="sd">        Multiresolution analysis coefficients as returned by `mra2`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    rec : ndarray</span>
<span class="sd">        The reconstructed signal.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    mran</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Donald B. Percival and Harold O. Mofjeld. Analysis of Subtidal</span>
<span class="sd">        Coastal Sea Level Fluctuations Using Wavelets. Journal of the American</span>
<span class="sd">        Statistical Association Vol. 92, No. 439 (Sep., 1997), pp. 868-880.</span>
<span class="sd">        https://doi.org/10.2307/2965551</span>
<span class="sd">    """</span>
    <span class="n">rec</span> <span class="o">=</span> <span class="n">mra_coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">mra_coeffs</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">mra_coeffs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">rec</span> <span class="o">+=</span> <span class="n">v</span>
    <span class="k">return</span> <span class="n">rec</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.integrate_wavelet">
<code class="highlight language-python"><span class="n">integrate_wavelet</span><span class="p">(</span><span class="n">wavelet</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Integrate <code>psi</code> wavelet function from -Inf to x using the rectangle
integration method.</p>
<h4 id="pywt.integrate_wavelet--parameters">Parameters</h4>
<p>wavelet : Wavelet instance or str
    Wavelet to integrate.  If a string, should be the name of a wavelet.
precision : int, optional
    Precision that will be used for wavelet function
    approximation computed with the wavefun(level=precision)
    Wavelet's method (default: 8).</p>
<h4 id="pywt.integrate_wavelet--returns">Returns</h4>
<p>[int_psi, x] :
    for orthogonal wavelets
[int_psi_d, int_psi_r, x] :
    for other wavelets</p>
<h4 id="pywt.integrate_wavelet--examples">Examples</h4>
<blockquote>
<blockquote>
<blockquote>
<p>from pywt import Wavelet, integrate_wavelet
wavelet1 = Wavelet('db2')
[int_psi, x] = integrate_wavelet(wavelet1, precision=5)
wavelet2 = Wavelet('bior1.3')
[int_psi_d, int_psi_r, x] = integrate_wavelet(wavelet2, precision=5)</p>
</blockquote>
</blockquote>
</blockquote>
<details class="quote">
<summary>Source code in <code>pywt/_functions.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">integrate_wavelet</span><span class="p">(</span><span class="n">wavelet</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Integrate `psi` wavelet function from -Inf to x using the rectangle</span>
<span class="sd">    integration method.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavelet : Wavelet instance or str</span>
<span class="sd">        Wavelet to integrate.  If a string, should be the name of a wavelet.</span>
<span class="sd">    precision : int, optional</span>
<span class="sd">        Precision that will be used for wavelet function</span>
<span class="sd">        approximation computed with the wavefun(level=precision)</span>
<span class="sd">        Wavelet's method (default: 8).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    [int_psi, x] :</span>
<span class="sd">        for orthogonal wavelets</span>
<span class="sd">    [int_psi_d, int_psi_r, x] :</span>
<span class="sd">        for other wavelets</span>


<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from pywt import Wavelet, integrate_wavelet</span>
<span class="sd">    &gt;&gt;&gt; wavelet1 = Wavelet('db2')</span>
<span class="sd">    &gt;&gt;&gt; [int_psi, x] = integrate_wavelet(wavelet1, precision=5)</span>
<span class="sd">    &gt;&gt;&gt; wavelet2 = Wavelet('bior1.3')</span>
<span class="sd">    &gt;&gt;&gt; [int_psi_d, int_psi_r, x] = integrate_wavelet(wavelet2, precision=5)</span>

<span class="sd">    """</span>
    <span class="c1"># FIXME: this function should really use scipy.integrate.quad</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">wavelet</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"Integration of a general signal is deprecated "</span>
               <span class="s2">"and will be removed in a future version of pywt."</span><span class="p">)</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wavelet</span><span class="p">,</span> <span class="p">(</span><span class="n">Wavelet</span><span class="p">,</span> <span class="n">ContinuousWavelet</span><span class="p">)):</span>
        <span class="n">wavelet</span> <span class="o">=</span> <span class="n">DiscreteContinuousWavelet</span><span class="p">(</span><span class="n">wavelet</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">wavelet</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">psi</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">wavelet</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">wavelet</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">step</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">_integrate</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">step</span><span class="p">),</span> <span class="n">x</span>

    <span class="n">functions_approximations</span> <span class="o">=</span> <span class="n">wavelet</span><span class="o">.</span><span class="n">wavefun</span><span class="p">(</span><span class="n">precision</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">functions_approximations</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>      <span class="c1"># continuous wavelet</span>
        <span class="n">psi</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">functions_approximations</span>
        <span class="n">step</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">_integrate</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">step</span><span class="p">),</span> <span class="n">x</span>

    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">functions_approximations</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>    <span class="c1"># orthogonal wavelet</span>
        <span class="n">phi</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">functions_approximations</span>
        <span class="n">step</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">_integrate</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">step</span><span class="p">),</span> <span class="n">x</span>

    <span class="k">else</span><span class="p">:</span>                                       <span class="c1"># biorthogonal wavelet</span>
        <span class="n">phi_d</span><span class="p">,</span> <span class="n">psi_d</span><span class="p">,</span> <span class="n">phi_r</span><span class="p">,</span> <span class="n">psi_r</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">functions_approximations</span>
        <span class="n">step</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">_integrate</span><span class="p">(</span><span class="n">psi_d</span><span class="p">,</span> <span class="n">step</span><span class="p">),</span> <span class="n">_integrate</span><span class="p">(</span><span class="n">psi_r</span><span class="p">,</span> <span class="n">step</span><span class="p">),</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.iswt">
<code class="highlight language-python"><span class="n">iswt</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Multilevel 1D inverse discrete stationary wavelet transform.</p>
<h4 id="pywt.iswt--parameters">Parameters</h4>
<p>coeffs : array_like
    Coefficients list of tuples::</p>
<div class="highlight"><pre><span></span><code>    [(cAn, cDn), ..., (cA2, cD2), (cA1, cD1)]

where cA is approximation, cD is details.  Index 1 corresponds to
``start_level`` from ``pywt.swt``.
</code></pre></div>
<p>wavelet : Wavelet object or name string
    Wavelet to use
norm : bool, optional
    Controls the normalization used by the inverse transform. This must
    be set equal to the value that was used by <code>pywt.swt</code> to preserve the
    energy of a round-trip transform.</p>
<h4 id="pywt.iswt--returns">Returns</h4>
<p>1D array of reconstructed data.</p>
<h4 id="pywt.iswt--examples">Examples</h4>
<blockquote>
<blockquote>
<blockquote>
<p>import pywt
coeffs = pywt.swt([1,2,3,4,5,6,7,8], 'db2', level=2)
pywt.iswt(coeffs, 'db2')
array([ 1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.])</p>
</blockquote>
</blockquote>
</blockquote>
<details class="quote">
<summary>Source code in <code>pywt/_swt.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">iswt</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Multilevel 1D inverse discrete stationary wavelet transform.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    coeffs : array_like</span>
<span class="sd">        Coefficients list of tuples::</span>

<span class="sd">            [(cAn, cDn), ..., (cA2, cD2), (cA1, cD1)]</span>

<span class="sd">        where cA is approximation, cD is details.  Index 1 corresponds to</span>
<span class="sd">        ``start_level`` from ``pywt.swt``.</span>
<span class="sd">    wavelet : Wavelet object or name string</span>
<span class="sd">        Wavelet to use</span>
<span class="sd">    norm : bool, optional</span>
<span class="sd">        Controls the normalization used by the inverse transform. This must</span>
<span class="sd">        be set equal to the value that was used by ``pywt.swt`` to preserve the</span>
<span class="sd">        energy of a round-trip transform.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    1D array of reconstructed data.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import pywt</span>
<span class="sd">    &gt;&gt;&gt; coeffs = pywt.swt([1,2,3,4,5,6,7,8], 'db2', level=2)</span>
<span class="sd">    &gt;&gt;&gt; pywt.iswt(coeffs, 'db2')</span>
<span class="sd">    array([ 1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.])</span>
<span class="sd">    """</span>
    <span class="c1"># copy to avoid modification of input data</span>
    <span class="c1"># If swt was called with trim_approx=False, first element is a tuple</span>
    <span class="n">trim_approx</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">))</span>
    <span class="n">cA</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">trim_approx</span> <span class="k">else</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">cA</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># convert to swtn coefficient format and call iswtn</span>
        <span class="k">if</span> <span class="n">trim_approx</span><span class="p">:</span>
            <span class="n">coeffs_nd</span> <span class="o">=</span> <span class="p">[</span><span class="n">cA</span><span class="p">]</span> <span class="o">+</span> <span class="p">[{</span><span class="s1">'d'</span><span class="p">:</span> <span class="n">d</span><span class="p">}</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">coeffs_nd</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">'a'</span><span class="p">:</span> <span class="n">a</span><span class="p">,</span> <span class="s1">'d'</span><span class="p">:</span> <span class="n">d</span><span class="p">}</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">iswtn</span><span class="p">(</span><span class="n">coeffs_nd</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="n">axis</span><span class="p">,),</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">axis</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">axis</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">AxisError</span><span class="p">(</span><span class="s2">"Axis greater than data dimensions"</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_have_c99_complex</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">iscomplexobj</span><span class="p">(</span><span class="n">cA</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">trim_approx</span><span class="p">:</span>
            <span class="n">coeffs_real</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">real</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">]</span>
            <span class="n">coeffs_imag</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">imag</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">coeffs_real</span> <span class="o">=</span> <span class="p">[(</span><span class="n">ca</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">cd</span><span class="o">.</span><span class="n">real</span><span class="p">)</span> <span class="k">for</span> <span class="n">ca</span><span class="p">,</span> <span class="n">cd</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">]</span>
            <span class="n">coeffs_imag</span> <span class="o">=</span> <span class="p">[(</span><span class="n">ca</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">cd</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span> <span class="k">for</span> <span class="n">ca</span><span class="p">,</span> <span class="n">cd</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">]</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"wavelet"</span><span class="p">:</span> <span class="n">wavelet</span><span class="p">,</span> <span class="s2">"norm"</span><span class="p">:</span> <span class="n">norm</span><span class="p">}</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">iswt</span><span class="p">(</span><span class="n">coeffs_real</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">iswt</span><span class="p">(</span><span class="n">coeffs_imag</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">trim_approx</span><span class="p">:</span>
        <span class="n">coeffs</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="k">if</span> <span class="n">cA</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"iswt only supports 1D data"</span><span class="p">)</span>

    <span class="n">dt</span> <span class="o">=</span> <span class="n">_check_dtype</span><span class="p">(</span><span class="n">cA</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cA</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># num_levels, equivalent to the decomposition level, n</span>
    <span class="n">num_levels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span>
    <span class="n">wavelet</span> <span class="o">=</span> <span class="n">_as_wavelet</span><span class="p">(</span><span class="n">wavelet</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">norm</span><span class="p">:</span>
        <span class="n">wavelet</span> <span class="o">=</span> <span class="n">_rescale_wavelet_filterbank</span><span class="p">(</span><span class="n">wavelet</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">mode</span> <span class="o">=</span> <span class="n">Modes</span><span class="o">.</span><span class="n">from_object</span><span class="p">(</span><span class="s1">'periodization'</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_levels</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">step_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">step_size</span>
        <span class="k">if</span> <span class="n">trim_approx</span><span class="p">:</span>
            <span class="n">cD</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="o">-</span><span class="n">j</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">cD</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="o">-</span><span class="n">j</span><span class="p">]</span>
        <span class="n">cD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">cD</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">_check_dtype</span><span class="p">(</span><span class="n">cD</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">cD</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">output</span><span class="o">.</span><span class="n">dtype</span><span class="p">:</span>
            <span class="c1"># upcast to a common dtype (float64 or complex128)</span>
            <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">'c'</span> <span class="ow">or</span> <span class="n">cD</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">'c'</span><span class="p">:</span>
                <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">complex128</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">cD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">cD</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">first</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">last_index</span><span class="p">):</span>  <span class="c1"># 0 to last_index - 1</span>

            <span class="c1"># Getting the indices that we will transform</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cD</span><span class="p">),</span> <span class="n">step_size</span><span class="p">)</span>

            <span class="c1"># select the even indices</span>
            <span class="n">even_indices</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span>
            <span class="c1"># select the odd indices</span>
            <span class="n">odd_indices</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span>

            <span class="c1"># perform the inverse dwt on the selected indices,</span>
            <span class="c1"># making sure to use periodic boundary conditions</span>
            <span class="c1"># Note:  indexing with an array of ints returns a contiguous</span>
            <span class="c1">#        copy as required by idwt_single.</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="n">idwt_single</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="n">even_indices</span><span class="p">],</span>
                             <span class="n">cD</span><span class="p">[</span><span class="n">even_indices</span><span class="p">],</span>
                             <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
            <span class="n">x2</span> <span class="o">=</span> <span class="n">idwt_single</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="n">odd_indices</span><span class="p">],</span>
                             <span class="n">cD</span><span class="p">[</span><span class="n">odd_indices</span><span class="p">],</span>
                             <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>

            <span class="c1"># perform a circular shift right</span>
            <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

            <span class="c1"># average and insert into the correct indices</span>
            <span class="n">output</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span> <span class="o">+</span> <span class="n">x2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>

    <span class="k">return</span> <span class="n">output</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.iswt2">
<code class="highlight language-python"><span class="n">iswt2</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span></code>
</h2>
<div class="doc doc-contents">
<p>Multilevel 2D inverse discrete stationary wavelet transform.</p>
<h4 id="pywt.iswt2--parameters">Parameters</h4>
<p>coeffs : list
    Approximation and details coefficients::</p>
<div class="highlight"><pre><span></span><code>    [
        (cA_n,
            (cH_n, cV_n, cD_n)
        ),
        ...,
        (cA_2,
            (cH_2, cV_2, cD_2)
        ),
        (cA_1,
            (cH_1, cV_1, cD_1)
        )
    ]

where cA is approximation, cH is horizontal details, cV is
vertical details, cD is diagonal details and n is the number of
levels.  Index 1 corresponds to ``start_level`` from ``pywt.swt2``.
</code></pre></div>
<p>wavelet : Wavelet object or name string, or 2-tuple of wavelets
    Wavelet to use.  This can also be a 2-tuple of wavelets to apply per
    axis.
norm : bool, optional
    Controls the normalization used by the inverse transform. This must
    be set equal to the value that was used by <code>pywt.swt2</code> to preserve
    the energy of a round-trip transform.</p>
<h4 id="pywt.iswt2--returns">Returns</h4>
<p>2D array of reconstructed data.</p>
<h4 id="pywt.iswt2--examples">Examples</h4>
<blockquote>
<blockquote>
<blockquote>
<p>import pywt
coeffs = pywt.swt2([[1,2,3,4],[5,6,7,8],
...                     [9,10,11,12],[13,14,15,16]],
...                    'db1', level=2)
pywt.iswt2(coeffs, 'db1')
array([[  1.,   2.,   3.,   4.],
       [  5.,   6.,   7.,   8.],
       [  9.,  10.,  11.,  12.],
       [ 13.,  14.,  15.,  16.]])</p>
</blockquote>
</blockquote>
</blockquote>
<details class="quote">
<summary>Source code in <code>pywt/_swt.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">iswt2</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Multilevel 2D inverse discrete stationary wavelet transform.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    coeffs : list</span>
<span class="sd">        Approximation and details coefficients::</span>

<span class="sd">            [</span>
<span class="sd">                (cA_n,</span>
<span class="sd">                    (cH_n, cV_n, cD_n)</span>
<span class="sd">                ),</span>
<span class="sd">                ...,</span>
<span class="sd">                (cA_2,</span>
<span class="sd">                    (cH_2, cV_2, cD_2)</span>
<span class="sd">                ),</span>
<span class="sd">                (cA_1,</span>
<span class="sd">                    (cH_1, cV_1, cD_1)</span>
<span class="sd">                )</span>
<span class="sd">            ]</span>

<span class="sd">        where cA is approximation, cH is horizontal details, cV is</span>
<span class="sd">        vertical details, cD is diagonal details and n is the number of</span>
<span class="sd">        levels.  Index 1 corresponds to ``start_level`` from ``pywt.swt2``.</span>
<span class="sd">    wavelet : Wavelet object or name string, or 2-tuple of wavelets</span>
<span class="sd">        Wavelet to use.  This can also be a 2-tuple of wavelets to apply per</span>
<span class="sd">        axis.</span>
<span class="sd">    norm : bool, optional</span>
<span class="sd">        Controls the normalization used by the inverse transform. This must</span>
<span class="sd">        be set equal to the value that was used by ``pywt.swt2`` to preserve</span>
<span class="sd">        the energy of a round-trip transform.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    2D array of reconstructed data.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import pywt</span>
<span class="sd">    &gt;&gt;&gt; coeffs = pywt.swt2([[1,2,3,4],[5,6,7,8],</span>
<span class="sd">    ...                     [9,10,11,12],[13,14,15,16]],</span>
<span class="sd">    ...                    'db1', level=2)</span>
<span class="sd">    &gt;&gt;&gt; pywt.iswt2(coeffs, 'db1')</span>
<span class="sd">    array([[  1.,   2.,   3.,   4.],</span>
<span class="sd">           [  5.,   6.,   7.,   8.],</span>
<span class="sd">           [  9.,  10.,  11.,  12.],</span>
<span class="sd">           [ 13.,  14.,  15.,  16.]])</span>

<span class="sd">    """</span>

    <span class="c1"># If swt was called with trim_approx=False, first element is a tuple</span>
    <span class="n">trim_approx</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">))</span>
    <span class="n">cA</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">trim_approx</span> <span class="k">else</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">cA</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">axes</span> <span class="o">!=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="c1"># convert to swtn coefficient format and call iswtn instead</span>
        <span class="k">if</span> <span class="n">trim_approx</span><span class="p">:</span>
            <span class="n">coeffs_nd</span> <span class="o">=</span> <span class="p">[</span><span class="n">cA</span><span class="p">]</span> <span class="o">+</span> <span class="p">[{</span><span class="s1">'da'</span><span class="p">:</span> <span class="n">h</span><span class="p">,</span> <span class="s1">'ad'</span><span class="p">:</span> <span class="n">v</span><span class="p">,</span> <span class="s1">'dd'</span><span class="p">:</span> <span class="n">d</span><span class="p">}</span>
                                <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">coeffs_nd</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">'aa'</span><span class="p">:</span> <span class="n">a</span><span class="p">,</span> <span class="s1">'da'</span><span class="p">:</span> <span class="n">h</span><span class="p">,</span> <span class="s1">'ad'</span><span class="p">:</span> <span class="n">v</span><span class="p">,</span> <span class="s1">'dd'</span><span class="p">:</span> <span class="n">d</span><span class="p">}</span>
                         <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">iswtn</span><span class="p">(</span><span class="n">coeffs_nd</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_have_c99_complex</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">iscomplexobj</span><span class="p">(</span><span class="n">cA</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">trim_approx</span><span class="p">:</span>
            <span class="n">coeffs_real</span> <span class="o">=</span> <span class="p">[</span><span class="n">cA</span><span class="o">.</span><span class="n">real</span><span class="p">]</span>
            <span class="n">coeffs_real</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">h</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">real</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
            <span class="n">coeffs_imag</span> <span class="o">=</span> <span class="p">[</span><span class="n">cA</span><span class="o">.</span><span class="n">imag</span><span class="p">]</span>
            <span class="n">coeffs_imag</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">h</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">coeffs_real</span> <span class="o">=</span> <span class="p">[(</span><span class="n">a</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">real</span><span class="p">))</span>
                            <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">]</span>
            <span class="n">coeffs_imag</span> <span class="o">=</span> <span class="p">[(</span><span class="n">a</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">imag</span><span class="p">))</span>
                            <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">]</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"wavelet"</span><span class="p">:</span> <span class="n">wavelet</span><span class="p">,</span> <span class="s2">"norm"</span><span class="p">:</span> <span class="n">norm</span><span class="p">}</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">iswt2</span><span class="p">(</span><span class="n">coeffs_real</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">iswt2</span><span class="p">(</span><span class="n">coeffs_imag</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">trim_approx</span><span class="p">:</span>
        <span class="n">coeffs</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="c1"># copy to avoid modification of input data</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">_check_dtype</span><span class="p">(</span><span class="n">cA</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cA</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">"iswt2 only supports 2D arrays.  see iswtn for a general "</span>
            <span class="s2">"n-dimensionsal ISWT"</span><span class="p">)</span>
    <span class="c1"># num_levels, equivalent to the decomposition level, n</span>
    <span class="n">num_levels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span>
    <span class="n">wavelets</span> <span class="o">=</span> <span class="n">_wavelets_per_axis</span><span class="p">(</span><span class="n">wavelet</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">norm</span><span class="p">:</span>
        <span class="n">wavelets</span> <span class="o">=</span> <span class="p">[</span><span class="n">_rescale_wavelet_filterbank</span><span class="p">(</span><span class="n">wav</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">wav</span> <span class="ow">in</span> <span class="n">wavelets</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_levels</span><span class="p">):</span>
        <span class="n">step_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">num_levels</span><span class="o">-</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">step_size</span>
        <span class="k">if</span> <span class="n">trim_approx</span><span class="p">:</span>
            <span class="p">(</span><span class="n">cH</span><span class="p">,</span> <span class="n">cV</span><span class="p">,</span> <span class="n">cD</span><span class="p">)</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="p">(</span><span class="n">cH</span><span class="p">,</span> <span class="n">cV</span><span class="p">,</span> <span class="n">cD</span><span class="p">)</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
        <span class="c1"># We are going to assume cH, cV, and cD are of equal size</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">cH</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">cV</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">cH</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">cD</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">"Mismatch in shape of intermediate coefficient arrays"</span><span class="p">)</span>

        <span class="c1"># make sure output shares the common dtype</span>
        <span class="c1"># (conversion of dtype for individual coeffs is handled within idwt2 )</span>
        <span class="n">common_dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">result_type</span><span class="p">(</span><span class="o">*</span><span class="p">(</span>
            <span class="p">[</span><span class="n">dt</span><span class="p">,</span> <span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">_check_dtype</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">[</span><span class="n">cH</span><span class="p">,</span> <span class="n">cV</span><span class="p">,</span> <span class="n">cD</span><span class="p">]]))</span>
        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">common_dtype</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">common_dtype</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">first_h</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">last_index</span><span class="p">):</span>  <span class="c1"># 0 to last_index - 1</span>
            <span class="k">for</span> <span class="n">first_w</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">last_index</span><span class="p">):</span>  <span class="c1"># 0 to last_index - 1</span>
                <span class="c1"># Getting the indices that we will transform</span>
                <span class="n">indices_h</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">first_h</span><span class="p">,</span> <span class="n">cH</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">step_size</span><span class="p">)</span>
                <span class="n">indices_w</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">first_w</span><span class="p">,</span> <span class="n">cH</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">step_size</span><span class="p">)</span>

                <span class="n">even_idx_h</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">first_h</span><span class="p">,</span> <span class="n">cH</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="o">*</span><span class="n">step_size</span><span class="p">)</span>
                <span class="n">even_idx_w</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">first_w</span><span class="p">,</span> <span class="n">cH</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="o">*</span><span class="n">step_size</span><span class="p">)</span>
                <span class="n">odd_idx_h</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">first_h</span> <span class="o">+</span> <span class="n">step_size</span><span class="p">,</span> <span class="n">cH</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="o">*</span><span class="n">step_size</span><span class="p">)</span>
                <span class="n">odd_idx_w</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">first_w</span> <span class="o">+</span> <span class="n">step_size</span><span class="p">,</span> <span class="n">cH</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="o">*</span><span class="n">step_size</span><span class="p">)</span>

                <span class="c1"># perform the inverse dwt on the selected indices,</span>
                <span class="c1"># making sure to use periodic boundary conditions</span>
                <span class="n">x1</span> <span class="o">=</span> <span class="n">idwt2</span><span class="p">((</span><span class="n">output</span><span class="p">[</span><span class="n">even_idx_h</span><span class="p">,</span> <span class="n">even_idx_w</span><span class="p">],</span>
                           <span class="p">(</span><span class="n">cH</span><span class="p">[</span><span class="n">even_idx_h</span><span class="p">,</span> <span class="n">even_idx_w</span><span class="p">],</span>
                            <span class="n">cV</span><span class="p">[</span><span class="n">even_idx_h</span><span class="p">,</span> <span class="n">even_idx_w</span><span class="p">],</span>
                            <span class="n">cD</span><span class="p">[</span><span class="n">even_idx_h</span><span class="p">,</span> <span class="n">even_idx_w</span><span class="p">])),</span>
                           <span class="n">wavelets</span><span class="p">,</span> <span class="s1">'periodization'</span><span class="p">)</span>
                <span class="n">x2</span> <span class="o">=</span> <span class="n">idwt2</span><span class="p">((</span><span class="n">output</span><span class="p">[</span><span class="n">even_idx_h</span><span class="p">,</span> <span class="n">odd_idx_w</span><span class="p">],</span>
                           <span class="p">(</span><span class="n">cH</span><span class="p">[</span><span class="n">even_idx_h</span><span class="p">,</span> <span class="n">odd_idx_w</span><span class="p">],</span>
                            <span class="n">cV</span><span class="p">[</span><span class="n">even_idx_h</span><span class="p">,</span> <span class="n">odd_idx_w</span><span class="p">],</span>
                            <span class="n">cD</span><span class="p">[</span><span class="n">even_idx_h</span><span class="p">,</span> <span class="n">odd_idx_w</span><span class="p">])),</span>
                           <span class="n">wavelets</span><span class="p">,</span> <span class="s1">'periodization'</span><span class="p">)</span>
                <span class="n">x3</span> <span class="o">=</span> <span class="n">idwt2</span><span class="p">((</span><span class="n">output</span><span class="p">[</span><span class="n">odd_idx_h</span><span class="p">,</span> <span class="n">even_idx_w</span><span class="p">],</span>
                           <span class="p">(</span><span class="n">cH</span><span class="p">[</span><span class="n">odd_idx_h</span><span class="p">,</span> <span class="n">even_idx_w</span><span class="p">],</span>
                            <span class="n">cV</span><span class="p">[</span><span class="n">odd_idx_h</span><span class="p">,</span> <span class="n">even_idx_w</span><span class="p">],</span>
                            <span class="n">cD</span><span class="p">[</span><span class="n">odd_idx_h</span><span class="p">,</span> <span class="n">even_idx_w</span><span class="p">])),</span>
                           <span class="n">wavelets</span><span class="p">,</span> <span class="s1">'periodization'</span><span class="p">)</span>
                <span class="n">x4</span> <span class="o">=</span> <span class="n">idwt2</span><span class="p">((</span><span class="n">output</span><span class="p">[</span><span class="n">odd_idx_h</span><span class="p">,</span> <span class="n">odd_idx_w</span><span class="p">],</span>
                           <span class="p">(</span><span class="n">cH</span><span class="p">[</span><span class="n">odd_idx_h</span><span class="p">,</span> <span class="n">odd_idx_w</span><span class="p">],</span>
                            <span class="n">cV</span><span class="p">[</span><span class="n">odd_idx_h</span><span class="p">,</span> <span class="n">odd_idx_w</span><span class="p">],</span>
                            <span class="n">cD</span><span class="p">[</span><span class="n">odd_idx_h</span><span class="p">,</span> <span class="n">odd_idx_w</span><span class="p">])),</span>
                           <span class="n">wavelets</span><span class="p">,</span> <span class="s1">'periodization'</span><span class="p">)</span>

                <span class="c1"># perform a circular shifts</span>
                <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">x3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">x3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">x4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">x4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">x4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">x4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">output</span><span class="p">[</span><span class="n">indices_h</span><span class="p">,</span> <span class="n">indices_w</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">x3</span> <span class="o">+</span> <span class="n">x4</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span>

    <span class="k">return</span> <span class="n">output</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.iswtn">
<code class="highlight language-python"><span class="n">iswtn</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Multilevel nD inverse discrete stationary wavelet transform.</p>
<h4 id="pywt.iswtn--parameters">Parameters</h4>
<p>coeffs : list
    [{coeffs_level_n}, ..., {coeffs_level_1}]: list of dict
wavelet : Wavelet object or name string, or tuple of wavelets
    Wavelet to use.  This can also be a tuple of wavelets to apply per
    axis in <code>axes</code>.
axes : sequence of ints, optional
    Axes over which to compute the inverse SWT. Axes may not be repeated.
    The default is <code>None</code>, which means transform all axes
    (<code>axes = range(data.ndim)</code>).
norm : bool, optional
    Controls the normalization used by the inverse transform. This must
    be set equal to the value that was used by <code>pywt.swtn</code> to preserve
    the energy of a round-trip transform.</p>
<h4 id="pywt.iswtn--returns">Returns</h4>
<p>nD array of reconstructed data.</p>
<h4 id="pywt.iswtn--examples">Examples</h4>
<blockquote>
<blockquote>
<blockquote>
<p>import pywt
coeffs = pywt.swtn([[1,2,3,4],[5,6,7,8],
...                     [9,10,11,12],[13,14,15,16]],
...                    'db1', level=2)
pywt.iswtn(coeffs, 'db1')
array([[  1.,   2.,   3.,   4.],
       [  5.,   6.,   7.,   8.],
       [  9.,  10.,  11.,  12.],
       [ 13.,  14.,  15.,  16.]])</p>
</blockquote>
</blockquote>
</blockquote>
<details class="quote">
<summary>Source code in <code>pywt/_swt.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">iswtn</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Multilevel nD inverse discrete stationary wavelet transform.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    coeffs : list</span>
<span class="sd">        [{coeffs_level_n}, ..., {coeffs_level_1}]: list of dict</span>
<span class="sd">    wavelet : Wavelet object or name string, or tuple of wavelets</span>
<span class="sd">        Wavelet to use.  This can also be a tuple of wavelets to apply per</span>
<span class="sd">        axis in ``axes``.</span>
<span class="sd">    axes : sequence of ints, optional</span>
<span class="sd">        Axes over which to compute the inverse SWT. Axes may not be repeated.</span>
<span class="sd">        The default is ``None``, which means transform all axes</span>
<span class="sd">        (``axes = range(data.ndim)``).</span>
<span class="sd">    norm : bool, optional</span>
<span class="sd">        Controls the normalization used by the inverse transform. This must</span>
<span class="sd">        be set equal to the value that was used by ``pywt.swtn`` to preserve</span>
<span class="sd">        the energy of a round-trip transform.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    nD array of reconstructed data.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import pywt</span>
<span class="sd">    &gt;&gt;&gt; coeffs = pywt.swtn([[1,2,3,4],[5,6,7,8],</span>
<span class="sd">    ...                     [9,10,11,12],[13,14,15,16]],</span>
<span class="sd">    ...                    'db1', level=2)</span>
<span class="sd">    &gt;&gt;&gt; pywt.iswtn(coeffs, 'db1')</span>
<span class="sd">    array([[  1.,   2.,   3.,   4.],</span>
<span class="sd">           [  5.,   6.,   7.,   8.],</span>
<span class="sd">           [  9.,  10.,  11.,  12.],</span>
<span class="sd">           [ 13.,  14.,  15.,  16.]])</span>

<span class="sd">    """</span>

    <span class="c1"># key length matches the number of axes transformed</span>
    <span class="n">ndim_transform</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">trim_approx</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">dict</span><span class="p">)</span>
    <span class="n">cA</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">trim_approx</span> <span class="k">else</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">'a'</span><span class="o">*</span><span class="n">ndim_transform</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">_have_c99_complex</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">iscomplexobj</span><span class="p">(</span><span class="n">cA</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">trim_approx</span><span class="p">:</span>
            <span class="n">coeffs_real</span> <span class="o">=</span> <span class="p">[</span><span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">]</span>
            <span class="n">coeffs_imag</span> <span class="o">=</span> <span class="p">[</span><span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span><span class="p">]</span>
            <span class="n">coeffs</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">coeffs_real</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">coeffs_imag</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">coeffs_real</span> <span class="o">+=</span> <span class="p">[{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">real</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">]</span>
        <span class="n">coeffs_imag</span> <span class="o">+=</span> <span class="p">[{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">imag</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">]</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"wavelet"</span><span class="p">:</span> <span class="n">wavelet</span><span class="p">,</span> <span class="s2">"axes"</span><span class="p">:</span> <span class="n">axes</span><span class="p">,</span> <span class="s2">"norm"</span><span class="p">:</span> <span class="n">norm</span><span class="p">}</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">iswtn</span><span class="p">(</span><span class="n">coeffs_real</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">iswtn</span><span class="p">(</span><span class="n">coeffs_imag</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">trim_approx</span><span class="p">:</span>
        <span class="n">coeffs</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="c1"># copy to avoid modification of input data</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">_check_dtype</span><span class="p">(</span><span class="n">cA</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cA</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ndim</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">ndim</span>

    <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="o">+</span> <span class="n">ndim</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">axes</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"The axes passed to swtn must be unique."</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ndim_transform</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"The number of axes used in iswtn must match the "</span>
                         <span class="s2">"number of dimensions transformed in swtn."</span><span class="p">)</span>

    <span class="c1"># num_levels, equivalent to the decomposition level, n</span>
    <span class="n">num_levels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span>
    <span class="n">wavelets</span> <span class="o">=</span> <span class="n">_wavelets_per_axis</span><span class="p">(</span><span class="n">wavelet</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">norm</span><span class="p">:</span>
        <span class="n">wavelets</span> <span class="o">=</span> <span class="p">[</span><span class="n">_rescale_wavelet_filterbank</span><span class="p">(</span><span class="n">wav</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">wav</span> <span class="ow">in</span> <span class="n">wavelets</span><span class="p">]</span>

    <span class="c1"># initialize various slice objects used in the loops below</span>
    <span class="c1"># these will remain slice(None) only on axes that aren't transformed</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> <span class="p">]</span><span class="o">*</span><span class="n">ndim</span>
    <span class="n">even_indices</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> <span class="p">]</span><span class="o">*</span><span class="n">ndim</span>
    <span class="n">odd_indices</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> <span class="p">]</span><span class="o">*</span><span class="n">ndim</span>
    <span class="n">odd_even_slices</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> <span class="p">]</span><span class="o">*</span><span class="n">ndim</span>

    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_levels</span><span class="p">):</span>
        <span class="n">step_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">num_levels</span><span class="o">-</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">step_size</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">trim_approx</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">'a'</span><span class="o">*</span><span class="n">ndim_transform</span><span class="p">)</span>  <span class="c1"># will restore later</span>
        <span class="n">details</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
        <span class="c1"># make sure dtype matches the coarsest level approximation coefficients</span>
        <span class="n">common_dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">result_type</span><span class="p">(</span><span class="o">*</span><span class="p">(</span>
            <span class="p">[</span><span class="n">dt</span><span class="p">,</span> <span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">dtype</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">details</span><span class="o">.</span><span class="n">values</span><span class="p">()]))</span>
        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">common_dtype</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">common_dtype</span><span class="p">)</span>

        <span class="c1"># We assume all coefficient arrays are of equal size</span>
        <span class="n">shapes</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">details</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">shapes</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">"Mismatch in shape of intermediate coefficient arrays"</span><span class="p">)</span>

        <span class="c1"># shape of a single coefficient array, excluding non-transformed axes</span>
        <span class="n">coeff_trans_shape</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">shapes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">ax</span><span class="p">]</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">])</span>

        <span class="c1"># nested loop over all combinations of axis offsets at this level</span>
        <span class="k">for</span> <span class="n">firsts</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="p">([</span><span class="nb">range</span><span class="p">(</span><span class="n">last_index</span><span class="p">),</span> <span class="p">]</span><span class="o">*</span><span class="n">ndim_transform</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">first</span><span class="p">,</span> <span class="n">sh</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">firsts</span><span class="p">,</span> <span class="n">coeff_trans_shape</span><span class="p">,</span> <span class="n">axes</span><span class="p">):</span>
                <span class="n">indices</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">sh</span><span class="p">,</span> <span class="n">step_size</span><span class="p">)</span>
                <span class="n">even_indices</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">sh</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">step_size</span><span class="p">)</span>
                <span class="n">odd_indices</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">first</span><span class="o">+</span><span class="n">step_size</span><span class="p">,</span> <span class="n">sh</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">step_size</span><span class="p">)</span>

            <span class="c1"># nested loop over all combinations of odd/even inidices</span>
            <span class="n">approx</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">output</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">indices</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">ntransforms</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">odds</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">]</span><span class="o">*</span><span class="n">ndim_transform</span><span class="p">)):</span>
                <span class="k">for</span> <span class="n">o</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">odds</span><span class="p">,</span> <span class="n">axes</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">o</span><span class="p">:</span>
                        <span class="n">odd_even_slices</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span> <span class="o">=</span> <span class="n">odd_indices</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">odd_even_slices</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span> <span class="o">=</span> <span class="n">even_indices</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span>
                <span class="c1"># extract the odd/even indices for all detail coefficients</span>
                <span class="n">details_slice</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">details</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">details_slice</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">odd_even_slices</span><span class="p">)]</span>
                <span class="n">details_slice</span><span class="p">[</span><span class="s1">'a'</span><span class="o">*</span><span class="n">ndim_transform</span><span class="p">]</span> <span class="o">=</span> <span class="n">approx</span><span class="p">[</span>
                    <span class="nb">tuple</span><span class="p">(</span><span class="n">odd_even_slices</span><span class="p">)]</span>

                <span class="c1"># perform the inverse dwt on the selected indices,</span>
                <span class="c1"># making sure to use periodic boundary conditions</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">idwtn</span><span class="p">(</span><span class="n">details_slice</span><span class="p">,</span> <span class="n">wavelets</span><span class="p">,</span> <span class="s1">'periodization'</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">o</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">odds</span><span class="p">,</span> <span class="n">axes</span><span class="p">):</span>
                    <span class="c1"># circular shift along any odd indexed axis</span>
                    <span class="k">if</span> <span class="n">o</span><span class="p">:</span>
                        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
                <span class="n">output</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">indices</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">x</span>
                <span class="n">ntransforms</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">output</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">indices</span><span class="p">)]</span> <span class="o">/=</span> <span class="n">ntransforms</span>  <span class="c1"># normalize</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">trim_approx</span><span class="p">:</span>
            <span class="n">coeffs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">'a'</span><span class="o">*</span><span class="n">ndim_transform</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span>  <span class="c1"># restore approx coeffs to dict</span>
    <span class="k">return</span> <span class="n">output</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.mra">
<code class="highlight language-python"><span class="n">mra</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="s1">'swt'</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'periodization'</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Forward 1D multiresolution analysis.</p>
<p>It is a projection onto the wavelet subspaces.</p>
<h4 id="pywt.mra--parameters">Parameters</h4>
<p>data: array_like
    Input data
wavelet : Wavelet object or name string
    Wavelet to use
level : int, optional
    Decomposition level (must be &gt;= 0). If level is None (default) then it
    will be calculated using the <code>dwt_max_level</code> function.
axis: int, optional
    Axis over which to compute the DWT. If not given, the last axis is
    used. Currently only available when <code>transform='dwt'</code>.
transform : {'dwt', 'swt'}
    Whether to use the DWT or SWT for the transforms.
mode : str, optional
    Signal extension mode, see <code>Modes</code> (default: 'symmetric'). This option
    is only used when transform='dwt'.</p>
<h4 id="pywt.mra--returns">Returns</h4>
<p>[cAn, {details_level_n}, ... {details_level_1}] : list
    For more information, see the detailed description in <code>wavedec</code></p>
<h4 id="pywt.mra--see-also">See Also</h4>
<p>imra, swt</p>
<h4 id="pywt.mra--notes">Notes</h4>
<p>This is sometimes referred to as an additive decomposition because the
inverse transform (<code>imra</code>) is just the sum of the coefficient arrays
[1]_. The decomposition using <code>transform='dwt'</code> corresponds to section
2.2 while that using an undecimated transform (<code>transform='swt'</code>) is
described in section 3.2 and appendix A.</p>
<p>This transform does not share the variance partition property of <code>swt</code>
with <code>norm=True</code>. It does however, result in coefficients that are
temporally aligned regardless of the symmetry of the wavelet used.</p>
<p>The redundancy of this transform is <code>(level + 1)</code>.</p>
<h4 id="pywt.mra--references">References</h4>
<p>.. [1] Donald B. Percival and Harold O. Mofjeld. Analysis of Subtidal
    Coastal Sea Level Fluctuations Using Wavelets. Journal of the American
    Statistical Association Vol. 92, No. 439 (Sep., 1997), pp. 868-880.
    https://doi.org/10.2307/2965551</p>
<details class="quote">
<summary>Source code in <code>pywt/_mra.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">mra</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="s1">'swt'</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s1">'periodization'</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Forward 1D multiresolution analysis.</span>

<span class="sd">    It is a projection onto the wavelet subspaces.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data: array_like</span>
<span class="sd">        Input data</span>
<span class="sd">    wavelet : Wavelet object or name string</span>
<span class="sd">        Wavelet to use</span>
<span class="sd">    level : int, optional</span>
<span class="sd">        Decomposition level (must be &gt;= 0). If level is None (default) then it</span>
<span class="sd">        will be calculated using the `dwt_max_level` function.</span>
<span class="sd">    axis: int, optional</span>
<span class="sd">        Axis over which to compute the DWT. If not given, the last axis is</span>
<span class="sd">        used. Currently only available when ``transform='dwt'``.</span>
<span class="sd">    transform : {'dwt', 'swt'}</span>
<span class="sd">        Whether to use the DWT or SWT for the transforms.</span>
<span class="sd">    mode : str, optional</span>
<span class="sd">        Signal extension mode, see `Modes` (default: 'symmetric'). This option</span>
<span class="sd">        is only used when transform='dwt'.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    [cAn, {details_level_n}, ... {details_level_1}] : list</span>
<span class="sd">        For more information, see the detailed description in `wavedec`</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    imra, swt</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This is sometimes referred to as an additive decomposition because the</span>
<span class="sd">    inverse transform (``imra``) is just the sum of the coefficient arrays</span>
<span class="sd">    [1]_. The decomposition using ``transform='dwt'`` corresponds to section</span>
<span class="sd">    2.2 while that using an undecimated transform (``transform='swt'``) is</span>
<span class="sd">    described in section 3.2 and appendix A.</span>

<span class="sd">    This transform does not share the variance partition property of ``swt``</span>
<span class="sd">    with `norm=True`. It does however, result in coefficients that are</span>
<span class="sd">    temporally aligned regardless of the symmetry of the wavelet used.</span>

<span class="sd">    The redundancy of this transform is ``(level + 1)``.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Donald B. Percival and Harold O. Mofjeld. Analysis of Subtidal</span>
<span class="sd">        Coastal Sea Level Fluctuations Using Wavelets. Journal of the American</span>
<span class="sd">        Statistical Association Vol. 92, No. 439 (Sep., 1997), pp. 868-880.</span>
<span class="sd">        https://doi.org/10.2307/2965551</span>

<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">transform</span> <span class="o">==</span> <span class="s1">'swt'</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">!=</span> <span class="s1">'periodization'</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">"transform swt only supports mode='periodization'"</span><span class="p">)</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"wavelet"</span><span class="p">:</span> <span class="n">wavelet</span><span class="p">,</span> <span class="s2">"axis"</span><span class="p">:</span> <span class="n">axis</span><span class="p">,</span> <span class="s2">"norm"</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
        <span class="n">forward</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">swt</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="p">,</span> <span class="n">trim_approx</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">inverse</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">iswt</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">is_swt</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">elif</span> <span class="n">transform</span> <span class="o">==</span> <span class="s1">'dwt'</span><span class="p">:</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"wavelet"</span><span class="p">:</span> <span class="n">wavelet</span><span class="p">,</span> <span class="s2">"mode"</span><span class="p">:</span> <span class="n">mode</span><span class="p">,</span> <span class="s2">"axis"</span><span class="p">:</span> <span class="n">axis</span><span class="p">}</span>
        <span class="n">forward</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">wavedec</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">inverse</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">waverec</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">is_swt</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"unrecognized transform: </span><span class="si">{</span><span class="n">transform</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">wav_coeffs</span> <span class="o">=</span> <span class="n">forward</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="n">mra_coeffs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wav_coeffs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">is_swt</span><span class="p">:</span>
        <span class="c1"># replicate same zeros array to save memory</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">wav_coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="p">[</span><span class="n">z</span><span class="p">,</span> <span class="p">]</span> <span class="o">*</span> <span class="n">nc</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># zero arrays have variable size in DWT case</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">wav_coeffs</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
        <span class="c1"># tmp has arrays of zeros except for the jth entry</span>
        <span class="n">tmp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">wav_coeffs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>

        <span class="c1"># reconstruct</span>
        <span class="n">rec</span> <span class="o">=</span> <span class="n">inverse</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rec</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
            <span class="c1"># trim any excess coefficients</span>
            <span class="n">rec</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="nb">tuple</span><span class="p">([</span><span class="nb">slice</span><span class="p">(</span><span class="n">sz</span><span class="p">)</span> <span class="k">for</span> <span class="n">sz</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">])]</span>
        <span class="n">mra_coeffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>

        <span class="c1"># restore zeros</span>
        <span class="k">if</span> <span class="n">is_swt</span><span class="p">:</span>
            <span class="n">tmp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tmp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">mra_coeffs</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.mra2">
<code class="highlight language-python"><span class="n">mra2</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">transform</span><span class="o">=</span><span class="s1">'swt2'</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'periodization'</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Forward 2D multiresolution analysis.</p>
<p>It is a projection onto wavelet subspaces.</p>
<h4 id="pywt.mra2--parameters">Parameters</h4>
<p>data: array_like
    Input data
wavelet : Wavelet object or name string, or 2-tuple of wavelets
    Wavelet to use.  This can also be a tuple containing a wavelet to
    apply along each axis in <code>axes</code>.
level : int, optional
    Decomposition level (must be &gt;= 0). If level is None (default) then it
    will be calculated using the <code>dwt_max_level</code> function.
axes : 2-tuple of ints, optional
    Axes over which to compute the DWT. Repeated elements are not allowed.
    Currently only available when <code>transform='dwt2'</code>.
transform : {'dwt2', 'swt2'}
    Whether to use the DWT or SWT for the transforms.
mode : str or 2-tuple of str, optional
    Signal extension mode, see <code>Modes</code> (default: 'symmetric'). This option
    is only used when transform='dwt2'.</p>
<h4 id="pywt.mra2--returns">Returns</h4>
<p>coeffs : list
    For more information, see the detailed description in <code>wavedec2</code></p>
<h4 id="pywt.mra2--notes">Notes</h4>
<p>This is sometimes referred to as an additive decomposition because the
inverse transform (<code>imra2</code>) is just the sum of the coefficient arrays
[1]_. The decomposition using <code>transform='dwt'</code> corresponds to section
2.2 while that using an undecimated transform (<code>transform='swt'</code>) is
described in section 3.2 and appendix A.</p>
<p>This transform does not share the variance partition property of <code>swt2</code>
with <code>norm=True</code>. It does however, result in coefficients that are
temporally aligned regardless of the symmetry of the wavelet used.</p>
<p>The redundancy of this transform is <code>3 * level + 1</code>.</p>
<h4 id="pywt.mra2--see-also">See Also</h4>
<p>imra2, swt2</p>
<h4 id="pywt.mra2--references">References</h4>
<p>.. [1] Donald B. Percival and Harold O. Mofjeld. Analysis of Subtidal
    Coastal Sea Level Fluctuations Using Wavelets. Journal of the American
    Statistical Association Vol. 92, No. 439 (Sep., 1997), pp. 868-880.
    https://doi.org/10.2307/2965551</p>
<details class="quote">
<summary>Source code in <code>pywt/_mra.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">mra2</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">transform</span><span class="o">=</span><span class="s1">'swt2'</span><span class="p">,</span>
         <span class="n">mode</span><span class="o">=</span><span class="s1">'periodization'</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Forward 2D multiresolution analysis.</span>

<span class="sd">    It is a projection onto wavelet subspaces.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data: array_like</span>
<span class="sd">        Input data</span>
<span class="sd">    wavelet : Wavelet object or name string, or 2-tuple of wavelets</span>
<span class="sd">        Wavelet to use.  This can also be a tuple containing a wavelet to</span>
<span class="sd">        apply along each axis in `axes`.</span>
<span class="sd">    level : int, optional</span>
<span class="sd">        Decomposition level (must be &gt;= 0). If level is None (default) then it</span>
<span class="sd">        will be calculated using the `dwt_max_level` function.</span>
<span class="sd">    axes : 2-tuple of ints, optional</span>
<span class="sd">        Axes over which to compute the DWT. Repeated elements are not allowed.</span>
<span class="sd">        Currently only available when ``transform='dwt2'``.</span>
<span class="sd">    transform : {'dwt2', 'swt2'}</span>
<span class="sd">        Whether to use the DWT or SWT for the transforms.</span>
<span class="sd">    mode : str or 2-tuple of str, optional</span>
<span class="sd">        Signal extension mode, see `Modes` (default: 'symmetric'). This option</span>
<span class="sd">        is only used when transform='dwt2'.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    coeffs : list</span>
<span class="sd">        For more information, see the detailed description in `wavedec2`</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This is sometimes referred to as an additive decomposition because the</span>
<span class="sd">    inverse transform (``imra2``) is just the sum of the coefficient arrays</span>
<span class="sd">    [1]_. The decomposition using ``transform='dwt'`` corresponds to section</span>
<span class="sd">    2.2 while that using an undecimated transform (``transform='swt'``) is</span>
<span class="sd">    described in section 3.2 and appendix A.</span>

<span class="sd">    This transform does not share the variance partition property of ``swt2``</span>
<span class="sd">    with `norm=True`. It does however, result in coefficients that are</span>
<span class="sd">    temporally aligned regardless of the symmetry of the wavelet used.</span>

<span class="sd">    The redundancy of this transform is ``3 * level + 1``.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    imra2, swt2</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Donald B. Percival and Harold O. Mofjeld. Analysis of Subtidal</span>
<span class="sd">        Coastal Sea Level Fluctuations Using Wavelets. Journal of the American</span>
<span class="sd">        Statistical Association Vol. 92, No. 439 (Sep., 1997), pp. 868-880.</span>
<span class="sd">        https://doi.org/10.2307/2965551</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">transform</span> <span class="o">==</span> <span class="s1">'swt2'</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">!=</span> <span class="s1">'periodization'</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">"transform swt only supports mode='periodization'"</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">level</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">level</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">swt_max_level</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"wavelet"</span><span class="p">:</span> <span class="n">wavelet</span><span class="p">,</span> <span class="s2">"axes"</span><span class="p">:</span> <span class="n">axes</span><span class="p">,</span> <span class="s2">"norm"</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
        <span class="n">forward</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">swt2</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="p">,</span> <span class="n">trim_approx</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">inverse</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">iswt2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">transform</span> <span class="o">==</span> <span class="s1">'dwt2'</span><span class="p">:</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"wavelet"</span><span class="p">:</span> <span class="n">wavelet</span><span class="p">,</span> <span class="s2">"mode"</span><span class="p">:</span> <span class="n">mode</span><span class="p">,</span> <span class="s2">"axes"</span><span class="p">:</span> <span class="n">axes</span><span class="p">}</span>
        <span class="n">forward</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">wavedec2</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">inverse</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">waverec2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"unrecognized transform: </span><span class="si">{</span><span class="n">transform</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">wav_coeffs</span> <span class="o">=</span> <span class="n">forward</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="n">mra_coeffs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wav_coeffs</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">wav_coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="p">[</span><span class="n">z</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nc</span><span class="p">):</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">wav_coeffs</span><span class="p">[</span><span class="n">j</span><span class="p">]])</span>

    <span class="c1"># tmp has arrays of zeros except for the jth entry</span>
    <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">wav_coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># reconstruct</span>
    <span class="n">rec</span> <span class="o">=</span> <span class="n">inverse</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">rec</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
        <span class="c1"># trim any excess coefficients</span>
        <span class="n">rec</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="nb">tuple</span><span class="p">([</span><span class="nb">slice</span><span class="p">(</span><span class="n">sz</span><span class="p">)</span> <span class="k">for</span> <span class="n">sz</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">])]</span>
    <span class="n">mra_coeffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
    <span class="c1"># restore zeros</span>
    <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span>

    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nc</span><span class="p">):</span>
        <span class="n">dcoeffs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="c1"># tmp has arrays of zeros except for the jth entry</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>
            <span class="n">tmp</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">wav_coeffs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>
            <span class="c1"># reconstruct</span>
            <span class="n">rec</span> <span class="o">=</span> <span class="n">inverse</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">rec</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
                <span class="c1"># trim any excess coefficients</span>
                <span class="n">rec</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="nb">tuple</span><span class="p">([</span><span class="nb">slice</span><span class="p">(</span><span class="n">sz</span><span class="p">)</span> <span class="k">for</span> <span class="n">sz</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">])]</span>
            <span class="n">dcoeffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
            <span class="c1"># restore zeros</span>
            <span class="n">tmp</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span>
        <span class="n">mra_coeffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">dcoeffs</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">mra_coeffs</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.mran">
<code class="highlight language-python"><span class="n">mran</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="s1">'swtn'</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'periodization'</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Forward nD multiresolution analysis.</p>
<p>It is a projection onto the wavelet subspaces.</p>
<h4 id="pywt.mran--parameters">Parameters</h4>
<p>data: array_like
    Input data
wavelet : Wavelet object or name string, or tuple of wavelets
    Wavelet to use. This can also be a tuple containing a wavelet to
    apply along each axis in <code>axes</code>.
level : int, optional
    Decomposition level (must be &gt;= 0). If level is None (default) then it
    will be calculated using the <code>dwt_max_level</code> function.
axes : tuple of ints, optional
    Axes over which to compute the DWT. Repeated elements are not allowed.
transform : {'dwtn', 'swtn'}
    Whether to use the DWT or SWT for the transforms.
mode : str or tuple of str, optional
    Signal extension mode, see <code>Modes</code> (default: 'symmetric'). This option
    is only used when transform='dwtn'.</p>
<h4 id="pywt.mran--returns">Returns</h4>
<p>coeffs : list
    For more information, see the detailed description in <code>wavedecn</code>.</p>
<h4 id="pywt.mran--see-also">See Also</h4>
<p>imran, swtn</p>
<h4 id="pywt.mran--notes">Notes</h4>
<p>This is sometimes referred to as an additive decomposition because the
inverse transform (<code>imran</code>) is just the sum of the coefficient arrays
[1]_. The decomposition using <code>transform='dwt'</code> corresponds to section
2.2 while that using an undecimated transform (<code>transform='swt'</code>) is
described in section 3.2 and appendix A.</p>
<p>This transform does not share the variance partition property of <code>swtn</code>
with <code>norm=True</code>. It does however, result in coefficients that are
temporally aligned regardless of the symmetry of the wavelet used.</p>
<p>The redundancy of this transform is <code>(2**n - 1) * level + 1</code> where <code>n</code>
corresponds to the number of axes transformed.</p>
<h4 id="pywt.mran--references">References</h4>
<p>.. [1] Donald B. Percival and Harold O. Mofjeld. Analysis of Subtidal
    Coastal Sea Level Fluctuations Using Wavelets. Journal of the American
    Statistical Association Vol. 92, No. 439 (Sep., 1997), pp. 868-880.
    https://doi.org/10.2307/2965551</p>
<details class="quote">
<summary>Source code in <code>pywt/_mra.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">mran</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="s1">'swtn'</span><span class="p">,</span>
         <span class="n">mode</span><span class="o">=</span><span class="s1">'periodization'</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Forward nD multiresolution analysis.</span>

<span class="sd">    It is a projection onto the wavelet subspaces.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data: array_like</span>
<span class="sd">        Input data</span>
<span class="sd">    wavelet : Wavelet object or name string, or tuple of wavelets</span>
<span class="sd">        Wavelet to use. This can also be a tuple containing a wavelet to</span>
<span class="sd">        apply along each axis in `axes`.</span>
<span class="sd">    level : int, optional</span>
<span class="sd">        Decomposition level (must be &gt;= 0). If level is None (default) then it</span>
<span class="sd">        will be calculated using the `dwt_max_level` function.</span>
<span class="sd">    axes : tuple of ints, optional</span>
<span class="sd">        Axes over which to compute the DWT. Repeated elements are not allowed.</span>
<span class="sd">    transform : {'dwtn', 'swtn'}</span>
<span class="sd">        Whether to use the DWT or SWT for the transforms.</span>
<span class="sd">    mode : str or tuple of str, optional</span>
<span class="sd">        Signal extension mode, see `Modes` (default: 'symmetric'). This option</span>
<span class="sd">        is only used when transform='dwtn'.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    coeffs : list</span>
<span class="sd">        For more information, see the detailed description in `wavedecn`.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    imran, swtn</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This is sometimes referred to as an additive decomposition because the</span>
<span class="sd">    inverse transform (``imran``) is just the sum of the coefficient arrays</span>
<span class="sd">    [1]_. The decomposition using ``transform='dwt'`` corresponds to section</span>
<span class="sd">    2.2 while that using an undecimated transform (``transform='swt'``) is</span>
<span class="sd">    described in section 3.2 and appendix A.</span>

<span class="sd">    This transform does not share the variance partition property of ``swtn``</span>
<span class="sd">    with `norm=True`. It does however, result in coefficients that are</span>
<span class="sd">    temporally aligned regardless of the symmetry of the wavelet used.</span>

<span class="sd">    The redundancy of this transform is ``(2**n - 1) * level + 1`` where ``n``</span>
<span class="sd">    corresponds to the number of axes transformed.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Donald B. Percival and Harold O. Mofjeld. Analysis of Subtidal</span>
<span class="sd">        Coastal Sea Level Fluctuations Using Wavelets. Journal of the American</span>
<span class="sd">        Statistical Association Vol. 92, No. 439 (Sep., 1997), pp. 868-880.</span>
<span class="sd">        https://doi.org/10.2307/2965551</span>
<span class="sd">    """</span>
    <span class="n">axes</span><span class="p">,</span> <span class="n">axes_shapes</span><span class="p">,</span> <span class="n">ndim_transform</span> <span class="o">=</span> <span class="n">_prep_axes_wavedecn</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
    <span class="n">wavelets</span> <span class="o">=</span> <span class="n">_wavelets_per_axis</span><span class="p">(</span><span class="n">wavelet</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">transform</span> <span class="o">==</span> <span class="s1">'swtn'</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">!=</span> <span class="s1">'periodization'</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">"transform swt only supports mode='periodization'"</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">level</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">level</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">swt_max_level</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"wavelet"</span><span class="p">:</span> <span class="n">wavelets</span><span class="p">,</span> <span class="s2">"axes"</span><span class="p">:</span> <span class="n">axes</span><span class="p">,</span> <span class="s2">"norm"</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
        <span class="n">forward</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">swtn</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="p">,</span> <span class="n">trim_approx</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">inverse</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">iswtn</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">transform</span> <span class="o">==</span> <span class="s1">'dwtn'</span><span class="p">:</span>
        <span class="n">modes</span> <span class="o">=</span> <span class="n">_modes_per_axis</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"wavelet"</span><span class="p">:</span> <span class="n">wavelets</span><span class="p">,</span> <span class="s2">"mode"</span><span class="p">:</span> <span class="n">modes</span><span class="p">,</span> <span class="s2">"axes"</span><span class="p">:</span> <span class="n">axes</span><span class="p">}</span>
        <span class="n">forward</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">wavedecn</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">inverse</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">waverecn</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"unrecognized transform: </span><span class="si">{</span><span class="n">transform</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">wav_coeffs</span> <span class="o">=</span> <span class="n">forward</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="n">mra_coeffs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wav_coeffs</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">wav_coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="p">[</span><span class="n">z</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nc</span><span class="p">):</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">k</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">wav_coeffs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>

    <span class="c1"># tmp has arrays of zeros except for the jth entry</span>
    <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">wav_coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># reconstruct</span>
    <span class="n">rec</span> <span class="o">=</span> <span class="n">inverse</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">rec</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
        <span class="c1"># trim any excess coefficients</span>
        <span class="n">rec</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="nb">tuple</span><span class="p">([</span><span class="nb">slice</span><span class="p">(</span><span class="n">sz</span><span class="p">)</span> <span class="k">for</span> <span class="n">sz</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">])]</span>
    <span class="n">mra_coeffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
    <span class="c1"># restore zeros</span>
    <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span>

    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nc</span><span class="p">):</span>
        <span class="n">dcoeffs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">dkeys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">wav_coeffs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dkeys</span><span class="p">:</span>
            <span class="c1"># tmp has arrays of zeros except for the jth entry</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>
            <span class="n">tmp</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">wav_coeffs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>
            <span class="c1"># tmp[j]['a' * len(k)] = z</span>
            <span class="c1"># reconstruct</span>
            <span class="n">rec</span> <span class="o">=</span> <span class="n">inverse</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">rec</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
                <span class="c1"># trim any excess coefficients</span>
                <span class="n">rec</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="nb">tuple</span><span class="p">([</span><span class="nb">slice</span><span class="p">(</span><span class="n">sz</span><span class="p">)</span> <span class="k">for</span> <span class="n">sz</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">])]</span>
            <span class="n">dcoeffs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">rec</span>
            <span class="c1"># restore zeros</span>
            <span class="n">tmp</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span>
            <span class="c1"># tmp[j].pop('a' * len(k))</span>
        <span class="n">mra_coeffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dcoeffs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mra_coeffs</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.orthogonal_filter_bank">
<code class="highlight language-python"><span class="n">orthogonal_filter_bank</span><span class="p">(</span><span class="n">scaling_filter</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Returns the orthogonal filter bank.</p>
<p>The orthogonal filter bank consists of the HPFs and LPFs at
decomposition and reconstruction stage for the input scaling filter.</p>
<h4 id="pywt.orthogonal_filter_bank--parameters">Parameters</h4>
<p>scaling_filter : array_like
    Input scaling filter (father wavelet).</p>
<h4 id="pywt.orthogonal_filter_bank--returns">Returns</h4>
<p>orth_filt_bank : tuple of 4 ndarrays
    The orthogonal filter bank of the input scaling filter in the order :
    1] Decomposition LPF
    2] Decomposition HPF
    3] Reconstruction LPF
    4] Reconstruction HPF</p>
<details class="quote">
<summary>Source code in <code>pywt/_functions.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">orthogonal_filter_bank</span><span class="p">(</span><span class="n">scaling_filter</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Returns the orthogonal filter bank.</span>

<span class="sd">    The orthogonal filter bank consists of the HPFs and LPFs at</span>
<span class="sd">    decomposition and reconstruction stage for the input scaling filter.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    scaling_filter : array_like</span>
<span class="sd">        Input scaling filter (father wavelet).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    orth_filt_bank : tuple of 4 ndarrays</span>
<span class="sd">        The orthogonal filter bank of the input scaling filter in the order :</span>
<span class="sd">        1] Decomposition LPF</span>
<span class="sd">        2] Decomposition HPF</span>
<span class="sd">        3] Reconstruction LPF</span>
<span class="sd">        4] Reconstruction HPF</span>

<span class="sd">    """</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">scaling_filter</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"`scaling_filter` length has to be even."</span><span class="p">)</span>

    <span class="n">scaling_filter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">scaling_filter</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

    <span class="n">rec_lo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">scaling_filter</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">scaling_filter</span><span class="p">)</span>
    <span class="n">dec_lo</span> <span class="o">=</span> <span class="n">rec_lo</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">rec_hi</span> <span class="o">=</span> <span class="n">qmf</span><span class="p">(</span><span class="n">rec_lo</span><span class="p">)</span>
    <span class="n">dec_hi</span> <span class="o">=</span> <span class="n">rec_hi</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">orth_filt_bank</span> <span class="o">=</span> <span class="p">(</span><span class="n">dec_lo</span><span class="p">,</span> <span class="n">dec_hi</span><span class="p">,</span> <span class="n">rec_lo</span><span class="p">,</span> <span class="n">rec_hi</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">orth_filt_bank</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.pad">
<code class="highlight language-python"><span class="n">pad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pad_widths</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Extend a 1D signal using a given boundary mode.</p>
<p>This function operates like :func:<code>numpy.pad</code> but supports all signal
extension modes that can be used by PyWavelets discrete wavelet transforms.</p>
<h4 id="pywt.pad--parameters">Parameters</h4>
<p>x : ndarray
    The array to pad
pad_widths : {sequence, array_like, int}
    Number of values padded to the edges of each axis.
    <code>((before_1, after_1), … (before_N, after_N))</code> unique pad widths for
    each axis. <code>((before, after),)</code> yields same before and after pad for
    each axis. <code>(pad,)</code> or int is a shortcut for
    <code>before = after = pad width</code> for all axes.
mode : str, optional
    Signal extension mode, see :ref:<code>Modes &lt;ref-modes&gt;</code>.</p>
<h4 id="pywt.pad--returns">Returns</h4>
<p>pad : ndarray
    Padded array of rank equal to array with shape increased according to
    <code>pad_widths</code>.</p>
<h4 id="pywt.pad--notes">Notes</h4>
<p>The performance of padding in dimensions &gt; 1 may be substantially slower
for modes <code>'smooth'</code> and <code>'antisymmetric'</code> as these modes are not
supported efficiently by the underlying :func:<code>numpy.pad</code> function.</p>
<p>Note that the behavior of the <code>'constant'</code> mode here follows the
PyWavelets convention which is different from NumPy (it is equivalent to
<code>mode='edge'</code> in :func:<code>numpy.pad</code>).</p>
<details class="quote">
<summary>Source code in <code>pywt/_dwt.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">pad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pad_widths</span><span class="p">,</span> <span class="n">mode</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Extend a 1D signal using a given boundary mode.</span>

<span class="sd">    This function operates like :func:`numpy.pad` but supports all signal</span>
<span class="sd">    extension modes that can be used by PyWavelets discrete wavelet transforms.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : ndarray</span>
<span class="sd">        The array to pad</span>
<span class="sd">    pad_widths : {sequence, array_like, int}</span>
<span class="sd">        Number of values padded to the edges of each axis.</span>
<span class="sd">        ``((before_1, after_1), … (before_N, after_N))`` unique pad widths for</span>
<span class="sd">        each axis. ``((before, after),)`` yields same before and after pad for</span>
<span class="sd">        each axis. ``(pad,)`` or int is a shortcut for</span>
<span class="sd">        ``before = after = pad width`` for all axes.</span>
<span class="sd">    mode : str, optional</span>
<span class="sd">        Signal extension mode, see :ref:`Modes &lt;ref-modes&gt;`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pad : ndarray</span>
<span class="sd">        Padded array of rank equal to array with shape increased according to</span>
<span class="sd">        ``pad_widths``.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The performance of padding in dimensions &gt; 1 may be substantially slower</span>
<span class="sd">    for modes ``'smooth'`` and ``'antisymmetric'`` as these modes are not</span>
<span class="sd">    supported efficiently by the underlying :func:`numpy.pad` function.</span>

<span class="sd">    Note that the behavior of the ``'constant'`` mode here follows the</span>
<span class="sd">    PyWavelets convention which is different from NumPy (it is equivalent to</span>
<span class="sd">    ``mode='edge'`` in :func:`numpy.pad`).</span>
<span class="sd">    """</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="c1"># process pad_widths exactly as in numpy.pad</span>
    <span class="n">pad_widths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pad_widths</span><span class="p">)</span>
    <span class="n">pad_widths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">pad_widths</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">intp</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pad_widths</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"pad_widths must be &gt; 0"</span><span class="p">)</span>
    <span class="n">pad_widths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">pad_widths</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">ndim</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">mode</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="s1">'reflect'</span><span class="p">]:</span>
        <span class="n">xp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pad_widths</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'periodic'</span><span class="p">,</span> <span class="s1">'periodization'</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">'periodization'</span><span class="p">:</span>
            <span class="c1"># Promote odd-sized dimensions to even length by duplicating the</span>
            <span class="c1"># last value.</span>
            <span class="n">edge_pad_widths</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span>
                               <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">ndim</span><span class="p">)]</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">edge_pad_widths</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'edge'</span><span class="p">)</span>
        <span class="n">xp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pad_widths</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'wrap'</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">'zero'</span><span class="p">:</span>
        <span class="n">xp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pad_widths</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'constant'</span><span class="p">,</span> <span class="n">constant_values</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">'constant'</span><span class="p">:</span>
        <span class="n">xp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pad_widths</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'edge'</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">'smooth'</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">pad_smooth</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="n">pad_width</span><span class="p">,</span> <span class="n">iaxis</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
            <span class="c1"># smooth extension to left</span>
            <span class="n">left</span> <span class="o">=</span> <span class="n">vector</span><span class="p">[</span><span class="n">pad_width</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">slope_left</span> <span class="o">=</span> <span class="p">(</span><span class="n">left</span> <span class="o">-</span> <span class="n">vector</span><span class="p">[</span><span class="n">pad_width</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
            <span class="n">vector</span><span class="p">[:</span><span class="n">pad_width</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> \
                <span class="n">left</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">pad_width</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">slope_left</span>

            <span class="c1"># smooth extension to right</span>
            <span class="n">right</span> <span class="o">=</span> <span class="n">vector</span><span class="p">[</span><span class="o">-</span><span class="n">pad_width</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">slope_right</span> <span class="o">=</span> <span class="p">(</span><span class="n">right</span> <span class="o">-</span> <span class="n">vector</span><span class="p">[</span><span class="o">-</span><span class="n">pad_width</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="p">])</span>
            <span class="n">vector</span><span class="p">[</span><span class="o">-</span><span class="n">pad_width</span><span class="p">[</span><span class="mi">1</span><span class="p">]:]</span> <span class="o">=</span> \
                <span class="n">right</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pad_width</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">slope_right</span>
            <span class="k">return</span> <span class="n">vector</span>
        <span class="n">xp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pad_widths</span><span class="p">,</span> <span class="n">pad_smooth</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">'antisymmetric'</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">pad_antisymmetric</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="n">pad_width</span><span class="p">,</span> <span class="n">iaxis</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
            <span class="c1"># smooth extension to left</span>
            <span class="c1"># implement by flipping portions symmetric padding</span>
            <span class="n">npad_l</span><span class="p">,</span> <span class="n">npad_r</span> <span class="o">=</span> <span class="n">pad_width</span>
            <span class="n">vsize_nonpad</span> <span class="o">=</span> <span class="n">vector</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="n">npad_l</span> <span class="o">-</span> <span class="n">npad_r</span>
            <span class="c1"># Note: must modify vector in-place</span>
            <span class="n">vector</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">vector</span><span class="p">[</span><span class="n">pad_width</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="o">-</span><span class="n">pad_width</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span>
                               <span class="n">pad_width</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">)</span>
            <span class="n">vp</span> <span class="o">=</span> <span class="n">vector</span>
            <span class="n">r_edge</span> <span class="o">=</span> <span class="n">npad_l</span> <span class="o">+</span> <span class="n">vsize_nonpad</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">l_edge</span> <span class="o">=</span> <span class="n">npad_l</span>
            <span class="c1"># width of each reflected segment</span>
            <span class="n">seg_width</span> <span class="o">=</span> <span class="n">vsize_nonpad</span>
            <span class="c1"># flip reflected segments on the right of the original signal</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">while</span> <span class="n">r_edge</span> <span class="o">&lt;=</span> <span class="n">vp</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
                <span class="n">segment_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">r_edge</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                                      <span class="nb">min</span><span class="p">(</span><span class="n">r_edge</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">seg_width</span><span class="p">,</span> <span class="n">vp</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">vp</span><span class="p">[</span><span class="n">segment_slice</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="n">r_edge</span> <span class="o">+=</span> <span class="n">seg_width</span>
                <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="c1"># flip reflected segments on the left of the original signal</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">while</span> <span class="n">l_edge</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">segment_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">l_edge</span> <span class="o">-</span> <span class="n">seg_width</span><span class="p">),</span> <span class="n">l_edge</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">vp</span><span class="p">[</span><span class="n">segment_slice</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="n">l_edge</span> <span class="o">-=</span> <span class="n">seg_width</span>
                <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">vector</span>
        <span class="n">xp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pad_widths</span><span class="p">,</span> <span class="n">pad_antisymmetric</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">'antireflect'</span><span class="p">:</span>
        <span class="n">xp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pad_widths</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'reflect'</span><span class="p">,</span> <span class="n">reflect_type</span><span class="o">=</span><span class="s1">'odd'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">"unsupported mode: </span><span class="si">{</span><span class="n">mode</span><span class="si">}</span><span class="s2">. The supported modes are </span><span class="si">{</span><span class="n">Modes</span><span class="o">.</span><span class="n">modes</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">xp</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.qmf">
<code class="highlight language-python"><span class="n">qmf</span><span class="p">(</span><span class="n">filt</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Returns the Quadrature Mirror Filter(QMF).</p>
<p>The magnitude response of QMF is mirror image about <code>pi/2</code> of that of the
input filter.</p>
<h4 id="pywt.qmf--parameters">Parameters</h4>
<p>filt : array_like
    Input filter for which QMF needs to be computed.</p>
<h4 id="pywt.qmf--returns">Returns</h4>
<p>qm_filter : ndarray
    Quadrature mirror of the input filter.</p>
<details class="quote">
<summary>Source code in <code>pywt/_functions.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">qmf</span><span class="p">(</span><span class="n">filt</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Returns the Quadrature Mirror Filter(QMF).</span>

<span class="sd">    The magnitude response of QMF is mirror image about `pi/2` of that of the</span>
<span class="sd">    input filter.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filt : array_like</span>
<span class="sd">        Input filter for which QMF needs to be computed.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    qm_filter : ndarray</span>
<span class="sd">        Quadrature mirror of the input filter.</span>

<span class="sd">    """</span>
    <span class="n">qm_filter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">filt</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">qm_filter</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">qm_filter</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">qm_filter</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.ravel_coeffs">
<code class="highlight language-python"><span class="n">ravel_coeffs</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Ravel a set of multilevel wavelet coefficients into a single 1D array.</p>
<h4 id="pywt.ravel_coeffs--parameters">Parameters</h4>
<p>coeffs : array-like
    A list of multilevel wavelet coefficients as returned by
    <code>wavedec</code>, <code>wavedec2</code> or <code>wavedecn</code>. This function is also
    compatible with the output of <code>swt</code>, <code>swt2</code> and <code>swtn</code> if those
    functions were called with <code>trim_approx=True</code>.
axes : sequence of ints, optional
    Axes over which the DWT that created <code>coeffs</code> was performed. The
    default value of None corresponds to all axes.</p>
<h4 id="pywt.ravel_coeffs--returns">Returns</h4>
<p>coeff_arr : array-like
    Wavelet transform coefficient array. All coefficients have been
    concatenated into a single array.
coeff_slices : list
    List of slices corresponding to each coefficient. As a 2D example,
    <code>coeff_arr[coeff_slices[1]['dd']]</code> would extract the first level
    detail coefficients from <code>coeff_arr</code>.
coeff_shapes : list
    List of shapes corresponding to each coefficient. For example, in 2D,
    <code>coeff_shapes[1]['dd']</code> would contain the original shape of the first
    level detail coefficients array.</p>
<h4 id="pywt.ravel_coeffs--see-also">See Also</h4>
<p>unravel_coeffs : the inverse of ravel_coeffs</p>
<h4 id="pywt.ravel_coeffs--examples">Examples</h4>
<blockquote>
<blockquote>
<blockquote>
<p>import pywt
cam = pywt.data.camera()
coeffs = pywt.wavedecn(cam, wavelet='db2', level=3)
arr, coeff_slices, coeff_shapes = pywt.ravel_coeffs(coeffs)</p>
</blockquote>
</blockquote>
</blockquote>
<details class="quote">
<summary>Source code in <code>pywt/_multilevel.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">ravel_coeffs</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Ravel a set of multilevel wavelet coefficients into a single 1D array.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    coeffs : array-like</span>
<span class="sd">        A list of multilevel wavelet coefficients as returned by</span>
<span class="sd">        ``wavedec``, ``wavedec2`` or ``wavedecn``. This function is also</span>
<span class="sd">        compatible with the output of ``swt``, ``swt2`` and ``swtn`` if those</span>
<span class="sd">        functions were called with ``trim_approx=True``.</span>
<span class="sd">    axes : sequence of ints, optional</span>
<span class="sd">        Axes over which the DWT that created ``coeffs`` was performed. The</span>
<span class="sd">        default value of None corresponds to all axes.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    coeff_arr : array-like</span>
<span class="sd">        Wavelet transform coefficient array. All coefficients have been</span>
<span class="sd">        concatenated into a single array.</span>
<span class="sd">    coeff_slices : list</span>
<span class="sd">        List of slices corresponding to each coefficient. As a 2D example,</span>
<span class="sd">        ``coeff_arr[coeff_slices[1]['dd']]`` would extract the first level</span>
<span class="sd">        detail coefficients from ``coeff_arr``.</span>
<span class="sd">    coeff_shapes : list</span>
<span class="sd">        List of shapes corresponding to each coefficient. For example, in 2D,</span>
<span class="sd">        ``coeff_shapes[1]['dd']`` would contain the original shape of the first</span>
<span class="sd">        level detail coefficients array.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    unravel_coeffs : the inverse of ravel_coeffs</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import pywt</span>
<span class="sd">    &gt;&gt;&gt; cam = pywt.data.camera()</span>
<span class="sd">    &gt;&gt;&gt; coeffs = pywt.wavedecn(cam, wavelet='db2', level=3)</span>
<span class="sd">    &gt;&gt;&gt; arr, coeff_slices, coeff_shapes = pywt.ravel_coeffs(coeffs)</span>

<span class="sd">    """</span>
    <span class="n">coeffs</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">ndim</span><span class="p">,</span> <span class="n">ndim_transform</span> <span class="o">=</span> <span class="n">_prepare_coeffs_axes</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>

    <span class="c1"># initialize with the approximation coefficients.</span>
    <span class="n">a_coeffs</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">a_size</span> <span class="o">=</span> <span class="n">a_coeffs</span><span class="o">.</span><span class="n">size</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># only a single approximation coefficient array was found</span>
        <span class="k">return</span> <span class="n">a_coeffs</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="n">a_size</span><span class="p">),</span> <span class="p">],</span> <span class="p">[</span><span class="n">a_coeffs</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">]</span>

    <span class="c1"># preallocate output array</span>
    <span class="n">arr_size</span> <span class="o">=</span> <span class="n">wavedecn_size</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span>
    <span class="n">coeff_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">arr_size</span><span class="p">,</span> <span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">a_coeffs</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

    <span class="n">a_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">a_size</span><span class="p">)</span>
    <span class="n">coeff_arr</span><span class="p">[</span><span class="n">a_slice</span><span class="p">]</span> <span class="o">=</span> <span class="n">a_coeffs</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

    <span class="c1"># initialize list of coefficient slices</span>
    <span class="n">coeff_slices</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">coeff_shapes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">coeff_slices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a_slice</span><span class="p">)</span>
    <span class="n">coeff_shapes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

    <span class="c1"># loop over the detail coefficients, embedding them in coeff_arr</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="n">a_size</span>
    <span class="k">for</span> <span class="n">coeff_dict</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">:</span>
        <span class="c1"># new dictionaries for detail coefficient slices and shapes</span>
        <span class="n">coeff_slices</span><span class="o">.</span><span class="n">append</span><span class="p">({})</span>
        <span class="n">coeff_shapes</span><span class="o">.</span><span class="n">append</span><span class="p">({})</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([</span><span class="n">d</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">coeff_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()]):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"coeffs_to_array does not support missing "</span>
                             <span class="s2">"coefficients."</span><span class="p">)</span>
        <span class="c1"># sort to make sure key order is consistent across Python versions</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">coeff_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">coeff_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="n">sl</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="n">offset</span> <span class="o">+</span> <span class="n">d</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
            <span class="n">offset</span> <span class="o">+=</span> <span class="n">d</span><span class="o">.</span><span class="n">size</span>
            <span class="n">coeff_arr</span><span class="p">[</span><span class="n">sl</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
            <span class="n">coeff_slices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">sl</span>
            <span class="n">coeff_shapes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">return</span> <span class="n">coeff_arr</span><span class="p">,</span> <span class="n">coeff_slices</span><span class="p">,</span> <span class="n">coeff_shapes</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.scale2frequency">
<code class="highlight language-python"><span class="n">scale2frequency</span><span class="p">(</span><span class="n">wavelet</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Convert from CWT "scale" to normalized frequency.</p>
<h4 id="pywt.scale2frequency--parameters">Parameters</h4>
<p>wavelet : Wavelet instance or str
    Wavelet to integrate.  If a string, should be the name of a wavelet.
scale : scalar
    The scale of the CWT.
precision : int, optional
    Precision that will be used for wavelet function approximation computed
    with <code>wavelet.wavefun(level=precision)</code>.  Default is 8.</p>
<h4 id="pywt.scale2frequency--returns">Returns</h4>
<p>freq : scalar
    Frequency normalized to the sampling frequency. In other words, for a
    sampling interval of <code>dt</code> seconds, the normalized frequency of 1.0
    corresponds to (<code>1/dt</code> Hz).</p>
<details class="quote">
<summary>Source code in <code>pywt/_functions.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">scale2frequency</span><span class="p">(</span><span class="n">wavelet</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Convert from CWT "scale" to normalized frequency.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavelet : Wavelet instance or str</span>
<span class="sd">        Wavelet to integrate.  If a string, should be the name of a wavelet.</span>
<span class="sd">    scale : scalar</span>
<span class="sd">        The scale of the CWT.</span>
<span class="sd">    precision : int, optional</span>
<span class="sd">        Precision that will be used for wavelet function approximation computed</span>
<span class="sd">        with ``wavelet.wavefun(level=precision)``.  Default is 8.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    freq : scalar</span>
<span class="sd">        Frequency normalized to the sampling frequency. In other words, for a</span>
<span class="sd">        sampling interval of `dt` seconds, the normalized frequency of 1.0</span>
<span class="sd">        corresponds to (`1/dt` Hz).</span>

<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">central_frequency</span><span class="p">(</span><span class="n">wavelet</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span> <span class="o">/</span> <span class="n">scale</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.swt">
<code class="highlight language-python"><span class="n">swt</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">trim_approx</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Multilevel 1D stationary wavelet transform.</p>
<h4 id="pywt.swt--parameters">Parameters</h4>
<p>data :
    Input signal
wavelet :
    Wavelet to use (Wavelet object or name)
level : int, optional
    The number of decomposition steps to perform.
start_level : int, optional
    The level at which the decomposition will begin (it allows one to
    skip a given number of transform steps and compute
    coefficients starting from start_level) (default: 0)
axis: int, optional
    Axis over which to compute the SWT. If not given, the
    last axis is used.
trim_approx : bool, optional
    If True, approximation coefficients at the final level are retained.
norm : bool, optional
    If True, transform is normalized so that the energy of the coefficients
    will be equal to the energy of <code>data</code>. In other words,
    <code>np.linalg.norm(data.ravel())</code> will equal the norm of the
    concatenated transform coefficients when <code>trim_approx</code> is True.</p>
<h4 id="pywt.swt--returns">Returns</h4>
<p>coeffs : list
    List of approximation and details coefficients pairs in order
    similar to wavedec function::</p>
<div class="highlight"><pre><span></span><code>    [(cAn, cDn), ..., (cA2, cD2), (cA1, cD1)]

where n equals input parameter ``level``.

If ``start_level = m`` is given, then the beginning m steps are
skipped::

    [(cAm+n, cDm+n), ..., (cAm+1, cDm+1), (cAm, cDm)]

If ``trim_approx`` is ``True``, then the output list is exactly as in
``pywt.wavedec``, where the first coefficient in the list is the
approximation coefficient at the final level and the rest are the
detail coefficients::

    [cAn, cDn, ..., cD2, cD1]
</code></pre></div>
<h4 id="pywt.swt--notes">Notes</h4>
<p>The implementation here follows the "algorithm a-trous" and requires that
the signal length along the transformed axis be a multiple of <code>2**level</code>.
If this is not the case, the user should pad up to an appropriate size
using a function such as <code>numpy.pad</code>.</p>
<p>A primary benefit of this transform in comparison to its decimated
counterpart (<code>pywt.wavedecn</code>), is that it is shift-invariant. This comes
at cost of redundancy in the transform (the size of the output coefficients
is larger than the input).</p>
<p>When the following three conditions are true:</p>
<div class="highlight"><pre><span></span><code>1. The wavelet is orthogonal
2. ``swt`` is called with ``norm=True``
3. ``swt`` is called with ``trim_approx=True``
</code></pre></div>
<p>the transform has the following additional properties that may be
desirable in applications:</p>
<div class="highlight"><pre><span></span><code>1. energy is conserved
2. variance is partitioned across scales
</code></pre></div>
<p>When used with <code>norm=True</code>, this transform is closely related to the
multiple-overlap DWT (MODWT) as popularized for time-series analysis,
although the underlying implementation is slightly different from the one
published in [1]_. Specifically, the implementation used here requires a
signal that is a multiple of <code>2**level</code> in length.</p>
<h4 id="pywt.swt--references">References</h4>
<p>.. [1] DB Percival and AT Walden. Wavelet Methods for Time Series Analysis.
    Cambridge University Press, 2000.</p>
<details class="quote">
<summary>Source code in <code>pywt/_swt.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">swt</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">trim_approx</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Multilevel 1D stationary wavelet transform.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data :</span>
<span class="sd">        Input signal</span>
<span class="sd">    wavelet :</span>
<span class="sd">        Wavelet to use (Wavelet object or name)</span>
<span class="sd">    level : int, optional</span>
<span class="sd">        The number of decomposition steps to perform.</span>
<span class="sd">    start_level : int, optional</span>
<span class="sd">        The level at which the decomposition will begin (it allows one to</span>
<span class="sd">        skip a given number of transform steps and compute</span>
<span class="sd">        coefficients starting from start_level) (default: 0)</span>
<span class="sd">    axis: int, optional</span>
<span class="sd">        Axis over which to compute the SWT. If not given, the</span>
<span class="sd">        last axis is used.</span>
<span class="sd">    trim_approx : bool, optional</span>
<span class="sd">        If True, approximation coefficients at the final level are retained.</span>
<span class="sd">    norm : bool, optional</span>
<span class="sd">        If True, transform is normalized so that the energy of the coefficients</span>
<span class="sd">        will be equal to the energy of ``data``. In other words,</span>
<span class="sd">        ``np.linalg.norm(data.ravel())`` will equal the norm of the</span>
<span class="sd">        concatenated transform coefficients when ``trim_approx`` is True.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    coeffs : list</span>
<span class="sd">        List of approximation and details coefficients pairs in order</span>
<span class="sd">        similar to wavedec function::</span>

<span class="sd">            [(cAn, cDn), ..., (cA2, cD2), (cA1, cD1)]</span>

<span class="sd">        where n equals input parameter ``level``.</span>

<span class="sd">        If ``start_level = m`` is given, then the beginning m steps are</span>
<span class="sd">        skipped::</span>

<span class="sd">            [(cAm+n, cDm+n), ..., (cAm+1, cDm+1), (cAm, cDm)]</span>

<span class="sd">        If ``trim_approx`` is ``True``, then the output list is exactly as in</span>
<span class="sd">        ``pywt.wavedec``, where the first coefficient in the list is the</span>
<span class="sd">        approximation coefficient at the final level and the rest are the</span>
<span class="sd">        detail coefficients::</span>

<span class="sd">            [cAn, cDn, ..., cD2, cD1]</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The implementation here follows the "algorithm a-trous" and requires that</span>
<span class="sd">    the signal length along the transformed axis be a multiple of ``2**level``.</span>
<span class="sd">    If this is not the case, the user should pad up to an appropriate size</span>
<span class="sd">    using a function such as ``numpy.pad``.</span>

<span class="sd">    A primary benefit of this transform in comparison to its decimated</span>
<span class="sd">    counterpart (``pywt.wavedecn``), is that it is shift-invariant. This comes</span>
<span class="sd">    at cost of redundancy in the transform (the size of the output coefficients</span>
<span class="sd">    is larger than the input).</span>

<span class="sd">    When the following three conditions are true:</span>

<span class="sd">        1. The wavelet is orthogonal</span>
<span class="sd">        2. ``swt`` is called with ``norm=True``</span>
<span class="sd">        3. ``swt`` is called with ``trim_approx=True``</span>

<span class="sd">    the transform has the following additional properties that may be</span>
<span class="sd">    desirable in applications:</span>

<span class="sd">        1. energy is conserved</span>
<span class="sd">        2. variance is partitioned across scales</span>

<span class="sd">    When used with ``norm=True``, this transform is closely related to the</span>
<span class="sd">    multiple-overlap DWT (MODWT) as popularized for time-series analysis,</span>
<span class="sd">    although the underlying implementation is slightly different from the one</span>
<span class="sd">    published in [1]_. Specifically, the implementation used here requires a</span>
<span class="sd">    signal that is a multiple of ``2**level`` in length.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] DB Percival and AT Walden. Wavelet Methods for Time Series Analysis.</span>
<span class="sd">        Cambridge University Press, 2000.</span>
<span class="sd">    """</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">_have_c99_complex</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">iscomplexobj</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"wavelet"</span><span class="p">:</span> <span class="n">wavelet</span><span class="p">,</span> <span class="s2">"level"</span><span class="p">:</span> <span class="n">level</span><span class="p">,</span> <span class="s2">"start_level"</span><span class="p">:</span> <span class="n">start_level</span><span class="p">,</span>
                      <span class="s2">"trim_approx"</span><span class="p">:</span> <span class="n">trim_approx</span><span class="p">,</span> <span class="s2">"axis"</span><span class="p">:</span> <span class="n">axis</span><span class="p">,</span> <span class="s2">"norm"</span><span class="p">:</span> <span class="n">norm</span><span class="p">}</span>
        <span class="n">coeffs_real</span> <span class="o">=</span> <span class="n">swt</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">coeffs_imag</span> <span class="o">=</span> <span class="n">swt</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">trim_approx</span><span class="p">:</span>
            <span class="n">coeffs_cplx</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">cA_r</span><span class="p">,</span> <span class="n">cD_r</span><span class="p">),</span> <span class="p">(</span><span class="n">cA_i</span><span class="p">,</span> <span class="n">cD_i</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">coeffs_real</span><span class="p">,</span> <span class="n">coeffs_imag</span><span class="p">):</span>
                <span class="n">coeffs_cplx</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">cA_r</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">cA_i</span><span class="p">,</span> <span class="n">cD_r</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">cD_i</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">coeffs_cplx</span> <span class="o">=</span> <span class="p">[</span><span class="n">cr</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">ci</span>
                           <span class="k">for</span> <span class="p">(</span><span class="n">cr</span><span class="p">,</span> <span class="n">ci</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">coeffs_real</span><span class="p">,</span> <span class="n">coeffs_imag</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">coeffs_cplx</span>

    <span class="c1"># accept array_like input; make a copy to ensure a contiguous array</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">_check_dtype</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>

    <span class="n">wavelet</span> <span class="o">=</span> <span class="n">_as_wavelet</span><span class="p">(</span><span class="n">wavelet</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">norm</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">wavelet</span><span class="o">.</span><span class="n">orthogonal</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">"norm=True, but the wavelet is not orthogonal: </span><span class="se">\n</span><span class="s2">"</span>
                <span class="s2">"</span><span class="se">\t</span><span class="s2">The conditions for energy preservation are not satisfied."</span><span class="p">)</span>
        <span class="n">wavelet</span> <span class="o">=</span> <span class="n">_rescale_wavelet_filterbank</span><span class="p">(</span><span class="n">wavelet</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">axis</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">axis</span> <span class="o">+</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">axis</span> <span class="o">&lt;</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">AxisError</span><span class="p">(</span><span class="s2">"Axis greater than data dimensions"</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">level</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">level</span> <span class="o">=</span> <span class="n">swt_max_level</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">_swt</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">start_level</span><span class="p">,</span> <span class="n">trim_approx</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">_swt_axis</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">start_level</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">trim_approx</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ret</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.swt2">
<code class="highlight language-python"><span class="n">swt2</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">start_level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">trim_approx</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Multilevel 2D stationary wavelet transform.</p>
<h4 id="pywt.swt2--parameters">Parameters</h4>
<p>data : array_like
    2D array with input data
wavelet : Wavelet object or name string, or 2-tuple of wavelets
    Wavelet to use.  This can also be a tuple of wavelets to apply per
    axis in <code>axes</code>.
level : int
    The number of decomposition steps to perform.
start_level : int, optional
    The level at which the decomposition will start (default: 0)
axes : 2-tuple of ints, optional
    Axes over which to compute the SWT. Repeated elements are not allowed.
trim_approx : bool, optional
    If True, approximation coefficients at the final level are retained.
norm : bool, optional
    If True, transform is normalized so that the energy of the coefficients
    will be equal to the energy of <code>data</code>. In other words,
    <code>np.linalg.norm(data.ravel())</code> will equal the norm of the
    concatenated transform coefficients when <code>trim_approx</code> is True.</p>
<h4 id="pywt.swt2--returns">Returns</h4>
<p>coeffs : list
    Approximation and details coefficients (for <code>start_level = m</code>).
    If <code>trim_approx</code> is <code>False</code>, approximation coefficients are
    retained for all levels::</p>
<div class="highlight"><pre><span></span><code>    [
        (cA_m+level,
            (cH_m+level, cV_m+level, cD_m+level)
        ),
        ...,
        (cA_m+1,
            (cH_m+1, cV_m+1, cD_m+1)
        ),
        (cA_m,
            (cH_m, cV_m, cD_m)
        )
    ]

where cA is approximation, cH is horizontal details, cV is
vertical details, cD is diagonal details and m is ``start_level``.

If ``trim_approx`` is ``True``, approximation coefficients are only
retained at the final level of decomposition. This matches the format
used by ``pywt.wavedec2``::

    [
        cA_m+level,
        (cH_m+level, cV_m+level, cD_m+level),
        ...,
        (cH_m+1, cV_m+1, cD_m+1),
        (cH_m, cV_m, cD_m),
    ]
</code></pre></div>
<h4 id="pywt.swt2--notes">Notes</h4>
<p>The implementation here follows the "algorithm a-trous" and requires that
the signal length along the transformed axes be a multiple of <code>2**level</code>.
If this is not the case, the user should pad up to an appropriate size
using a function such as <code>numpy.pad</code>.</p>
<p>A primary benefit of this transform in comparison to its decimated
counterpart (<code>pywt.wavedecn</code>), is that it is shift-invariant. This comes
at cost of redundancy in the transform (the size of the output coefficients
is larger than the input).</p>
<p>When the following three conditions are true:</p>
<div class="highlight"><pre><span></span><code>1. The wavelet is orthogonal
2. ``swt2`` is called with ``norm=True``
3. ``swt2`` is called with ``trim_approx=True``
</code></pre></div>
<p>the transform has the following additional properties that may be
desirable in applications:</p>
<div class="highlight"><pre><span></span><code>1. energy is conserved
2. variance is partitioned across scales
</code></pre></div>
<details class="quote">
<summary>Source code in <code>pywt/_swt.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">swt2</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">start_level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
         <span class="n">trim_approx</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Multilevel 2D stationary wavelet transform.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : array_like</span>
<span class="sd">        2D array with input data</span>
<span class="sd">    wavelet : Wavelet object or name string, or 2-tuple of wavelets</span>
<span class="sd">        Wavelet to use.  This can also be a tuple of wavelets to apply per</span>
<span class="sd">        axis in ``axes``.</span>
<span class="sd">    level : int</span>
<span class="sd">        The number of decomposition steps to perform.</span>
<span class="sd">    start_level : int, optional</span>
<span class="sd">        The level at which the decomposition will start (default: 0)</span>
<span class="sd">    axes : 2-tuple of ints, optional</span>
<span class="sd">        Axes over which to compute the SWT. Repeated elements are not allowed.</span>
<span class="sd">    trim_approx : bool, optional</span>
<span class="sd">        If True, approximation coefficients at the final level are retained.</span>
<span class="sd">    norm : bool, optional</span>
<span class="sd">        If True, transform is normalized so that the energy of the coefficients</span>
<span class="sd">        will be equal to the energy of ``data``. In other words,</span>
<span class="sd">        ``np.linalg.norm(data.ravel())`` will equal the norm of the</span>
<span class="sd">        concatenated transform coefficients when ``trim_approx`` is True.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    coeffs : list</span>
<span class="sd">        Approximation and details coefficients (for ``start_level = m``).</span>
<span class="sd">        If ``trim_approx`` is ``False``, approximation coefficients are</span>
<span class="sd">        retained for all levels::</span>

<span class="sd">            [</span>
<span class="sd">                (cA_m+level,</span>
<span class="sd">                    (cH_m+level, cV_m+level, cD_m+level)</span>
<span class="sd">                ),</span>
<span class="sd">                ...,</span>
<span class="sd">                (cA_m+1,</span>
<span class="sd">                    (cH_m+1, cV_m+1, cD_m+1)</span>
<span class="sd">                ),</span>
<span class="sd">                (cA_m,</span>
<span class="sd">                    (cH_m, cV_m, cD_m)</span>
<span class="sd">                )</span>
<span class="sd">            ]</span>

<span class="sd">        where cA is approximation, cH is horizontal details, cV is</span>
<span class="sd">        vertical details, cD is diagonal details and m is ``start_level``.</span>

<span class="sd">        If ``trim_approx`` is ``True``, approximation coefficients are only</span>
<span class="sd">        retained at the final level of decomposition. This matches the format</span>
<span class="sd">        used by ``pywt.wavedec2``::</span>

<span class="sd">            [</span>
<span class="sd">                cA_m+level,</span>
<span class="sd">                (cH_m+level, cV_m+level, cD_m+level),</span>
<span class="sd">                ...,</span>
<span class="sd">                (cH_m+1, cV_m+1, cD_m+1),</span>
<span class="sd">                (cH_m, cV_m, cD_m),</span>
<span class="sd">            ]</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The implementation here follows the "algorithm a-trous" and requires that</span>
<span class="sd">    the signal length along the transformed axes be a multiple of ``2**level``.</span>
<span class="sd">    If this is not the case, the user should pad up to an appropriate size</span>
<span class="sd">    using a function such as ``numpy.pad``.</span>

<span class="sd">    A primary benefit of this transform in comparison to its decimated</span>
<span class="sd">    counterpart (``pywt.wavedecn``), is that it is shift-invariant. This comes</span>
<span class="sd">    at cost of redundancy in the transform (the size of the output coefficients</span>
<span class="sd">    is larger than the input).</span>

<span class="sd">    When the following three conditions are true:</span>

<span class="sd">        1. The wavelet is orthogonal</span>
<span class="sd">        2. ``swt2`` is called with ``norm=True``</span>
<span class="sd">        3. ``swt2`` is called with ``trim_approx=True``</span>

<span class="sd">    the transform has the following additional properties that may be</span>
<span class="sd">    desirable in applications:</span>

<span class="sd">        1. energy is conserved</span>
<span class="sd">        2. variance is partitioned across scales</span>

<span class="sd">    """</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Expected 2 axes"</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">axes</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"The axes passed to swt2 must be unique."</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">axes</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Input array has fewer dimensions than the specified "</span>
                         <span class="s2">"axes"</span><span class="p">)</span>

    <span class="n">coefs</span> <span class="o">=</span> <span class="n">swtn</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">start_level</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">trim_approx</span><span class="p">,</span> <span class="n">norm</span><span class="p">)</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">trim_approx</span><span class="p">:</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coefs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">coefs</span> <span class="o">=</span> <span class="n">coefs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">coefs</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">trim_approx</span><span class="p">:</span>
            <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">c</span><span class="p">[</span><span class="s1">'da'</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="s1">'ad'</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="s1">'dd'</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">c</span><span class="p">[</span><span class="s1">'aa'</span><span class="p">],</span> <span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="s1">'da'</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="s1">'ad'</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="s1">'dd'</span><span class="p">])))</span>
    <span class="k">return</span> <span class="n">ret</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.swtn">
<code class="highlight language-python"><span class="n">swtn</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">start_level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">trim_approx</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>n-dimensional stationary wavelet transform.</p>
<h4 id="pywt.swtn--parameters">Parameters</h4>
<p>data : array_like
    n-dimensional array with input data.
wavelet : Wavelet object or name string, or tuple of wavelets
    Wavelet to use.  This can also be a tuple of wavelets to apply per
    axis in <code>axes</code>.
level : int
    The number of decomposition steps to perform.
start_level : int, optional
    The level at which the decomposition will start (default: 0)
axes : sequence of ints, optional
    Axes over which to compute the SWT. A value of <code>None</code> (the
    default) selects all axes. Axes may not be repeated.
trim_approx : bool, optional
    If True, approximation coefficients at the final level are retained.
norm : bool, optional
    If True, transform is normalized so that the energy of the coefficients
    will be equal to the energy of <code>data</code>. In other words,
    <code>np.linalg.norm(data.ravel())</code> will equal the norm of the
    concatenated transform coefficients when <code>trim_approx</code> is True.</p>
<h4 id="pywt.swtn--returns">Returns</h4>
<p>[{coeffs_level_n}, ..., {coeffs_level_1}]: list of dict
    Results for each level are arranged in a dictionary, where the key
    specifies the transform type on each dimension and value is a
    n-dimensional coefficients array.</p>
<div class="highlight"><pre><span></span><code>For example, for a 2D case the result at a given level will look
something like this::

    {'aa': &lt;coeffs&gt;  # A(LL) - approx. on 1st dim, approx. on 2nd dim
     'ad': &lt;coeffs&gt;  # V(LH) - approx. on 1st dim, det. on 2nd dim
     'da': &lt;coeffs&gt;  # H(HL) - det. on 1st dim, approx. on 2nd dim
     'dd': &lt;coeffs&gt;  # D(HH) - det. on 1st dim, det. on 2nd dim
    }

For user-specified ``axes``, the order of the characters in the
dictionary keys map to the specified ``axes``.

If ``trim_approx`` is ``True``, the first element of the list contains
the array of approximation coefficients from the final level of
decomposition, while the remaining coefficient dictionaries contain
only detail coefficients. This matches the behavior of `pywt.wavedecn`.
</code></pre></div>
<h4 id="pywt.swtn--notes">Notes</h4>
<p>The implementation here follows the "algorithm a-trous" and requires that
the signal length along the transformed axes be a multiple of <code>2**level</code>.
If this is not the case, the user should pad up to an appropriate size
using a function such as <code>numpy.pad</code>.</p>
<p>A primary benefit of this transform in comparison to its decimated
counterpart (<code>pywt.wavedecn</code>), is that it is shift-invariant. This comes
at cost of redundancy in the transform (the size of the output coefficients
is larger than the input).</p>
<p>When the following three conditions are true:</p>
<div class="highlight"><pre><span></span><code>1. The wavelet is orthogonal
2. ``swtn`` is called with ``norm=True``
3. ``swtn`` is called with ``trim_approx=True``
</code></pre></div>
<p>the transform has the following additional properties that may be
desirable in applications:</p>
<div class="highlight"><pre><span></span><code>1. energy is conserved
2. variance is partitioned across scales
</code></pre></div>
<details class="quote">
<summary>Source code in <code>pywt/_swt.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">swtn</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">start_level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">trim_approx</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
         <span class="n">norm</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    n-dimensional stationary wavelet transform.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : array_like</span>
<span class="sd">        n-dimensional array with input data.</span>
<span class="sd">    wavelet : Wavelet object or name string, or tuple of wavelets</span>
<span class="sd">        Wavelet to use.  This can also be a tuple of wavelets to apply per</span>
<span class="sd">        axis in ``axes``.</span>
<span class="sd">    level : int</span>
<span class="sd">        The number of decomposition steps to perform.</span>
<span class="sd">    start_level : int, optional</span>
<span class="sd">        The level at which the decomposition will start (default: 0)</span>
<span class="sd">    axes : sequence of ints, optional</span>
<span class="sd">        Axes over which to compute the SWT. A value of ``None`` (the</span>
<span class="sd">        default) selects all axes. Axes may not be repeated.</span>
<span class="sd">    trim_approx : bool, optional</span>
<span class="sd">        If True, approximation coefficients at the final level are retained.</span>
<span class="sd">    norm : bool, optional</span>
<span class="sd">        If True, transform is normalized so that the energy of the coefficients</span>
<span class="sd">        will be equal to the energy of ``data``. In other words,</span>
<span class="sd">        ``np.linalg.norm(data.ravel())`` will equal the norm of the</span>
<span class="sd">        concatenated transform coefficients when ``trim_approx`` is True.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    [{coeffs_level_n}, ..., {coeffs_level_1}]: list of dict</span>
<span class="sd">        Results for each level are arranged in a dictionary, where the key</span>
<span class="sd">        specifies the transform type on each dimension and value is a</span>
<span class="sd">        n-dimensional coefficients array.</span>

<span class="sd">        For example, for a 2D case the result at a given level will look</span>
<span class="sd">        something like this::</span>

<span class="sd">            {'aa': &lt;coeffs&gt;  # A(LL) - approx. on 1st dim, approx. on 2nd dim</span>
<span class="sd">             'ad': &lt;coeffs&gt;  # V(LH) - approx. on 1st dim, det. on 2nd dim</span>
<span class="sd">             'da': &lt;coeffs&gt;  # H(HL) - det. on 1st dim, approx. on 2nd dim</span>
<span class="sd">             'dd': &lt;coeffs&gt;  # D(HH) - det. on 1st dim, det. on 2nd dim</span>
<span class="sd">            }</span>

<span class="sd">        For user-specified ``axes``, the order of the characters in the</span>
<span class="sd">        dictionary keys map to the specified ``axes``.</span>

<span class="sd">        If ``trim_approx`` is ``True``, the first element of the list contains</span>
<span class="sd">        the array of approximation coefficients from the final level of</span>
<span class="sd">        decomposition, while the remaining coefficient dictionaries contain</span>
<span class="sd">        only detail coefficients. This matches the behavior of `pywt.wavedecn`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The implementation here follows the "algorithm a-trous" and requires that</span>
<span class="sd">    the signal length along the transformed axes be a multiple of ``2**level``.</span>
<span class="sd">    If this is not the case, the user should pad up to an appropriate size</span>
<span class="sd">    using a function such as ``numpy.pad``.</span>

<span class="sd">    A primary benefit of this transform in comparison to its decimated</span>
<span class="sd">    counterpart (``pywt.wavedecn``), is that it is shift-invariant. This comes</span>
<span class="sd">    at cost of redundancy in the transform (the size of the output coefficients</span>
<span class="sd">    is larger than the input).</span>

<span class="sd">    When the following three conditions are true:</span>

<span class="sd">        1. The wavelet is orthogonal</span>
<span class="sd">        2. ``swtn`` is called with ``norm=True``</span>
<span class="sd">        3. ``swtn`` is called with ``trim_approx=True``</span>

<span class="sd">    the transform has the following additional properties that may be</span>
<span class="sd">    desirable in applications:</span>

<span class="sd">        1. energy is conserved</span>
<span class="sd">        2. variance is partitioned across scales</span>

<span class="sd">    """</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_have_c99_complex</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">iscomplexobj</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"wavelet"</span><span class="p">:</span> <span class="n">wavelet</span><span class="p">,</span> <span class="s2">"level"</span><span class="p">:</span> <span class="n">level</span><span class="p">,</span> <span class="s2">"start_level"</span><span class="p">:</span> <span class="n">start_level</span><span class="p">,</span>
                      <span class="s2">"trim_approx"</span><span class="p">:</span> <span class="n">trim_approx</span><span class="p">,</span> <span class="s2">"axes"</span><span class="p">:</span> <span class="n">axes</span><span class="p">,</span> <span class="s2">"norm"</span><span class="p">:</span> <span class="n">norm</span><span class="p">}</span>
        <span class="n">real</span> <span class="o">=</span> <span class="n">swtn</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">imag</span> <span class="o">=</span> <span class="n">swtn</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">trim_approx</span><span class="p">:</span>
            <span class="n">cplx</span> <span class="o">=</span> <span class="p">[</span><span class="n">real</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">imag</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cplx</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">rdict</span><span class="p">,</span> <span class="n">idict</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">real</span><span class="p">[</span><span class="n">offset</span><span class="p">:],</span> <span class="n">imag</span><span class="p">[</span><span class="n">offset</span><span class="p">:]):</span>
            <span class="n">cplx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">rdict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">idict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">rdict</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">cplx</span>

    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s1">'object'</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">"Input must be a numeric array-like"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Input data must be at least 1D"</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="o">+</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">a</span> <span class="o">&gt;=</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">AxisError</span><span class="p">(</span><span class="s2">"Axis greater than data dimensions"</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">axes</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"The axes passed to swtn must be unique."</span><span class="p">)</span>
    <span class="n">num_axes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>

    <span class="n">wavelets</span> <span class="o">=</span> <span class="n">_wavelets_per_axis</span><span class="p">(</span><span class="n">wavelet</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">norm</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">([</span><span class="n">wav</span><span class="o">.</span><span class="n">orthogonal</span> <span class="k">for</span> <span class="n">wav</span> <span class="ow">in</span> <span class="n">wavelets</span><span class="p">]):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">"norm=True, but the wavelets used are not orthogonal: </span><span class="se">\n</span><span class="s2">"</span>
                <span class="s2">"</span><span class="se">\t</span><span class="s2">The conditions for energy preservation are not satisfied."</span><span class="p">)</span>
        <span class="n">wavelets</span> <span class="o">=</span> <span class="p">[</span><span class="n">_rescale_wavelet_filterbank</span><span class="p">(</span><span class="n">wav</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">wav</span> <span class="ow">in</span> <span class="n">wavelets</span><span class="p">]</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start_level</span><span class="p">,</span> <span class="n">start_level</span> <span class="o">+</span> <span class="n">level</span><span class="p">):</span>
        <span class="n">coeffs</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">''</span><span class="p">,</span> <span class="n">data</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">axis</span><span class="p">,</span> <span class="n">wavelet</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">wavelets</span><span class="p">):</span>
            <span class="n">new_coeffs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">subband</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">:</span>
                <span class="n">cA</span><span class="p">,</span> <span class="n">cD</span> <span class="o">=</span> <span class="n">_swt_axis</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start_level</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
                                   <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">new_coeffs</span><span class="o">.</span><span class="n">extend</span><span class="p">([(</span><span class="n">subband</span> <span class="o">+</span> <span class="s1">'a'</span><span class="p">,</span> <span class="n">cA</span><span class="p">),</span>
                                   <span class="p">(</span><span class="n">subband</span> <span class="o">+</span> <span class="s1">'d'</span><span class="p">,</span> <span class="n">cD</span><span class="p">)])</span>
            <span class="n">coeffs</span> <span class="o">=</span> <span class="n">new_coeffs</span>

        <span class="n">coeffs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span>

        <span class="c1"># data for the next level is the approximation coeffs from this level</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="s1">'a'</span> <span class="o">*</span> <span class="n">num_axes</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">trim_approx</span><span class="p">:</span>
            <span class="n">coeffs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">'a'</span> <span class="o">*</span> <span class="n">num_axes</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">trim_approx</span><span class="p">:</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">ret</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">ret</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.threshold">
<code class="highlight language-python"><span class="n">threshold</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'soft'</span><span class="p">,</span> <span class="n">substitute</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Thresholds the input data depending on the mode argument.</p>
<p>In <code>soft</code> thresholding [1]_, data values with absolute value less than
<code>param</code> are replaced with <code>substitute</code>. Data values with absolute value
greater or equal to the thresholding value are shrunk toward zero
by <code>value</code>.  In other words, the new value is
<code>data/np.abs(data) * np.maximum(np.abs(data) - value, 0)</code>.</p>
<p>In <code>hard</code> thresholding, the data values where their absolute value is
less than the value param are replaced with <code>substitute</code>. Data values with
absolute value greater or equal to the thresholding value stay untouched.</p>
<p><code>garrote</code> corresponds to the Non-negative garrote threshold [2]<em>, [3]</em>.
It is intermediate between <code>hard</code> and <code>soft</code> thresholding.  It behaves
like soft thresholding for small data values and approaches hard
thresholding for large data values.</p>
<p>In <code>greater</code> thresholding, the data is replaced with <code>substitute</code> where
data is below the thresholding value. Greater data values pass untouched.</p>
<p>In <code>less</code> thresholding, the data is replaced with <code>substitute</code> where data
is above the thresholding value. Lesser data values pass untouched.</p>
<p>Both <code>hard</code> and <code>soft</code> thresholding also support complex-valued data.</p>
<h4 id="pywt.threshold--parameters">Parameters</h4>
<p>data : array_like
    Numeric data.
value : scalar
    Thresholding value.
mode : {'soft', 'hard', 'garrote', 'greater', 'less'}
    Decides the type of thresholding to be applied on input data. Default
    is 'soft'.
substitute : float, optional
    Substitute value (default: 0).</p>
<h4 id="pywt.threshold--returns">Returns</h4>
<p>output : array
    Thresholded array.</p>
<h4 id="pywt.threshold--see-also">See Also</h4>
<p>threshold_firm</p>
<h4 id="pywt.threshold--references">References</h4>
<p>.. [1] D.L. Donoho and I.M. Johnstone. Ideal Spatial Adaptation via
    Wavelet Shrinkage. Biometrika. Vol. 81, No. 3, pp.425-455, 1994.
    DOI:10.1093/biomet/81.3.425
.. [2] L. Breiman. Better Subset Regression Using the Nonnegative Garrote.
    Technometrics, Vol. 37, pp. 373-384, 1995.
    DOI:10.2307/1269730
.. [3] H-Y. Gao.  Wavelet Shrinkage Denoising Using the Non-Negative
    Garrote.  Journal of Computational and Graphical Statistics Vol. 7,
    No. 4, pp.469-488. 1998.
    DOI:10.1080/10618600.1998.10474789</p>
<h4 id="pywt.threshold--examples">Examples</h4>
<blockquote>
<blockquote>
<blockquote>
<p>import numpy as np
import pywt
data = np.linspace(1, 4, 7)
data
array([ 1. ,  1.5,  2. ,  2.5,  3. ,  3.5,  4. ])
pywt.threshold(data, 2, 'soft')
array([ 0. ,  0. ,  0. ,  0.5,  1. ,  1.5,  2. ])
pywt.threshold(data, 2, 'hard')
array([ 0. ,  0. ,  2. ,  2.5,  3. ,  3.5,  4. ])
pywt.threshold(data, 2, 'garrote')
array([ 0.        ,  0.        ,  0.        ,  0.9       ,  1.66666667,
        2.35714286,  3.        ])
pywt.threshold(data, 2, 'greater')
array([ 0. ,  0. ,  2. ,  2.5,  3. ,  3.5,  4. ])
pywt.threshold(data, 2, 'less')
array([ 1. ,  1.5,  2. ,  0. ,  0. ,  0. ,  0. ])</p>
</blockquote>
</blockquote>
</blockquote>
<details class="quote">
<summary>Source code in <code>pywt/_thresholding.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">threshold</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'soft'</span><span class="p">,</span> <span class="n">substitute</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Thresholds the input data depending on the mode argument.</span>

<span class="sd">    In ``soft`` thresholding [1]_, data values with absolute value less than</span>
<span class="sd">    `param` are replaced with `substitute`. Data values with absolute value</span>
<span class="sd">    greater or equal to the thresholding value are shrunk toward zero</span>
<span class="sd">    by `value`.  In other words, the new value is</span>
<span class="sd">    ``data/np.abs(data) * np.maximum(np.abs(data) - value, 0)``.</span>

<span class="sd">    In ``hard`` thresholding, the data values where their absolute value is</span>
<span class="sd">    less than the value param are replaced with `substitute`. Data values with</span>
<span class="sd">    absolute value greater or equal to the thresholding value stay untouched.</span>

<span class="sd">    ``garrote`` corresponds to the Non-negative garrote threshold [2]_, [3]_.</span>
<span class="sd">    It is intermediate between ``hard`` and ``soft`` thresholding.  It behaves</span>
<span class="sd">    like soft thresholding for small data values and approaches hard</span>
<span class="sd">    thresholding for large data values.</span>

<span class="sd">    In ``greater`` thresholding, the data is replaced with `substitute` where</span>
<span class="sd">    data is below the thresholding value. Greater data values pass untouched.</span>

<span class="sd">    In ``less`` thresholding, the data is replaced with `substitute` where data</span>
<span class="sd">    is above the thresholding value. Lesser data values pass untouched.</span>

<span class="sd">    Both ``hard`` and ``soft`` thresholding also support complex-valued data.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : array_like</span>
<span class="sd">        Numeric data.</span>
<span class="sd">    value : scalar</span>
<span class="sd">        Thresholding value.</span>
<span class="sd">    mode : {'soft', 'hard', 'garrote', 'greater', 'less'}</span>
<span class="sd">        Decides the type of thresholding to be applied on input data. Default</span>
<span class="sd">        is 'soft'.</span>
<span class="sd">    substitute : float, optional</span>
<span class="sd">        Substitute value (default: 0).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    output : array</span>
<span class="sd">        Thresholded array.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    threshold_firm</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] D.L. Donoho and I.M. Johnstone. Ideal Spatial Adaptation via</span>
<span class="sd">        Wavelet Shrinkage. Biometrika. Vol. 81, No. 3, pp.425-455, 1994.</span>
<span class="sd">        DOI:10.1093/biomet/81.3.425</span>
<span class="sd">    .. [2] L. Breiman. Better Subset Regression Using the Nonnegative Garrote.</span>
<span class="sd">        Technometrics, Vol. 37, pp. 373-384, 1995.</span>
<span class="sd">        DOI:10.2307/1269730</span>
<span class="sd">    .. [3] H-Y. Gao.  Wavelet Shrinkage Denoising Using the Non-Negative</span>
<span class="sd">        Garrote.  Journal of Computational and Graphical Statistics Vol. 7,</span>
<span class="sd">        No. 4, pp.469-488. 1998.</span>
<span class="sd">        DOI:10.1080/10618600.1998.10474789</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; import pywt</span>
<span class="sd">    &gt;&gt;&gt; data = np.linspace(1, 4, 7)</span>
<span class="sd">    &gt;&gt;&gt; data</span>
<span class="sd">    array([ 1. ,  1.5,  2. ,  2.5,  3. ,  3.5,  4. ])</span>
<span class="sd">    &gt;&gt;&gt; pywt.threshold(data, 2, 'soft')</span>
<span class="sd">    array([ 0. ,  0. ,  0. ,  0.5,  1. ,  1.5,  2. ])</span>
<span class="sd">    &gt;&gt;&gt; pywt.threshold(data, 2, 'hard')</span>
<span class="sd">    array([ 0. ,  0. ,  2. ,  2.5,  3. ,  3.5,  4. ])</span>
<span class="sd">    &gt;&gt;&gt; pywt.threshold(data, 2, 'garrote')</span>
<span class="sd">    array([ 0.        ,  0.        ,  0.        ,  0.9       ,  1.66666667,</span>
<span class="sd">            2.35714286,  3.        ])</span>
<span class="sd">    &gt;&gt;&gt; pywt.threshold(data, 2, 'greater')</span>
<span class="sd">    array([ 0. ,  0. ,  2. ,  2.5,  3. ,  3.5,  4. ])</span>
<span class="sd">    &gt;&gt;&gt; pywt.threshold(data, 2, 'less')</span>
<span class="sd">    array([ 1. ,  1.5,  2. ,  0. ,  0. ,  0. ,  0. ])</span>

<span class="sd">    """</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">thresholding_options</span><span class="p">[</span><span class="n">mode</span><span class="p">](</span><span class="n">data</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">substitute</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="c1"># Make sure error is always identical by sorting keys</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">"'</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">'"</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span>
                <span class="nb">sorted</span><span class="p">(</span><span class="n">thresholding_options</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"The mode parameter only takes values from: </span><span class="si">{}</span><span class="s2">."</span>
                         <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">', '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">keys</span><span class="p">)))</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.threshold_firm">
<code class="highlight language-python"><span class="n">threshold_firm</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">value_low</span><span class="p">,</span> <span class="n">value_high</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Firm threshold.</p>
<p>The approach is intermediate between soft and hard thresholding [1]_. It
behaves the same as soft-thresholding for values below <code>value_low</code> and
the same as hard-thresholding for values above <code>thresh_high</code>.  For
intermediate values, the thresholded value is in between that corresponding
to soft or hard thresholding.</p>
<h4 id="pywt.threshold_firm--parameters">Parameters</h4>
<p>data : array-like
    The data to threshold.  This can be either real or complex-valued.
value_low : float
    Any values smaller then <code>value_low</code> will be set to zero.
value_high : float
    Any values larger than <code>value_high</code> will not be modified.</p>
<h4 id="pywt.threshold_firm--notes">Notes</h4>
<p>This thresholding technique is also known as semi-soft thresholding [2]_.</p>
<p>For each value, <code>x</code>, in <code>data</code>. This function computes::</p>
<div class="highlight"><pre><span></span><code>if np.abs(x) &lt;= value_low:
    return 0
elif np.abs(x) &gt; value_high:
    return x
elif value_low &lt; np.abs(x) and np.abs(x) &lt;= value_high:
    return x * value_high * (1 - value_low/x)/(value_high - value_low)
</code></pre></div>
<p><code>firm</code> is a continuous function (like soft thresholding), but is
unbiased for large values (like hard thresholding).</p>
<p>If <code>value_high == value_low</code> this function becomes hard-thresholding.
If <code>value_high</code> is infinity, this function becomes soft-thresholding.</p>
<h4 id="pywt.threshold_firm--returns">Returns</h4>
<p>val_new : array-like
    The values after firm thresholding at the specified thresholds.</p>
<h4 id="pywt.threshold_firm--see-also">See Also</h4>
<p>threshold</p>
<h4 id="pywt.threshold_firm--references">References</h4>
<p>.. [1] H.-Y. Gao and A.G. Bruce. Waveshrink with firm shrinkage.
    Statistica Sinica, Vol. 7, pp. 855-874, 1997.
.. [2] A. Bruce and H-Y. Gao. WaveShrink: Shrinkage Functions and
    Thresholds. Proc. SPIE 2569, Wavelet Applications in Signal and
    Image Processing III, 1995.
    DOI:10.1117/12.217582</p>
<details class="quote">
<summary>Source code in <code>pywt/_thresholding.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">threshold_firm</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">value_low</span><span class="p">,</span> <span class="n">value_high</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Firm threshold.</span>

<span class="sd">    The approach is intermediate between soft and hard thresholding [1]_. It</span>
<span class="sd">    behaves the same as soft-thresholding for values below `value_low` and</span>
<span class="sd">    the same as hard-thresholding for values above `thresh_high`.  For</span>
<span class="sd">    intermediate values, the thresholded value is in between that corresponding</span>
<span class="sd">    to soft or hard thresholding.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : array-like</span>
<span class="sd">        The data to threshold.  This can be either real or complex-valued.</span>
<span class="sd">    value_low : float</span>
<span class="sd">        Any values smaller then `value_low` will be set to zero.</span>
<span class="sd">    value_high : float</span>
<span class="sd">        Any values larger than `value_high` will not be modified.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This thresholding technique is also known as semi-soft thresholding [2]_.</span>

<span class="sd">    For each value, `x`, in `data`. This function computes::</span>

<span class="sd">        if np.abs(x) &lt;= value_low:</span>
<span class="sd">            return 0</span>
<span class="sd">        elif np.abs(x) &gt; value_high:</span>
<span class="sd">            return x</span>
<span class="sd">        elif value_low &lt; np.abs(x) and np.abs(x) &lt;= value_high:</span>
<span class="sd">            return x * value_high * (1 - value_low/x)/(value_high - value_low)</span>

<span class="sd">    ``firm`` is a continuous function (like soft thresholding), but is</span>
<span class="sd">    unbiased for large values (like hard thresholding).</span>

<span class="sd">    If ``value_high == value_low`` this function becomes hard-thresholding.</span>
<span class="sd">    If ``value_high`` is infinity, this function becomes soft-thresholding.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    val_new : array-like</span>
<span class="sd">        The values after firm thresholding at the specified thresholds.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    threshold</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] H.-Y. Gao and A.G. Bruce. Waveshrink with firm shrinkage.</span>
<span class="sd">        Statistica Sinica, Vol. 7, pp. 855-874, 1997.</span>
<span class="sd">    .. [2] A. Bruce and H-Y. Gao. WaveShrink: Shrinkage Functions and</span>
<span class="sd">        Thresholds. Proc. SPIE 2569, Wavelet Applications in Signal and</span>
<span class="sd">        Image Processing III, 1995.</span>
<span class="sd">        DOI:10.1117/12.217582</span>
<span class="sd">    """</span>

    <span class="k">if</span> <span class="n">value_low</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"value_low must be non-negative."</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">value_high</span> <span class="o">&lt;</span> <span class="n">value_low</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">"value_high must be greater than or equal to value_low."</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">magnitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">'ignore'</span><span class="p">):</span>
        <span class="c1"># divide by zero okay as np.inf values get clipped, so ignore warning.</span>
        <span class="n">vdiff</span> <span class="o">=</span> <span class="n">value_high</span> <span class="o">-</span> <span class="n">value_low</span>
        <span class="n">thresholded</span> <span class="o">=</span> <span class="n">value_high</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">value_low</span><span class="o">/</span><span class="n">magnitude</span><span class="p">)</span> <span class="o">/</span> <span class="n">vdiff</span>
        <span class="n">thresholded</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">thresholded</span><span class="p">)</span>
        <span class="n">thresholded</span> <span class="o">=</span> <span class="n">data</span> <span class="o">*</span> <span class="n">thresholded</span>

    <span class="c1"># restore hard-thresholding behavior for values &gt; value_high</span>
    <span class="n">large_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">magnitude</span> <span class="o">&gt;</span> <span class="n">value_high</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">large_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">thresholded</span><span class="p">[</span><span class="n">large_vals</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">large_vals</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">thresholded</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.unravel_coeffs">
<code class="highlight language-python"><span class="n">unravel_coeffs</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">coeff_slices</span><span class="p">,</span> <span class="n">coeff_shapes</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="s1">'wavedecn'</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Unravel a raveled array of multilevel wavelet coefficients.</p>
<h4 id="pywt.unravel_coeffs--parameters">Parameters</h4>
<p>arr : array-like
    An array containing all wavelet coefficients. This should have been
    generated by applying <code>ravel_coeffs</code> to the output of <code>wavedec</code>,
    <code>wavedec2</code> or <code>wavedecn</code> (or via <code>swt</code>, <code>swt2</code> or <code>swtn</code>
    with <code>trim_approx=True</code>).
coeff_slices : list of tuples
    List of slices corresponding to each coefficient as obtained from
    <code>ravel_coeffs</code>.
coeff_shapes : list of tuples
    List of shapes corresponding to each coefficient as obtained from
    <code>ravel_coeffs</code>.
output_format : {'wavedec', 'wavedec2', 'wavedecn', 'swt', 'swt2', 'swtn'}, optional
    Make the form of the unraveled coefficients compatible with this type
    of multilevel transform. The default is <code>'wavedecn'</code>.</p>
<h4 id="pywt.unravel_coeffs--returns">Returns</h4>
<p>coeffs: list
    List of wavelet transform coefficients. The specific format of the list
    elements is determined by <code>output_format</code>.</p>
<h4 id="pywt.unravel_coeffs--see-also">See Also</h4>
<p>ravel_coeffs : the inverse of unravel_coeffs</p>
<h4 id="pywt.unravel_coeffs--examples">Examples</h4>
<blockquote>
<blockquote>
<blockquote>
<p>import pywt
from numpy.testing import assert_array_almost_equal
cam = pywt.data.camera()
coeffs = pywt.wavedecn(cam, wavelet='db2', level=3)
arr, coeff_slices, coeff_shapes = pywt.ravel_coeffs(coeffs)
coeffs_from_arr = pywt.unravel_coeffs(arr, coeff_slices, coeff_shapes,
...                                       output_format='wavedecn')
cam_recon = pywt.waverecn(coeffs_from_arr, wavelet='db2')
assert_array_almost_equal(cam, cam_recon)</p>
</blockquote>
</blockquote>
</blockquote>
<details class="quote">
<summary>Source code in <code>pywt/_multilevel.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">unravel_coeffs</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">coeff_slices</span><span class="p">,</span> <span class="n">coeff_shapes</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="s1">'wavedecn'</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Unravel a raveled array of multilevel wavelet coefficients.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    arr : array-like</span>
<span class="sd">        An array containing all wavelet coefficients. This should have been</span>
<span class="sd">        generated by applying ``ravel_coeffs`` to the output of ``wavedec``,</span>
<span class="sd">        ``wavedec2`` or ``wavedecn`` (or via ``swt``, ``swt2`` or ``swtn``</span>
<span class="sd">        with ``trim_approx=True``).</span>
<span class="sd">    coeff_slices : list of tuples</span>
<span class="sd">        List of slices corresponding to each coefficient as obtained from</span>
<span class="sd">        ``ravel_coeffs``.</span>
<span class="sd">    coeff_shapes : list of tuples</span>
<span class="sd">        List of shapes corresponding to each coefficient as obtained from</span>
<span class="sd">        ``ravel_coeffs``.</span>
<span class="sd">    output_format : {'wavedec', 'wavedec2', 'wavedecn', 'swt', 'swt2', 'swtn'}, optional</span>
<span class="sd">        Make the form of the unraveled coefficients compatible with this type</span>
<span class="sd">        of multilevel transform. The default is ``'wavedecn'``.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    coeffs: list</span>
<span class="sd">        List of wavelet transform coefficients. The specific format of the list</span>
<span class="sd">        elements is determined by ``output_format``.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    ravel_coeffs : the inverse of unravel_coeffs</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import pywt</span>
<span class="sd">    &gt;&gt;&gt; from numpy.testing import assert_array_almost_equal</span>
<span class="sd">    &gt;&gt;&gt; cam = pywt.data.camera()</span>
<span class="sd">    &gt;&gt;&gt; coeffs = pywt.wavedecn(cam, wavelet='db2', level=3)</span>
<span class="sd">    &gt;&gt;&gt; arr, coeff_slices, coeff_shapes = pywt.ravel_coeffs(coeffs)</span>
<span class="sd">    &gt;&gt;&gt; coeffs_from_arr = pywt.unravel_coeffs(arr, coeff_slices, coeff_shapes,</span>
<span class="sd">    ...                                       output_format='wavedecn')</span>
<span class="sd">    &gt;&gt;&gt; cam_recon = pywt.waverecn(coeffs_from_arr, wavelet='db2')</span>
<span class="sd">    &gt;&gt;&gt; assert_array_almost_equal(cam, cam_recon)</span>

<span class="sd">    """</span>
    <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
    <span class="n">coeffs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">coeff_slices</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"empty list of coefficient slices"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">coeff_shapes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"empty list of coefficient shapes"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">coeff_shapes</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">coeff_slices</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"coeff_shapes and coeff_slices have unequal length"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">coeffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">coeff_slices</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">coeff_shapes</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

    <span class="c1"># difference coefficients at each level</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">coeff_slices</span><span class="p">)):</span>
        <span class="n">slice_dict</span> <span class="o">=</span> <span class="n">coeff_slices</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
        <span class="n">shape_dict</span> <span class="o">=</span> <span class="n">coeff_shapes</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">output_format</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'wavedec'</span><span class="p">,</span> <span class="s1">'swt'</span><span class="p">]:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">slice_dict</span><span class="p">[</span><span class="s1">'d'</span><span class="p">]]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">shape_dict</span><span class="p">[</span><span class="s1">'d'</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">output_format</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'wavedec2'</span><span class="p">,</span> <span class="s1">'swt2'</span><span class="p">]:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">slice_dict</span><span class="p">[</span><span class="s1">'da'</span><span class="p">]]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">shape_dict</span><span class="p">[</span><span class="s1">'da'</span><span class="p">]),</span>
                 <span class="n">arr</span><span class="p">[</span><span class="n">slice_dict</span><span class="p">[</span><span class="s1">'ad'</span><span class="p">]]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">shape_dict</span><span class="p">[</span><span class="s1">'ad'</span><span class="p">]),</span>
                 <span class="n">arr</span><span class="p">[</span><span class="n">slice_dict</span><span class="p">[</span><span class="s1">'dd'</span><span class="p">]]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">shape_dict</span><span class="p">[</span><span class="s1">'dd'</span><span class="p">]))</span>
        <span class="k">elif</span> <span class="n">output_format</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'wavedecn'</span><span class="p">,</span> <span class="s1">'swtn'</span><span class="p">]:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">coeff_slices</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">shape_dict</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">"Unrecognized output format: </span><span class="si">{</span><span class="n">output_format</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">coeffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">coeffs</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.upcoef">
<code class="highlight language-python"><span class="n">upcoef</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">take</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>upcoef(part, coeffs, wavelet, level=1, take=0)</p>
<p>Direct reconstruction from coefficients.</p>
<h4 id="pywt.upcoef--parameters">Parameters</h4>
<p>part : str
    Coefficients type:
    * 'a' - approximations reconstruction is performed
    * 'd' - details reconstruction is performed
coeffs : array_like
    Coefficients array to reconstruct
wavelet : Wavelet object or name
    Wavelet to use
level : int, optional
    Multilevel reconstruction level.  Default is 1.
take : int, optional
    Take central part of length equal to 'take' from the result.
    Default is 0.</p>
<h4 id="pywt.upcoef--returns">Returns</h4>
<p>rec : ndarray
    1-D array with reconstructed data from coefficients.</p>
<h4 id="pywt.upcoef--see-also">See Also</h4>
<p>downcoef</p>
<h4 id="pywt.upcoef--examples">Examples</h4>
<blockquote>
<blockquote>
<blockquote>
<p>import pywt
data = [1,2,3,4,5,6]
(cA, cD) = pywt.dwt(data, 'db2', 'smooth')
pywt.upcoef('a', cA, 'db2') + pywt.upcoef('d', cD, 'db2')
array([-0.25      , -0.4330127 ,  1.        ,  2.        ,  3.        ,
        4.        ,  5.        ,  6.        ,  1.78589838, -1.03108891])
n = len(data)
pywt.upcoef('a', cA, 'db2', take=n) + pywt.upcoef('d', cD, 'db2', take=n)
array([ 1.,  2.,  3.,  4.,  5.,  6.])</p>
</blockquote>
</blockquote>
</blockquote>
<details class="quote">
<summary>Source code in <code>pywt/_dwt.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">upcoef</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">take</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    upcoef(part, coeffs, wavelet, level=1, take=0)</span>

<span class="sd">    Direct reconstruction from coefficients.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    part : str</span>
<span class="sd">        Coefficients type:</span>
<span class="sd">        * 'a' - approximations reconstruction is performed</span>
<span class="sd">        * 'd' - details reconstruction is performed</span>
<span class="sd">    coeffs : array_like</span>
<span class="sd">        Coefficients array to reconstruct</span>
<span class="sd">    wavelet : Wavelet object or name</span>
<span class="sd">        Wavelet to use</span>
<span class="sd">    level : int, optional</span>
<span class="sd">        Multilevel reconstruction level.  Default is 1.</span>
<span class="sd">    take : int, optional</span>
<span class="sd">        Take central part of length equal to 'take' from the result.</span>
<span class="sd">        Default is 0.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    rec : ndarray</span>
<span class="sd">        1-D array with reconstructed data from coefficients.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    downcoef</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import pywt</span>
<span class="sd">    &gt;&gt;&gt; data = [1,2,3,4,5,6]</span>
<span class="sd">    &gt;&gt;&gt; (cA, cD) = pywt.dwt(data, 'db2', 'smooth')</span>
<span class="sd">    &gt;&gt;&gt; pywt.upcoef('a', cA, 'db2') + pywt.upcoef('d', cD, 'db2')</span>
<span class="sd">    array([-0.25      , -0.4330127 ,  1.        ,  2.        ,  3.        ,</span>
<span class="sd">            4.        ,  5.        ,  6.        ,  1.78589838, -1.03108891])</span>
<span class="sd">    &gt;&gt;&gt; n = len(data)</span>
<span class="sd">    &gt;&gt;&gt; pywt.upcoef('a', cA, 'db2', take=n) + pywt.upcoef('d', cD, 'db2', take=n)</span>
<span class="sd">    array([ 1.,  2.,  3.,  4.,  5.,  6.])</span>

<span class="sd">    """</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_have_c99_complex</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">iscomplexobj</span><span class="p">(</span><span class="n">coeffs</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">upcoef</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">coeffs</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">take</span><span class="p">)</span> <span class="o">+</span>
                <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">upcoef</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">coeffs</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">take</span><span class="p">))</span>
    <span class="c1"># accept array_like input; make a copy to ensure a contiguous array</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">_check_dtype</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span>
    <span class="n">coeffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">'C'</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">coeffs</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"upcoef only supports 1d coeffs."</span><span class="p">)</span>
    <span class="n">wavelet</span> <span class="o">=</span> <span class="n">_as_wavelet</span><span class="p">(</span><span class="n">wavelet</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">part</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s1">'ad'</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Argument 1 must be 'a' or 'd', not '</span><span class="si">{</span><span class="n">part</span><span class="si">}</span><span class="s2">'."</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">_upcoef</span><span class="p">(</span><span class="n">part</span> <span class="o">==</span> <span class="s1">'a'</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">take</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.wavedec">
<code class="highlight language-python"><span class="n">wavedec</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Multilevel 1D Discrete Wavelet Transform of data.</p>
<h4 id="pywt.wavedec--parameters">Parameters</h4>
<p>data: array_like
    Input data
wavelet : Wavelet object or name string
    Wavelet to use
mode : str, optional
    Signal extension mode, see :ref:<code>Modes &lt;ref-modes&gt;</code>.
level : int, optional
    Decomposition level (must be &gt;= 0). If level is None (default) then it
    will be calculated using the <code>dwt_max_level</code> function.
axis: int, optional
    Axis over which to compute the DWT. If not given, the
    last axis is used.</p>
<h4 id="pywt.wavedec--returns">Returns</h4>
<p>[cA_n, cD_n, cD_n-1, ..., cD2, cD1] : list
    Ordered list of coefficients arrays
    where <code>n</code> denotes the level of decomposition. The first element
    (<code>cA_n</code>) of the result is approximation coefficients array and the
    following elements (<code>cD_n</code> - <code>cD_1</code>) are details coefficients
    arrays.</p>
<h4 id="pywt.wavedec--examples">Examples</h4>
<blockquote>
<blockquote>
<blockquote>
<p>from pywt import wavedec
coeffs = wavedec([1,2,3,4,5,6,7,8], 'db1', level=2)
cA2, cD2, cD1 = coeffs
cD1
array([-0.70710678, -0.70710678, -0.70710678, -0.70710678])
cD2
array([-2., -2.])
cA2
array([  5.,  13.])</p>
</blockquote>
</blockquote>
</blockquote>
<details class="quote">
<summary>Source code in <code>pywt/_multilevel.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">wavedec</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Multilevel 1D Discrete Wavelet Transform of data.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data: array_like</span>
<span class="sd">        Input data</span>
<span class="sd">    wavelet : Wavelet object or name string</span>
<span class="sd">        Wavelet to use</span>
<span class="sd">    mode : str, optional</span>
<span class="sd">        Signal extension mode, see :ref:`Modes &lt;ref-modes&gt;`.</span>
<span class="sd">    level : int, optional</span>
<span class="sd">        Decomposition level (must be &gt;= 0). If level is None (default) then it</span>
<span class="sd">        will be calculated using the ``dwt_max_level`` function.</span>
<span class="sd">    axis: int, optional</span>
<span class="sd">        Axis over which to compute the DWT. If not given, the</span>
<span class="sd">        last axis is used.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    [cA_n, cD_n, cD_n-1, ..., cD2, cD1] : list</span>
<span class="sd">        Ordered list of coefficients arrays</span>
<span class="sd">        where ``n`` denotes the level of decomposition. The first element</span>
<span class="sd">        (``cA_n``) of the result is approximation coefficients array and the</span>
<span class="sd">        following elements (``cD_n`` - ``cD_1``) are details coefficients</span>
<span class="sd">        arrays.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from pywt import wavedec</span>
<span class="sd">    &gt;&gt;&gt; coeffs = wavedec([1,2,3,4,5,6,7,8], 'db1', level=2)</span>
<span class="sd">    &gt;&gt;&gt; cA2, cD2, cD1 = coeffs</span>
<span class="sd">    &gt;&gt;&gt; cD1</span>
<span class="sd">    array([-0.70710678, -0.70710678, -0.70710678, -0.70710678])</span>
<span class="sd">    &gt;&gt;&gt; cD2</span>
<span class="sd">    array([-2., -2.])</span>
<span class="sd">    &gt;&gt;&gt; cA2</span>
<span class="sd">    array([  5.,  13.])</span>

<span class="sd">    """</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="n">wavelet</span> <span class="o">=</span> <span class="n">_as_wavelet</span><span class="p">(</span><span class="n">wavelet</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">axes_shape</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">AxisError</span><span class="p">(</span><span class="s2">"Axis greater than data dimensions"</span><span class="p">)</span>
    <span class="n">level</span> <span class="o">=</span> <span class="n">_check_level</span><span class="p">(</span><span class="n">axes_shape</span><span class="p">,</span> <span class="n">wavelet</span><span class="o">.</span><span class="n">dec_len</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>

    <span class="n">coeffs_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">data</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">level</span><span class="p">):</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">dwt</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
        <span class="n">coeffs_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

    <span class="n">coeffs_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">coeffs_list</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">coeffs_list</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.wavedec2">
<code class="highlight language-python"><span class="n">wavedec2</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span></code>
</h2>
<div class="doc doc-contents">
<p>Multilevel 2D Discrete Wavelet Transform.</p>
<h4 id="pywt.wavedec2--parameters">Parameters</h4>
<p>data : ndarray
    2D input data
wavelet : Wavelet object or name string, or 2-tuple of wavelets
    Wavelet to use.  This can also be a tuple containing a wavelet to
    apply along each axis in <code>axes</code>.
mode : str or 2-tuple of str, optional
    Signal extension mode, see :ref:<code>Modes &lt;ref-modes&gt;</code>. This can
    also be a tuple containing a mode to apply along each axis in <code>axes</code>.
level : int, optional
    Decomposition level (must be &gt;= 0). If level is None (default) then it
    will be calculated using the <code>dwt_max_level</code> function.
axes : 2-tuple of ints, optional
    Axes over which to compute the DWT. Repeated elements are not allowed.</p>
<h4 id="pywt.wavedec2--returns">Returns</h4>
<p>[cAn, (cHn, cVn, cDn), ... (cH1, cV1, cD1)] : list
    Coefficients list.  For user-specified <code>axes</code>, <code>cH*</code>
    corresponds to <code>axes[0]</code> while <code>cV*</code> corresponds to <code>axes[1]</code>.
    The first element returned is the approximation coefficients for the
    nth level of decomposition.  Remaining elements are tuples of detail
    coefficients in descending order of decomposition level.
    (i.e. <code>cH1</code> are the horizontal detail coefficients at the first
    level)</p>
<h4 id="pywt.wavedec2--examples">Examples</h4>
<blockquote>
<blockquote>
<blockquote>
<p>import pywt
import numpy as np
coeffs = pywt.wavedec2(np.ones((4,4)), 'db1')</p>
<h3 id="pywt.wavedec2--levels">Levels:</h3>
<p>len(coeffs)-1
2
pywt.waverec2(coeffs, 'db1')
array([[ 1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.]])</p>
</blockquote>
</blockquote>
</blockquote>
<details class="quote">
<summary>Source code in <code>pywt/_multilevel.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">wavedec2</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Multilevel 2D Discrete Wavelet Transform.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">        2D input data</span>
<span class="sd">    wavelet : Wavelet object or name string, or 2-tuple of wavelets</span>
<span class="sd">        Wavelet to use.  This can also be a tuple containing a wavelet to</span>
<span class="sd">        apply along each axis in ``axes``.</span>
<span class="sd">    mode : str or 2-tuple of str, optional</span>
<span class="sd">        Signal extension mode, see :ref:`Modes &lt;ref-modes&gt;`. This can</span>
<span class="sd">        also be a tuple containing a mode to apply along each axis in ``axes``.</span>
<span class="sd">    level : int, optional</span>
<span class="sd">        Decomposition level (must be &gt;= 0). If level is None (default) then it</span>
<span class="sd">        will be calculated using the ``dwt_max_level`` function.</span>
<span class="sd">    axes : 2-tuple of ints, optional</span>
<span class="sd">        Axes over which to compute the DWT. Repeated elements are not allowed.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    [cAn, (cHn, cVn, cDn), ... (cH1, cV1, cD1)] : list</span>
<span class="sd">        Coefficients list.  For user-specified ``axes``, ``cH*``</span>
<span class="sd">        corresponds to ``axes[0]`` while ``cV*`` corresponds to ``axes[1]``.</span>
<span class="sd">        The first element returned is the approximation coefficients for the</span>
<span class="sd">        nth level of decomposition.  Remaining elements are tuples of detail</span>
<span class="sd">        coefficients in descending order of decomposition level.</span>
<span class="sd">        (i.e. ``cH1`` are the horizontal detail coefficients at the first</span>
<span class="sd">        level)</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import pywt</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; coeffs = pywt.wavedec2(np.ones((4,4)), 'db1')</span>
<span class="sd">    &gt;&gt;&gt; # Levels:</span>
<span class="sd">    &gt;&gt;&gt; len(coeffs)-1</span>
<span class="sd">    2</span>
<span class="sd">    &gt;&gt;&gt; pywt.waverec2(coeffs, 'db1')</span>
<span class="sd">    array([[ 1.,  1.,  1.,  1.],</span>
<span class="sd">           [ 1.,  1.,  1.,  1.],</span>
<span class="sd">           [ 1.,  1.,  1.,  1.],</span>
<span class="sd">           [ 1.,  1.,  1.,  1.]])</span>
<span class="sd">    """</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Expected input data to have at least 2 dimensions."</span><span class="p">)</span>

    <span class="n">axes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Expected 2 axes"</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">axes</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"The axes passed to wavedec2 must be unique."</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">axes_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">AxisError</span><span class="p">(</span><span class="s2">"Axis greater than data dimensions"</span><span class="p">)</span>

    <span class="n">wavelets</span> <span class="o">=</span> <span class="n">_wavelets_per_axis</span><span class="p">(</span><span class="n">wavelet</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
    <span class="n">dec_lengths</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">dec_len</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">wavelets</span><span class="p">]</span>

    <span class="n">level</span> <span class="o">=</span> <span class="n">_check_level</span><span class="p">(</span><span class="n">axes_sizes</span><span class="p">,</span> <span class="n">dec_lengths</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>

    <span class="n">coeffs_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">data</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">level</span><span class="p">):</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">ds</span> <span class="o">=</span> <span class="n">dwt2</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
        <span class="n">coeffs_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>

    <span class="n">coeffs_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">coeffs_list</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">coeffs_list</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.wavedecn">
<code class="highlight language-python"><span class="n">wavedecn</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Multilevel nD Discrete Wavelet Transform.</p>
<h4 id="pywt.wavedecn--parameters">Parameters</h4>
<p>data : ndarray
    nD input data
wavelet : Wavelet object or name string, or tuple of wavelets
    Wavelet to use.  This can also be a tuple containing a wavelet to
    apply along each axis in <code>axes</code>.
mode : str or tuple of str, optional
    Signal extension mode, see :ref:<code>Modes &lt;ref-modes&gt;</code>. This can
    also be a tuple containing a mode to apply along each axis in <code>axes</code>.
level : int, optional
    Decomposition level (must be &gt;= 0). If level is None (default) then it
    will be calculated using the <code>dwt_max_level</code> function.
axes : sequence of ints, optional
    Axes over which to compute the DWT. Axes may not be repeated. The
    default is None, which means transform all axes
    (<code>axes = range(data.ndim)</code>).</p>
<h4 id="pywt.wavedecn--returns">Returns</h4>
<p>[cAn, {details_level_n}, ... {details_level_1}] : list
    Coefficients list.  Coefficients are listed in descending order of
    decomposition level.  <code>cAn</code> are the approximation coefficients at
    level <code>n</code>.  Each <code>details_level_i</code> element is a dictionary
    containing detail coefficients at level <code>i</code> of the decomposition. As
    a concrete example, a 3D decomposition would have the following set of
    keys in each <code>details_level_i</code> dictionary::</p>
<div class="highlight"><pre><span></span><code>    {'aad', 'ada', 'daa', 'add', 'dad', 'dda', 'ddd'}

where the order of the characters in each key map to the specified
``axes``.
</code></pre></div>
<h4 id="pywt.wavedecn--examples">Examples</h4>
<blockquote>
<blockquote>
<blockquote>
<p>import numpy as np
from pywt import wavedecn, waverecn
coeffs = wavedecn(np.ones((4, 4, 4)), 'db1')</p>
<h3 id="pywt.wavedecn--levels">Levels:</h3>
<p>len(coeffs)-1
2
waverecn(coeffs, 'db1')
array([[[ 1.,  1.,  1.,  1.],
        [ 1.,  1.,  1.,  1.],
        [ 1.,  1.,  1.,  1.],
        [ 1.,  1.,  1.,  1.]],
       [[ 1.,  1.,  1.,  1.],
        [ 1.,  1.,  1.,  1.],
        [ 1.,  1.,  1.,  1.],
        [ 1.,  1.,  1.,  1.]],
       [[ 1.,  1.,  1.,  1.],
        [ 1.,  1.,  1.,  1.],
        [ 1.,  1.,  1.,  1.],
        [ 1.,  1.,  1.,  1.]],
       [[ 1.,  1.,  1.,  1.],
        [ 1.,  1.,  1.,  1.],
        [ 1.,  1.,  1.,  1.],
        [ 1.,  1.,  1.,  1.]]])</p>
</blockquote>
</blockquote>
</blockquote>
<details class="quote">
<summary>Source code in <code>pywt/_multilevel.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">wavedecn</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Multilevel nD Discrete Wavelet Transform.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">        nD input data</span>
<span class="sd">    wavelet : Wavelet object or name string, or tuple of wavelets</span>
<span class="sd">        Wavelet to use.  This can also be a tuple containing a wavelet to</span>
<span class="sd">        apply along each axis in ``axes``.</span>
<span class="sd">    mode : str or tuple of str, optional</span>
<span class="sd">        Signal extension mode, see :ref:`Modes &lt;ref-modes&gt;`. This can</span>
<span class="sd">        also be a tuple containing a mode to apply along each axis in ``axes``.</span>
<span class="sd">    level : int, optional</span>
<span class="sd">        Decomposition level (must be &gt;= 0). If level is None (default) then it</span>
<span class="sd">        will be calculated using the ``dwt_max_level`` function.</span>
<span class="sd">    axes : sequence of ints, optional</span>
<span class="sd">        Axes over which to compute the DWT. Axes may not be repeated. The</span>
<span class="sd">        default is None, which means transform all axes</span>
<span class="sd">        (``axes = range(data.ndim)``).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    [cAn, {details_level_n}, ... {details_level_1}] : list</span>
<span class="sd">        Coefficients list.  Coefficients are listed in descending order of</span>
<span class="sd">        decomposition level.  ``cAn`` are the approximation coefficients at</span>
<span class="sd">        level ``n``.  Each ``details_level_i`` element is a dictionary</span>
<span class="sd">        containing detail coefficients at level ``i`` of the decomposition. As</span>
<span class="sd">        a concrete example, a 3D decomposition would have the following set of</span>
<span class="sd">        keys in each ``details_level_i`` dictionary::</span>

<span class="sd">            {'aad', 'ada', 'daa', 'add', 'dad', 'dda', 'ddd'}</span>

<span class="sd">        where the order of the characters in each key map to the specified</span>
<span class="sd">        ``axes``.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; from pywt import wavedecn, waverecn</span>
<span class="sd">    &gt;&gt;&gt; coeffs = wavedecn(np.ones((4, 4, 4)), 'db1')</span>
<span class="sd">    &gt;&gt;&gt; # Levels:</span>
<span class="sd">    &gt;&gt;&gt; len(coeffs)-1</span>
<span class="sd">    2</span>
<span class="sd">    &gt;&gt;&gt; waverecn(coeffs, 'db1')</span>
<span class="sd">    array([[[ 1.,  1.,  1.,  1.],</span>
<span class="sd">            [ 1.,  1.,  1.,  1.],</span>
<span class="sd">            [ 1.,  1.,  1.,  1.],</span>
<span class="sd">            [ 1.,  1.,  1.,  1.]],</span>
<span class="sd">           [[ 1.,  1.,  1.,  1.],</span>
<span class="sd">            [ 1.,  1.,  1.,  1.],</span>
<span class="sd">            [ 1.,  1.,  1.,  1.],</span>
<span class="sd">            [ 1.,  1.,  1.,  1.]],</span>
<span class="sd">           [[ 1.,  1.,  1.,  1.],</span>
<span class="sd">            [ 1.,  1.,  1.,  1.],</span>
<span class="sd">            [ 1.,  1.,  1.,  1.],</span>
<span class="sd">            [ 1.,  1.,  1.,  1.]],</span>
<span class="sd">           [[ 1.,  1.,  1.,  1.],</span>
<span class="sd">            [ 1.,  1.,  1.,  1.],</span>
<span class="sd">            [ 1.,  1.,  1.,  1.],</span>
<span class="sd">            [ 1.,  1.,  1.,  1.]]])</span>

<span class="sd">    """</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">,</span> <span class="n">axes_shapes</span><span class="p">,</span> <span class="n">ndim_transform</span> <span class="o">=</span> <span class="n">_prep_axes_wavedecn</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
    <span class="n">wavelets</span> <span class="o">=</span> <span class="n">_wavelets_per_axis</span><span class="p">(</span><span class="n">wavelet</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
    <span class="n">dec_lengths</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">dec_len</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">wavelets</span><span class="p">]</span>

    <span class="n">level</span> <span class="o">=</span> <span class="n">_check_level</span><span class="p">(</span><span class="n">axes_shapes</span><span class="p">,</span> <span class="n">dec_lengths</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>

    <span class="n">coeffs_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">data</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">level</span><span class="p">):</span>
        <span class="n">coeffs</span> <span class="o">=</span> <span class="n">dwtn</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">coeffs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">'a'</span> <span class="o">*</span> <span class="n">ndim_transform</span><span class="p">)</span>
        <span class="n">coeffs_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span>

    <span class="n">coeffs_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">coeffs_list</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">coeffs_list</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.wavedecn_shapes">
<code class="highlight language-python"><span class="n">wavedecn_shapes</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Subband shapes for a multilevel nD discrete wavelet transform.</p>
<h4 id="pywt.wavedecn_shapes--parameters">Parameters</h4>
<p>shape : sequence of ints
    The shape of the data to be transformed.
wavelet : Wavelet object or name string, or tuple of wavelets
    Wavelet to use.  This can also be a tuple containing a wavelet to
    apply along each axis in <code>axes</code>.
mode : str or tuple of str, optional
    Signal extension mode, see :ref:<code>Modes &lt;ref-modes&gt;</code>. This can
    also be a tuple containing a mode to apply along each axis in <code>axes</code>.
level : int, optional
    Decomposition level (must be &gt;= 0). If level is None (default) then it
    will be calculated using the <code>dwt_max_level</code> function.
axes : sequence of ints, optional
    Axes over which to compute the DWT. Axes may not be repeated. The
    default is None, which means transform all axes
    (<code>axes = range(data.ndim)</code>).</p>
<h4 id="pywt.wavedecn_shapes--returns">Returns</h4>
<p>shapes : [cAn, {details_level_n}, ... {details_level_1}] : list
    Coefficients shape list.  Mirrors the output of <code>wavedecn</code>, except
    it contains only the shapes of the coefficient arrays rather than the
    arrays themselves.</p>
<h4 id="pywt.wavedecn_shapes--examples">Examples</h4>
<blockquote>
<blockquote>
<blockquote>
<p>import pywt
pywt.wavedecn_shapes((64, 32), wavelet='db2', level=3, axes=(0, ))
[(10, 32), {'d': (10, 32)}, {'d': (18, 32)}, {'d': (33, 32)}]</p>
</blockquote>
</blockquote>
</blockquote>
<details class="quote">
<summary>Source code in <code>pywt/_multilevel.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">wavedecn_shapes</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Subband shapes for a multilevel nD discrete wavelet transform.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    shape : sequence of ints</span>
<span class="sd">        The shape of the data to be transformed.</span>
<span class="sd">    wavelet : Wavelet object or name string, or tuple of wavelets</span>
<span class="sd">        Wavelet to use.  This can also be a tuple containing a wavelet to</span>
<span class="sd">        apply along each axis in ``axes``.</span>
<span class="sd">    mode : str or tuple of str, optional</span>
<span class="sd">        Signal extension mode, see :ref:`Modes &lt;ref-modes&gt;`. This can</span>
<span class="sd">        also be a tuple containing a mode to apply along each axis in ``axes``.</span>
<span class="sd">    level : int, optional</span>
<span class="sd">        Decomposition level (must be &gt;= 0). If level is None (default) then it</span>
<span class="sd">        will be calculated using the ``dwt_max_level`` function.</span>
<span class="sd">    axes : sequence of ints, optional</span>
<span class="sd">        Axes over which to compute the DWT. Axes may not be repeated. The</span>
<span class="sd">        default is None, which means transform all axes</span>
<span class="sd">        (``axes = range(data.ndim)``).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    shapes : [cAn, {details_level_n}, ... {details_level_1}] : list</span>
<span class="sd">        Coefficients shape list.  Mirrors the output of ``wavedecn``, except</span>
<span class="sd">        it contains only the shapes of the coefficient arrays rather than the</span>
<span class="sd">        arrays themselves.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import pywt</span>
<span class="sd">    &gt;&gt;&gt; pywt.wavedecn_shapes((64, 32), wavelet='db2', level=3, axes=(0, ))</span>
<span class="sd">    [(10, 32), {'d': (10, 32)}, {'d': (18, 32)}, {'d': (33, 32)}]</span>
<span class="sd">    """</span>
    <span class="n">axes</span><span class="p">,</span> <span class="n">axes_shapes</span><span class="p">,</span> <span class="n">ndim_transform</span> <span class="o">=</span> <span class="n">_prep_axes_wavedecn</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
    <span class="n">wavelets</span> <span class="o">=</span> <span class="n">_wavelets_per_axis</span><span class="p">(</span><span class="n">wavelet</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
    <span class="n">modes</span> <span class="o">=</span> <span class="n">_modes_per_axis</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
    <span class="n">dec_lengths</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">dec_len</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">wavelets</span><span class="p">]</span>

    <span class="n">level</span> <span class="o">=</span> <span class="n">_check_level</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">axes_shapes</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">dec_lengths</span><span class="p">),</span> <span class="n">level</span><span class="p">)</span>

    <span class="n">shapes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">level</span><span class="p">):</span>
        <span class="n">detail_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="s1">'ad'</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">))]</span>
        <span class="n">new_shapes</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">detail_keys</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">axis</span><span class="p">,</span> <span class="n">wav</span><span class="p">,</span> <span class="n">mode</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">wavelets</span><span class="p">,</span> <span class="n">modes</span><span class="p">):</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">dwt_coeff_len</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">],</span> <span class="n">filter_len</span><span class="o">=</span><span class="n">wav</span><span class="o">.</span><span class="n">dec_len</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">detail_keys</span><span class="p">:</span>
                <span class="n">new_shapes</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">new_shapes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_shapes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="n">shapes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_shapes</span><span class="p">)</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="n">new_shapes</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">'a'</span> <span class="o">*</span> <span class="n">ndim_transform</span><span class="p">)</span>
    <span class="n">shapes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">shapes</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">shapes</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.wavedecn_size">
<code class="highlight language-python"><span class="n">wavedecn_size</span><span class="p">(</span><span class="n">shapes</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Compute the total number of wavedecn coefficients.</p>
<h4 id="pywt.wavedecn_size--parameters">Parameters</h4>
<p>shapes : list of coefficient shapes
    A set of coefficient shapes as returned by <code>wavedecn_shapes</code>.
    Alternatively, the user can specify a set of coefficients as returned
    by <code>wavedecn</code>.</p>
<h4 id="pywt.wavedecn_size--returns">Returns</h4>
<p>size : int
    The total number of coefficients.</p>
<h4 id="pywt.wavedecn_size--examples">Examples</h4>
<blockquote>
<blockquote>
<blockquote>
<p>import numpy as np
import pywt
data_shape = (64, 32)
shapes = pywt.wavedecn_shapes(data_shape, 'db2', mode='periodization')
pywt.wavedecn_size(shapes)
2048
coeffs = pywt.wavedecn(np.ones(data_shape), 'sym4', mode='symmetric')
pywt.wavedecn_size(coeffs)
3087</p>
</blockquote>
</blockquote>
</blockquote>
<details class="quote">
<summary>Source code in <code>pywt/_multilevel.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span>
<span class="normal">986</span>
<span class="normal">987</span>
<span class="normal">988</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">wavedecn_size</span><span class="p">(</span><span class="n">shapes</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Compute the total number of wavedecn coefficients.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    shapes : list of coefficient shapes</span>
<span class="sd">        A set of coefficient shapes as returned by ``wavedecn_shapes``.</span>
<span class="sd">        Alternatively, the user can specify a set of coefficients as returned</span>
<span class="sd">        by ``wavedecn``.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    size : int</span>
<span class="sd">        The total number of coefficients.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; import pywt</span>
<span class="sd">    &gt;&gt;&gt; data_shape = (64, 32)</span>
<span class="sd">    &gt;&gt;&gt; shapes = pywt.wavedecn_shapes(data_shape, 'db2', mode='periodization')</span>
<span class="sd">    &gt;&gt;&gt; pywt.wavedecn_size(shapes)</span>
<span class="sd">    2048</span>
<span class="sd">    &gt;&gt;&gt; coeffs = pywt.wavedecn(np.ones(data_shape), 'sym4', mode='symmetric')</span>
<span class="sd">    &gt;&gt;&gt; pywt.wavedecn_size(coeffs)</span>
<span class="sd">    3087</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="nf">_size</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Size corresponding to ``x`` as either a shape tuple or ndarray."""</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">ncoeffs</span> <span class="o">=</span> <span class="n">_size</span><span class="p">(</span><span class="n">shapes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">shapes</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">"Setting coefficient arrays to None is not supported."</span><span class="p">)</span>
            <span class="n">ncoeffs</span> <span class="o">+=</span> <span class="n">_size</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ncoeffs</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.waverec">
<code class="highlight language-python"><span class="n">waverec</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Multilevel 1D Inverse Discrete Wavelet Transform.</p>
<h4 id="pywt.waverec--parameters">Parameters</h4>
<p>coeffs : array_like
    Coefficients list [cAn, cDn, cDn-1, ..., cD2, cD1]
wavelet : Wavelet object or name string
    Wavelet to use
mode : str, optional
    Signal extension mode, see :ref:<code>Modes &lt;ref-modes&gt;</code>.
axis: int, optional
    Axis over which to compute the inverse DWT. If not given, the
    last axis is used.</p>
<h4 id="pywt.waverec--notes">Notes</h4>
<p>It may sometimes be desired to run <code>waverec</code> with some sets of
coefficients omitted.  This can best be done by setting the corresponding
arrays to zero arrays of matching shape and dtype.  Explicitly removing
list entries or setting them to None is not supported.</p>
<p>Specifically, to ignore detail coefficients at level 2, one could do::</p>
<div class="highlight"><pre><span></span><code>coeffs[-2] = np.zeros_like(coeffs[-2])
</code></pre></div>
<h4 id="pywt.waverec--examples">Examples</h4>
<blockquote>
<blockquote>
<blockquote>
<p>import pywt
coeffs = pywt.wavedec([1,2,3,4,5,6,7,8], 'db1', level=2)
pywt.waverec(coeffs, 'db1')
array([ 1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.])</p>
</blockquote>
</blockquote>
</blockquote>
<details class="quote">
<summary>Source code in <code>pywt/_multilevel.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">waverec</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Multilevel 1D Inverse Discrete Wavelet Transform.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    coeffs : array_like</span>
<span class="sd">        Coefficients list [cAn, cDn, cDn-1, ..., cD2, cD1]</span>
<span class="sd">    wavelet : Wavelet object or name string</span>
<span class="sd">        Wavelet to use</span>
<span class="sd">    mode : str, optional</span>
<span class="sd">        Signal extension mode, see :ref:`Modes &lt;ref-modes&gt;`.</span>
<span class="sd">    axis: int, optional</span>
<span class="sd">        Axis over which to compute the inverse DWT. If not given, the</span>
<span class="sd">        last axis is used.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    It may sometimes be desired to run ``waverec`` with some sets of</span>
<span class="sd">    coefficients omitted.  This can best be done by setting the corresponding</span>
<span class="sd">    arrays to zero arrays of matching shape and dtype.  Explicitly removing</span>
<span class="sd">    list entries or setting them to None is not supported.</span>

<span class="sd">    Specifically, to ignore detail coefficients at level 2, one could do::</span>

<span class="sd">        coeffs[-2] = np.zeros_like(coeffs[-2])</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import pywt</span>
<span class="sd">    &gt;&gt;&gt; coeffs = pywt.wavedec([1,2,3,4,5,6,7,8], 'db1', level=2)</span>
<span class="sd">    &gt;&gt;&gt; pywt.waverec(coeffs, 'db1')</span>
<span class="sd">    array([ 1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.])</span>
<span class="sd">    """</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Expected sequence of coefficient arrays."</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">"Coefficient list too short (minimum 1 arrays required)."</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># level 0 transform (just returns the approximation coefficients)</span>
        <span class="k">return</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">a</span><span class="p">,</span> <span class="n">ds</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">"Unexpected detail coefficient type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="si">}</span><span class="s2">. Detail coefficients "</span>
                <span class="s2">"must be arrays as returned by wavedec. If you are using "</span>
                <span class="s2">"pywt.array_to_coeffs or pywt.unravel_coeffs, please specify "</span>
                <span class="s2">"output_format='wavedec'"</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">==</span> <span class="n">d</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">shape</span><span class="p">)]</span>
                <span class="k">elif</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">!=</span> <span class="n">d</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"coefficient shape mismatch"</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">AxisError</span><span class="p">(</span><span class="s2">"Axis greater than coefficient dimensions"</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">idwt</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">a</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.waverec2">
<code class="highlight language-python"><span class="n">waverec2</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span></code>
</h2>
<div class="doc doc-contents">
<p>Multilevel 2D Inverse Discrete Wavelet Transform.</p>
<details class="coeffs-" open="">
<summary>list or tuple</summary>
<p>Coefficients list [cAn, (cHn, cVn, cDn), ... (cH1, cV1, cD1)]</p>
</details> <p>wavelet : Wavelet object or name string, or 2-tuple of wavelets
    Wavelet to use.  This can also be a tuple containing a wavelet to
    apply along each axis in <code>axes</code>.
mode : str or 2-tuple of str, optional
    Signal extension mode, see :ref:<code>Modes &lt;ref-modes&gt;</code>. This can
    also be a tuple containing a mode to apply along each axis in <code>axes</code>.
axes : 2-tuple of ints, optional
    Axes over which to compute the IDWT. Repeated elements are not allowed.</p>
<h4 id="pywt.waverec2--returns">Returns</h4>
<p>2D array of reconstructed data.</p>
<h4 id="pywt.waverec2--notes">Notes</h4>
<p>It may sometimes be desired to run <code>waverec2</code> with some sets of
coefficients omitted.  This can best be done by setting the corresponding
arrays to zero arrays of matching shape and dtype.  Explicitly removing
list or tuple entries or setting them to None is not supported.</p>
<p>Specifically, to ignore all detail coefficients at level 2, one could do::</p>
<div class="highlight"><pre><span></span><code>coeffs[-2] == tuple([np.zeros_like(v) for v in coeffs[-2]])
</code></pre></div>
<h4 id="pywt.waverec2--examples">Examples</h4>
<blockquote>
<blockquote>
<blockquote>
<p>import pywt
import numpy as np
coeffs = pywt.wavedec2(np.ones((4,4)), 'db1')</p>
<h3 id="pywt.waverec2--levels">Levels:</h3>
<p>len(coeffs)-1
2
pywt.waverec2(coeffs, 'db1')
array([[ 1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.]])</p>
</blockquote>
</blockquote>
</blockquote>
<details class="quote">
<summary>Source code in <code>pywt/_multilevel.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">waverec2</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Multilevel 2D Inverse Discrete Wavelet Transform.</span>

<span class="sd">    coeffs : list or tuple</span>
<span class="sd">        Coefficients list [cAn, (cHn, cVn, cDn), ... (cH1, cV1, cD1)]</span>
<span class="sd">    wavelet : Wavelet object or name string, or 2-tuple of wavelets</span>
<span class="sd">        Wavelet to use.  This can also be a tuple containing a wavelet to</span>
<span class="sd">        apply along each axis in ``axes``.</span>
<span class="sd">    mode : str or 2-tuple of str, optional</span>
<span class="sd">        Signal extension mode, see :ref:`Modes &lt;ref-modes&gt;`. This can</span>
<span class="sd">        also be a tuple containing a mode to apply along each axis in ``axes``.</span>
<span class="sd">    axes : 2-tuple of ints, optional</span>
<span class="sd">        Axes over which to compute the IDWT. Repeated elements are not allowed.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    2D array of reconstructed data.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    It may sometimes be desired to run ``waverec2`` with some sets of</span>
<span class="sd">    coefficients omitted.  This can best be done by setting the corresponding</span>
<span class="sd">    arrays to zero arrays of matching shape and dtype.  Explicitly removing</span>
<span class="sd">    list or tuple entries or setting them to None is not supported.</span>

<span class="sd">    Specifically, to ignore all detail coefficients at level 2, one could do::</span>

<span class="sd">        coeffs[-2] == tuple([np.zeros_like(v) for v in coeffs[-2]])</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import pywt</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; coeffs = pywt.wavedec2(np.ones((4,4)), 'db1')</span>
<span class="sd">    &gt;&gt;&gt; # Levels:</span>
<span class="sd">    &gt;&gt;&gt; len(coeffs)-1</span>
<span class="sd">    2</span>
<span class="sd">    &gt;&gt;&gt; pywt.waverec2(coeffs, 'db1')</span>
<span class="sd">    array([[ 1.,  1.,  1.,  1.],</span>
<span class="sd">           [ 1.,  1.,  1.,  1.],</span>
<span class="sd">           [ 1.,  1.,  1.,  1.],</span>
<span class="sd">           [ 1.,  1.,  1.,  1.]])</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Expected sequence of coefficient arrays."</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">axes</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"The axes passed to waverec2 must be unique."</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">"Coefficient list too short (minimum 1 array required)."</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># level 0 transform (just returns the approximation coefficients)</span>
        <span class="k">return</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">a</span><span class="p">,</span> <span class="n">ds</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">"Unexpected detail coefficient type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="si">}</span><span class="s2">. Detail coefficients "</span>
                <span class="s2">"must be a 3-tuple of arrays as returned by wavedec2. If you "</span>
                <span class="s2">"are using pywt.array_to_coeffs or pywt.unravel_coeffs, "</span>
                <span class="s2">"please specify output_format='wavedec2'"</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span> <span class="k">if</span> <span class="n">coeff</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
                  <span class="k">for</span> <span class="n">coeff</span> <span class="ow">in</span> <span class="n">d</span><span class="p">)</span>
        <span class="n">d_shapes</span> <span class="o">=</span> <span class="p">(</span><span class="n">coeff</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">coeff</span> <span class="ow">in</span> <span class="n">d</span> <span class="k">if</span> <span class="n">coeff</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">d_shape</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">d_shapes</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
            <span class="n">idxs</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">s</span> <span class="o">==</span> <span class="n">d_shape</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">d_shapes</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"All detail shapes must be the same length."</span><span class="p">)</span>
            <span class="n">idxs</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">a_len</span> <span class="o">==</span> <span class="n">d_len</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
                         <span class="k">for</span> <span class="n">a_len</span><span class="p">,</span> <span class="n">d_len</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">d_shape</span><span class="p">))</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">idwt2</span><span class="p">((</span><span class="n">a</span><span class="p">[</span><span class="n">idxs</span><span class="p">],</span> <span class="n">d</span><span class="p">),</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">a</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="pywt.waverecn">
<code class="highlight language-python"><span class="n">waverecn</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Multilevel nD Inverse Discrete Wavelet Transform.</p>
<details class="coeffs-" open="">
<summary>array_like</summary>
<p>Coefficients list [cAn, {details_level_n}, ... {details_level_1}]</p>
</details> <p>wavelet : Wavelet object or name string, or tuple of wavelets
    Wavelet to use.  This can also be a tuple containing a wavelet to
    apply along each axis in <code>axes</code>.
mode : str or tuple of str, optional
    Signal extension mode, see :ref:<code>Modes &lt;ref-modes&gt;</code>. This can
    also be a tuple containing a mode to apply along each axis in <code>axes</code>.
axes : sequence of ints, optional
    Axes over which to compute the IDWT.  Axes may not be repeated.</p>
<h4 id="pywt.waverecn--returns">Returns</h4>
<p>nD array of reconstructed data.</p>
<h4 id="pywt.waverecn--notes">Notes</h4>
<p>It may sometimes be desired to run <code>waverecn</code> with some sets of
coefficients omitted.  This can best be done by setting the corresponding
arrays to zero arrays of matching shape and dtype.  Explicitly removing
list or dictionary entries or setting them to None is not supported.</p>
<p>Specifically, to ignore all detail coefficients at level 2, one could do::</p>
<div class="highlight"><pre><span></span><code>coeffs[-2] = {k: np.zeros_like(v) for k, v in coeffs[-2].items()}
</code></pre></div>
<h4 id="pywt.waverecn--examples">Examples</h4>
<blockquote>
<blockquote>
<blockquote>
<p>import numpy as np
from pywt import wavedecn, waverecn
coeffs = wavedecn(np.ones((4, 4, 4)), 'db1')</p>
<h3 id="pywt.waverecn--levels">Levels:</h3>
<p>len(coeffs)-1
2
waverecn(coeffs, 'db1')
array([[[ 1.,  1.,  1.,  1.],
        [ 1.,  1.,  1.,  1.],
        [ 1.,  1.,  1.,  1.],
        [ 1.,  1.,  1.,  1.]],
       [[ 1.,  1.,  1.,  1.],
        [ 1.,  1.,  1.,  1.],
        [ 1.,  1.,  1.,  1.],
        [ 1.,  1.,  1.,  1.]],
       [[ 1.,  1.,  1.,  1.],
        [ 1.,  1.,  1.,  1.],
        [ 1.,  1.,  1.,  1.],
        [ 1.,  1.,  1.,  1.]],
       [[ 1.,  1.,  1.,  1.],
        [ 1.,  1.,  1.,  1.],
        [ 1.,  1.,  1.,  1.],
        [ 1.,  1.,  1.,  1.]]])</p>
</blockquote>
</blockquote>
</blockquote>
<details class="quote">
<summary>Source code in <code>pywt/_multilevel.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">waverecn</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'symmetric'</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Multilevel nD Inverse Discrete Wavelet Transform.</span>

<span class="sd">    coeffs : array_like</span>
<span class="sd">        Coefficients list [cAn, {details_level_n}, ... {details_level_1}]</span>
<span class="sd">    wavelet : Wavelet object or name string, or tuple of wavelets</span>
<span class="sd">        Wavelet to use.  This can also be a tuple containing a wavelet to</span>
<span class="sd">        apply along each axis in ``axes``.</span>
<span class="sd">    mode : str or tuple of str, optional</span>
<span class="sd">        Signal extension mode, see :ref:`Modes &lt;ref-modes&gt;`. This can</span>
<span class="sd">        also be a tuple containing a mode to apply along each axis in ``axes``.</span>
<span class="sd">    axes : sequence of ints, optional</span>
<span class="sd">        Axes over which to compute the IDWT.  Axes may not be repeated.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    nD array of reconstructed data.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    It may sometimes be desired to run ``waverecn`` with some sets of</span>
<span class="sd">    coefficients omitted.  This can best be done by setting the corresponding</span>
<span class="sd">    arrays to zero arrays of matching shape and dtype.  Explicitly removing</span>
<span class="sd">    list or dictionary entries or setting them to None is not supported.</span>

<span class="sd">    Specifically, to ignore all detail coefficients at level 2, one could do::</span>

<span class="sd">        coeffs[-2] = {k: np.zeros_like(v) for k, v in coeffs[-2].items()}</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; from pywt import wavedecn, waverecn</span>
<span class="sd">    &gt;&gt;&gt; coeffs = wavedecn(np.ones((4, 4, 4)), 'db1')</span>
<span class="sd">    &gt;&gt;&gt; # Levels:</span>
<span class="sd">    &gt;&gt;&gt; len(coeffs)-1</span>
<span class="sd">    2</span>
<span class="sd">    &gt;&gt;&gt; waverecn(coeffs, 'db1')</span>
<span class="sd">    array([[[ 1.,  1.,  1.,  1.],</span>
<span class="sd">            [ 1.,  1.,  1.,  1.],</span>
<span class="sd">            [ 1.,  1.,  1.,  1.],</span>
<span class="sd">            [ 1.,  1.,  1.,  1.]],</span>
<span class="sd">           [[ 1.,  1.,  1.,  1.],</span>
<span class="sd">            [ 1.,  1.,  1.,  1.],</span>
<span class="sd">            [ 1.,  1.,  1.,  1.],</span>
<span class="sd">            [ 1.,  1.,  1.,  1.]],</span>
<span class="sd">           [[ 1.,  1.,  1.,  1.],</span>
<span class="sd">            [ 1.,  1.,  1.,  1.],</span>
<span class="sd">            [ 1.,  1.,  1.,  1.],</span>
<span class="sd">            [ 1.,  1.,  1.,  1.]],</span>
<span class="sd">           [[ 1.,  1.,  1.,  1.],</span>
<span class="sd">            [ 1.,  1.,  1.,  1.],</span>
<span class="sd">            [ 1.,  1.,  1.,  1.],</span>
<span class="sd">            [ 1.,  1.,  1.,  1.]]])</span>

<span class="sd">    """</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">"Coefficient list too short (minimum 1 array required)."</span><span class="p">)</span>

    <span class="n">a</span><span class="p">,</span> <span class="n">ds</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="c1"># this dictionary check must be prior to the call to _fix_coeffs</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">"Unexpected detail coefficient type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="s2">. Detail coefficients "</span>
            <span class="s2">"must be a dictionary of arrays as returned by wavedecn. If "</span>
            <span class="s2">"you are using pywt.array_to_coeffs or pywt.unravel_coeffs, "</span>
            <span class="s2">"please specify output_format='wavedecn'"</span><span class="p">)</span>

    <span class="c1"># Raise error for invalid key combinations</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">_fix_coeffs</span><span class="p">,</span> <span class="n">ds</span><span class="p">))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">ds</span><span class="p">:</span>
        <span class="c1"># level 0 transform (just returns the approximation coefficients)</span>
        <span class="k">return</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">"At least one coefficient must contain a valid value."</span><span class="p">)</span>

    <span class="n">coeff_ndims</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">coeff_ndims</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">:</span>
        <span class="n">coeff_ndims</span> <span class="o">+=</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">ndim</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>

    <span class="c1"># test that all coefficients have a matching number of dimensions</span>
    <span class="n">unique_coeff_ndims</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">coeff_ndims</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_coeff_ndims</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">ndim</span> <span class="o">=</span> <span class="n">unique_coeff_ndims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">"All coefficients must have a matching number of dimensions"</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">axes</span><span class="p">):</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="p">)</span>
    <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndim</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">axes</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"The axes passed to waverecn must be unique."</span><span class="p">)</span>
    <span class="n">ndim_transform</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">d</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># The following if statement handles the case where the approximation</span>
        <span class="c1"># coefficient returned at the previous level may exceed the size of the</span>
        <span class="c1"># stored detail coefficients by 1 on any given axis.</span>
        <span class="k">if</span> <span class="n">idx</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">_match_coeff_dims</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="n">d</span><span class="p">[</span><span class="s1">'a'</span> <span class="o">*</span> <span class="n">ndim_transform</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">idwtn</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">a</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div><!-- .. toctree::
   :maxdepth: 2

   wavelets
   signal-extension-modes
   dwt-discrete-wavelet-transform
   idwt-inverse-discrete-wavelet-transform
   2d-decompositions-overview
   2d-dwt-and-idwt
   nd-dwt-and-idwt
   dwt-coefficient-handling
   swt-stationary-wavelet-transform
   iswt-inverse-stationary-wavelet-transform
   mra
   wavelet-packets
   cwt
   thresholding-functions
   other-functions -->












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tracking", "navigation.tabs", "navigation.sections", "navigation.expand", "toc.follow"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>